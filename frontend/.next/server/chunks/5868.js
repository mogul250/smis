"use strict";exports.id=5868,exports.ids=[5868],exports.modules={5868:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var l=t(997),d=t(6689),r=t.n(d),n=t(1163),i=t(6761),c=t(3242),x=t(3240),h=t(4082),m=t(6422),o=t(4105),j=t(6208),g=t(9180);t(5822);var u=t(9175),v=t(4549),p=t(6893),f=e([i,x,h,m]);[i,x,h,m]=f.then?(await f)():f;let __WEBPACK_DEFAULT_EXPORT__=()=>{let{user:e}=(0,i.a)(),s=(0,n.useRouter)(),{class:t}=s.query,[a,f]=(0,d.useState)("current"),[N,y]=(0,d.useState)({}),[C,b]=(0,d.useState)({}),[Z,G]=(0,d.useState)(null),{data:S,loading:A}=(0,c.h)(x.$o.getClasses),{data:w,loading:_,execute:B}=(0,c.h)(()=>x.$o.getClassStudents(t),[]),{data:P,loading:F,execute:D}=(0,c.h)(()=>x.$o.getClassGrades(t,a),[]),{loading:E,execute:T}=(0,c.c)(),$=S?.find(e=>e.id===parseInt(t));if(r().useEffect(()=>{t&&(B(),D())},[t,a,B,D]),r().useEffect(()=>{if(w&&P){let e={},s={};w.forEach(t=>{let a=P.find(e=>e.student_id===t.id);e[t.id]=a?.grade||"",s[t.id]=a?.comments||""}),y(e),b(s)}},[w,P]),!e||"teacher"!==e.role)return l.jsx("div",{className:"min-h-screen flex items-center justify-center",children:l.jsx(u.Z,{variant:"error",children:"Access denied. Teacher access required."})});let handleGradeChange=(e,s)=>{y(t=>({...t,[e]:s}))},handleCommentChange=(e,s)=>{b(t=>({...t,[e]:s}))},handleSaveGrades=async()=>{if(t&&w)try{let e=w.map(e=>({studentId:e.id,grade:N[e.id]||"",comments:C[e.id]||"",semester:"current"===a?"Fall 2024":a})).filter(e=>e.grade);await T(()=>x.$o.submitGrades({courseId:parseInt(t),grades:e})),G({type:"success",text:"Grades saved successfully!"}),setTimeout(()=>G(null),5e3)}catch(e){G({type:"error",text:e.response?.data?.message||"Failed to save grades"})}},validateGrade=e=>["A+","A","A-","B+","B","B-","C+","C","C-","D+","D","F"].includes(e.toUpperCase()),getGradePoints=e=>({"A+":4,A:4,"A-":3.7,"B+":3.3,B:3,"B-":2.7,"C+":2.3,C:2,"C-":1.7,"D+":1.3,D:1,F:0})[e.toUpperCase()]||0,H=r().useMemo(()=>{if(!w||!N)return{total:0,graded:0,avgGPA:0};let e=w.filter(e=>N[e.id]),s=e.reduce((e,s)=>e+getGradePoints(N[s.id]),0);return{total:w.length,graded:e.length,avgGPA:e.length>0?(s/e.length).toFixed(2):0}},[w,N]);return(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[l.jsx(h.Z,{}),(0,l.jsxs)("div",{className:"flex",children:[l.jsx(m.Z,{}),l.jsx("main",{className:"flex-1 p-6",children:(0,l.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Grade Entry"}),l.jsx("p",{className:"text-gray-600",children:$?`${$.name} (${$.course_code})`:"Select a class"})]}),l.jsx(g.Z,{variant:"secondary",onClick:()=>s.push("/teacher/classes"),children:"Back to Classes"})]}),Z&&l.jsx(u.Z,{variant:Z.type,dismissible:!0,onDismiss:()=>G(null),children:Z.text}),l.jsx(o.Z,{children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),(0,l.jsxs)("select",{value:t||"",onChange:e=>s.push(`/teacher/grades?class=${e.target.value}`),className:"form-select",disabled:A,children:[l.jsx("option",{value:"",children:"Select a class"}),S?.map(e=>l.jsxs("option",{value:e.id,children:[e.name," (",e.course_code,")"]},e.id))]})]}),(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Semester"}),(0,l.jsxs)("select",{value:a,onChange:e=>f(e.target.value),className:"form-select",children:[l.jsx("option",{value:"current",children:"Current Semester"}),l.jsx("option",{value:"Fall 2024",children:"Fall 2024"}),l.jsx("option",{value:"Spring 2024",children:"Spring 2024"}),l.jsx("option",{value:"Summer 2024",children:"Summer 2024"})]})]}),l.jsx("div",{className:"flex items-end",children:l.jsx(g.Z,{variant:"primary",icon:p.mW3,onClick:handleSaveGrades,loading:E,disabled:!t||!w||0===w.length,className:"w-full",children:"Save Grades"})})]})}),_||F?l.jsx(o.Z,{className:"flex justify-center py-12",children:l.jsx(v.Z,{size:"lg"})}):t?w&&w.length>0?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[l.jsx(o.Z,{children:(0,l.jsxs)("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-12 h-12 bg-primary-blue rounded-lg flex items-center justify-center mr-4",children:l.jsx(p.WY8,{className:"w-6 h-6 text-white"})}),(0,l.jsxs)("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Students"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:H.total})]})]})}),l.jsx(o.Z,{children:(0,l.jsxs)("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-12 h-12 bg-accent-green rounded-lg flex items-center justify-center mr-4",children:l.jsx(p.vPQ,{className:"w-6 h-6 text-white"})}),(0,l.jsxs)("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Graded"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:H.graded}),(0,l.jsxs)("p",{className:"text-xs text-gray-500",children:[H.total>0?Math.round(H.graded/H.total*100):0,"% complete"]})]})]})}),l.jsx(o.Z,{children:(0,l.jsxs)("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-12 h-12 bg-accent-orange rounded-lg flex items-center justify-center mr-4",children:l.jsx(p.DKx,{className:"w-6 h-6 text-white"})}),(0,l.jsxs)("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Class Average"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:H.avgGPA}),l.jsx("p",{className:"text-xs text-gray-500",children:"GPA"})]})]})})]}),(0,l.jsxs)(o.Z,{children:[l.jsx(o.Z.Header,{children:(0,l.jsxs)(o.Z.Title,{children:["Student Grades - ",a]})}),(0,l.jsxs)("div",{className:"mb-4 p-4 bg-blue-50 rounded-lg",children:[l.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Grade Scale"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:[(0,l.jsxs)("div",{children:[l.jsx("strong",{children:"A+/A:"})," 4.0"]}),(0,l.jsxs)("div",{children:[l.jsx("strong",{children:"A-:"})," 3.7"]}),(0,l.jsxs)("div",{children:[l.jsx("strong",{children:"B+:"})," 3.3"]}),(0,l.jsxs)("div",{children:[l.jsx("strong",{children:"B:"})," 3.0"]}),(0,l.jsxs)("div",{children:[l.jsx("strong",{children:"B-:"})," 2.7"]}),(0,l.jsxs)("div",{children:[l.jsx("strong",{children:"C+:"})," 2.3"]}),(0,l.jsxs)("div",{children:[l.jsx("strong",{children:"C:"})," 2.0"]}),(0,l.jsxs)("div",{children:[l.jsx("strong",{children:"C-:"})," 1.7"]}),(0,l.jsxs)("div",{children:[l.jsx("strong",{children:"D+:"})," 1.3"]}),(0,l.jsxs)("div",{children:[l.jsx("strong",{children:"D:"})," 1.0"]}),(0,l.jsxs)("div",{children:[l.jsx("strong",{children:"F:"})," 0.0"]})]})]}),(0,l.jsxs)(j.Z,{children:[l.jsx(j.Z.Header,{children:(0,l.jsxs)(j.Z.Row,{children:[l.jsx(j.Z.Head,{children:"Student ID"}),l.jsx(j.Z.Head,{children:"Name"}),l.jsx(j.Z.Head,{children:"Grade"}),l.jsx(j.Z.Head,{children:"GPA Points"}),l.jsx(j.Z.Head,{children:"Comments"})]})}),l.jsx(j.Z.Body,{children:w.map((e,s)=>{let t=N[e.id]||"",a=!t||validateGrade(t),d=t?getGradePoints(t):0;return(0,l.jsxs)(j.Z.Row,{children:[l.jsx(j.Z.Cell,{children:l.jsx("span",{className:"font-mono text-sm",children:e.id})}),(0,l.jsxs)(j.Z.Cell,{children:[(0,l.jsxs)("div",{className:"font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),l.jsx("div",{className:"text-sm text-gray-500",children:e.email})]}),l.jsx(j.Z.Cell,{children:(0,l.jsxs)("div",{className:"w-24",children:[l.jsx("input",{type:"text",value:t,onChange:s=>handleGradeChange(e.id,s.target.value.toUpperCase()),placeholder:"A, B+, C...",className:`form-input text-center font-medium ${a?"":"border-red-300 bg-red-50"}`}),!a&&l.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Invalid grade"})]})}),l.jsx(j.Z.Cell,{children:l.jsx("span",{className:"font-medium text-gray-900",children:t?d.toFixed(1):"-"})}),l.jsx(j.Z.Cell,{children:l.jsx("input",{type:"text",value:C[e.id]||"",onChange:s=>handleCommentChange(e.id,s.target.value),placeholder:"Optional comments...",className:"form-input text-sm"})})]},s)})})]})]})]}):(0,l.jsxs)(o.Z,{className:"text-center py-12",children:[l.jsx(p.WY8,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Students Found"}),l.jsx("p",{className:"text-gray-500",children:"This class doesn't have any students enrolled."})]}):(0,l.jsxs)(o.Z,{className:"text-center py-12",children:[l.jsx(p.DKx,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select a Class"}),l.jsx("p",{className:"text-gray-500",children:"Choose a class from the dropdown above to enter grades."})]})]})})]})]})};a()}catch(e){a(e)}})}};