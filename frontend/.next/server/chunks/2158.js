"use strict";exports.id=2158,exports.ids=[2158],exports.modules={7563:(e,s,t)=>{t.d(s,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var a=t(997),r=t(6689),l=t(4105),i=t(9180),n=t(7014),c=t(6893);let __WEBPACK_DEFAULT_EXPORT__=({users:e,loading:s,error:t,currentPage:d,totalPages:x,onPageChange:m,onUserAction:o})=>{let[h,u]=(0,r.useState)([]),[g,p]=(0,r.useState)(null),getRoleBadgeVariant=e=>({admin:"danger",hod:"warning",teacher:"primary",finance:"success",student:"default"})[e]||"default",getStatusBadgeVariant=e=>({active:"success",inactive:"default",suspended:"danger",pending:"warning"})[e]||"default",getRoleIcon=e=>{let s={admin:c.bfl,hod:c.bfl,teacher:c.WY8,finance:c.bAx,student:c.WY8};return s[e]||c.WY8},handleSelectUser=e=>{u(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},formatDate=e=>{if(!e)return"Never";let s=new Date(e);return s.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},formatTime=e=>{if(!e)return"";let s=new Date(e);return s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})};return s?a.jsx(l.Z,{className:"p-6",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[a.jsx("div",{className:"h-6 bg-gray-200 rounded w-48 mb-6"}),a.jsx("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[a.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),a.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/3"})]}),a.jsx("div",{className:"h-6 bg-gray-200 rounded w-16"}),a.jsx("div",{className:"h-6 bg-gray-200 rounded w-16"}),a.jsx("div",{className:"h-8 bg-gray-200 rounded w-20"})]},s))})]})}):t?a.jsx(l.Z,{className:"p-6",children:(0,a.jsxs)("div",{className:"text-center py-8",children:[a.jsx("div",{className:"text-red-500 mb-2",children:a.jsx(c.WY8,{className:"w-12 h-12 mx-auto"})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading Users"}),a.jsx("p",{className:"text-gray-500",children:t})]})}):e&&0!==e.length?(0,a.jsxs)(l.Z,{className:"overflow-hidden",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"System Users"}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[h.length>0&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[h.length," selected"]}),a.jsx(i.Z,{variant:"outline",size:"sm",children:"Bulk Actions"})]}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[e.length," users"]})]})]})}),a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left",children:a.jsx("input",{type:"checkbox",checked:h.length===e.length,onChange:()=>{h.length===e.length?u([]):u(e.map(e=>e.id))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Login"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>{let s=getRoleIcon(e.role);return(0,a.jsxs)("tr",{className:`hover:bg-gray-50 transition-colors ${h.includes(e.id)?"bg-blue-50":""}`,children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("input",{type:"checkbox",checked:h.includes(e.id),onChange:()=>handleSelectUser(e.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mr-4",children:(0,a.jsxs)("span",{className:"text-sm font-medium text-white",children:[e.first_name?.[0],e.last_name?.[0]]})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 flex items-center",children:[a.jsx(c.Imn,{className:"w-3 h-3 mr-1"}),e.email]}),e.staff_id&&(0,a.jsxs)("div",{className:"text-xs text-gray-400",children:["ID: ",e.staff_id]})]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx(s,{className:"w-4 h-4 mr-2 text-gray-400"}),a.jsx(n.Z,{variant:getRoleBadgeVariant(e.role),children:e.role?.toUpperCase()})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.department_name||"-"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx(n.Z,{variant:getStatusBadgeVariant(e.status||"active"),children:e.status||"active"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx(c.vlc,{className:"w-4 h-4 mr-1 text-gray-400"}),(0,a.jsxs)("div",{children:[a.jsx("div",{children:formatDate(e.last_login)}),e.last_login&&a.jsx("div",{className:"text-xs text-gray-500",children:formatTime(e.last_login)})]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:formatDate(e.created_at)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[a.jsx(i.Z,{variant:"outline",size:"sm",icon:c.rDJ,onClick:()=>o("view",e),children:"View"}),a.jsx(i.Z,{variant:"primary",size:"sm",icon:c.vPQ,onClick:()=>o("edit",e),children:"Edit"}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx(i.Z,{variant:"outline",size:"sm",icon:c.$Pu,onClick:()=>p(g===e.id?null:e.id)}),g===e.id&&a.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10 border border-gray-200",children:(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsxs)("button",{onClick:()=>{o("activate",e),p(null)},className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",children:[a.jsx(c.tMu,{className:"w-4 h-4 mr-2"}),"Activate"]}),(0,a.jsxs)("button",{onClick:()=>{o("deactivate",e),p(null)},className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",children:[a.jsx(c.pBC,{className:"w-4 h-4 mr-2"}),"Deactivate"]}),a.jsx("hr",{className:"my-1"}),(0,a.jsxs)("button",{onClick:()=>{o("delete",e),p(null)},className:"flex items-center px-4 py-2 text-sm text-red-700 hover:bg-red-50 w-full text-left",children:[a.jsx(c.Ybf,{className:"w-4 h-4 mr-2"}),"Delete"]})]})})]})]})})]},e.id)})})]})}),x>1&&a.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["Page ",d," of ",x]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(i.Z,{variant:"outline",size:"sm",icon:c.YFh,disabled:1===d,onClick:()=>m(d-1),children:"Previous"}),a.jsx(i.Z,{variant:"outline",size:"sm",icon:c.Tfp,iconPosition:"right",disabled:d===x,onClick:()=>m(d+1),children:"Next"})]})]})})]}):a.jsx(l.Z,{className:"p-6",children:(0,a.jsxs)("div",{className:"text-center py-12",children:[a.jsx(c.WY8,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Users Found"}),a.jsx("p",{className:"text-gray-500 mb-6",children:"No users match the current filters. Try adjusting your search criteria."}),a.jsx(i.Z,{variant:"primary",onClick:()=>o("create"),children:"Create First User"})]})})}},7014:(e,s,t)=>{t.d(s,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var a=t(997);t(6689);let __WEBPACK_DEFAULT_EXPORT__=({children:e,variant:s="default",size:t="md",className:r="",...l})=>a.jsx("span",{className:`inline-flex items-center font-medium rounded-full ${{default:"bg-gray-100 text-gray-800",primary:"bg-blue-100 text-blue-800",success:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-800",info:"bg-blue-100 text-blue-800"}[s]} ${{sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-0.5 text-xs",lg:"px-3 py-1 text-sm"}[t]} ${r}`,...l,children:e})},2158:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var r=t(997),l=t(6689),i=t(1163),n=t(6761),c=t(8303),d=t(4082),x=t(6422),m=t(9180),o=t(4105),h=t(856),u=t(7563),g=t(6893),p=e([n,c,d,x]);[n,c,d,x]=p.then?(await p)():p;let __WEBPACK_DEFAULT_EXPORT__=()=>{let{user:e,isAuthenticated:s}=(0,n.a)(),t=(0,i.useRouter)(),[a,p]=(0,l.useState)([]),[j,f]=(0,l.useState)(!0),[y,v]=(0,l.useState)(null),[N,b]=(0,l.useState)(!1),[w,_]=(0,l.useState)(1),[U,S]=(0,l.useState)(1),[k,C]=(0,l.useState)(0),[E,T]=(0,l.useState)(""),[A,P]=(0,l.useState)(""),[Z,D]=(0,l.useState)(""),[R,B]=(0,l.useState)(null),[F,L]=(0,l.useState)({totalUsers:0,activeUsers:0,newThisMonth:0,byRole:{}});(0,l.useEffect)(()=>{if(!s||e?.role!=="admin"){t.push("/dashboard");return}},[s,e,t]);let fetchUsers=async(e=1,s="",t="",a="")=>{try{f(1===e),b(1!==e);let r={...s&&{search:s},...t&&{role:t},...a&&{departmentId:a}},l=await c.Sb.getAllUsers(e,10,r),{users:i,pagination:n}=l;p(i),_(n.page),S(n.pages),C(n.total),calculateUserStats(i),v(null)}catch(e){v("Failed to load users. Please try again.")}finally{f(!1),b(!1)}},calculateUserStats=e=>{let s={totalUsers:e.length,activeUsers:e.filter(e=>"active"===e.status).length,newThisMonth:e.filter(e=>{let s=new Date(e.created_at),t=new Date;return s.getMonth()===t.getMonth()&&s.getFullYear()===t.getFullYear()}).length,byRole:{}};e.forEach(e=>{s.byRole[e.role]=(s.byRole[e.role]||0)+1}),L(s)};return((0,l.useEffect)(()=>{s&&e?.role==="admin"&&fetchUsers()},[s,e]),(0,l.useEffect)(()=>{let e=setTimeout(()=>{fetchUsers(1,E,A,Z)},500);return()=>clearTimeout(e)},[E,A,Z]),s&&e?.role==="admin")?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(d.default,{}),(0,r.jsxs)("div",{className:"flex",children:[r.jsx(x.default,{}),r.jsx("main",{className:"flex-1 overflow-auto",children:(0,r.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[r.jsx("div",{className:"mb-8",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[r.jsx(g.WY8,{className:"mr-3 text-blue-600"}),"User Management"]}),r.jsx("p",{className:"text-gray-600 mt-1",children:"Manage all users across the system - students, teachers, and staff"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx(m.Z,{variant:"outline",icon:g.Bw1,onClick:()=>{fetchUsers(w,E,A,Z)},loading:N,size:"sm",children:"Refresh"}),r.jsx(m.Z,{variant:"outline",icon:g._hL,size:"sm",children:"Export"}),r.jsx(m.Z,{variant:"primary",icon:g.OvN,onClick:()=>t.push("/admin/users/create"),children:"Add User"})]})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8",children:[r.jsx("div",{className:"lg:col-span-3",children:r.jsx(h.Z,{stats:F,totalUsers:k,loading:j})}),r.jsx("div",{className:"lg:col-span-1",children:r.jsx(h.f,{stats:F,loading:j})})]}),r.jsx(o.Z,{className:"mb-6",children:(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 flex-1",children:[(0,r.jsxs)("div",{className:"relative flex-1 max-w-md",children:[r.jsx(g.jRj,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),r.jsx("input",{type:"text",placeholder:"Search users...",value:E,onChange:e=>T(e.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsxs)("select",{value:A,onChange:e=>P(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"",children:"All Roles"}),r.jsx("option",{value:"student",children:"Students"}),r.jsx("option",{value:"teacher",children:"Teachers"}),r.jsx("option",{value:"hod",children:"HODs"}),r.jsx("option",{value:"finance",children:"Finance"}),r.jsx("option",{value:"admin",children:"Admins"})]})]}),(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[r.jsx(g.QqI,{className:"w-4 h-4 mr-1"}),k," total users"]})]})}),r.jsx(u.Z,{users:a,loading:j,error:y,currentPage:w,totalPages:U,onPageChange:e=>{fetchUsers(e,E,A,Z)},onUserAction:(e,s)=>{switch(B(s),e){case"create":t.push("/admin/users/create");break;case"edit":t.push(`/admin/users/actions?userId=${s.id}&action=edit`);break;case"delete":t.push(`/admin/users/actions?userId=${s.id}&action=delete`);break;case"view":t.push(`/admin/users/actions?userId=${s.id}&action=view`);break;case"activate":t.push(`/admin/users/actions?userId=${s.id}&action=activate`);break;case"deactivate":t.push(`/admin/users/actions?userId=${s.id}&action=deactivate`)}}})]})})]})]}):null};a()}catch(e){a(e)}})}};