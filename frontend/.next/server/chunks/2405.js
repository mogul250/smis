"use strict";exports.id=2405,exports.ids=[2405],exports.modules={2405:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var l=t(997),n=t(6689),r=t.n(n),c=t(1163),d=t(6761),i=t(3242),x=t(3240),h=t(4082),m=t(6422),o=t(4105),j=t(6208),u=t(9180),g=t(9175),p=t(4549),f=t(6893),N=e([d,x,h,m]);[d,x,h,m]=N.then?(await N)():N;let __WEBPACK_DEFAULT_EXPORT__=()=>{let{user:e}=(0,d.a)(),s=(0,c.useRouter)(),{class:t}=s.query,[a,N]=(0,n.useState)(new Date().toISOString().split("T")[0]),[y,v]=(0,n.useState)({}),[b,Z]=(0,n.useState)({}),[w,C]=(0,n.useState)(null),{data:S,loading:A}=(0,i.h)(x.$o.getClasses),{data:_,loading:T,execute:E}=(0,i.h)(()=>x.$o.getClassStudents(t),[]),{loading:k,execute:I}=(0,i.c)(),D=S?.find(e=>e.id===parseInt(t));if(r().useEffect(()=>{t&&E()},[t,E]),r().useEffect(()=>{if(_){let e={},s={};_.forEach(t=>{e[t.id]="present",s[t.id]=""}),v(e),Z(s)}},[_]),!e||"teacher"!==e.role)return l.jsx("div",{className:"min-h-screen flex items-center justify-center",children:l.jsx(g.Z,{variant:"error",children:"Access denied. Teacher access required."})});let handleAttendanceChange=(e,s)=>{v(t=>({...t,[e]:s}))},handleNotesChange=(e,s)=>{Z(t=>({...t,[e]:s}))},handleSaveAttendance=async()=>{if(t&&_)try{let e=_.map(e=>({studentId:e.id,status:y[e.id]||"present",notes:b[e.id]||""}));await I(()=>x.$o.markAttendance({courseId:parseInt(t),attendance:e,date:a})),C({type:"success",text:"Attendance saved successfully!"}),setTimeout(()=>C(null),5e3)}catch(e){C({type:"error",text:e.response?.data?.message||"Failed to save attendance"})}},getStatusIcon=e=>{switch(e){case"present":default:return f.UgA;case"late":return f.TCC;case"absent":return f.q5L}},$=r().useMemo(()=>{if(!_||!y)return{present:0,late:0,absent:0};let e={present:0,late:0,absent:0};return _.forEach(s=>{let t=y[s.id]||"present";e[t]++}),e},[_,y]);return(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[l.jsx(h.Z,{}),(0,l.jsxs)("div",{className:"flex",children:[l.jsx(m.Z,{}),l.jsx("main",{className:"flex-1 p-6",children:(0,l.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Mark Attendance"}),l.jsx("p",{className:"text-gray-600",children:D?`${D.name} (${D.course_code})`:"Select a class"})]}),l.jsx(u.Z,{variant:"secondary",onClick:()=>s.push("/teacher/classes"),children:"Back to Classes"})]}),w&&l.jsx(g.Z,{variant:w.type,dismissible:!0,onDismiss:()=>C(null),children:w.text}),l.jsx(o.Z,{children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),(0,l.jsxs)("select",{value:t||"",onChange:e=>s.push(`/teacher/attendance?class=${e.target.value}`),className:"form-select",disabled:A,children:[l.jsx("option",{value:"",children:"Select a class"}),S?.map(e=>l.jsxs("option",{value:e.id,children:[e.name," (",e.course_code,")"]},e.id))]})]}),(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),l.jsx("input",{type:"date",value:a,onChange:e=>N(e.target.value),className:"form-input"})]}),l.jsx("div",{className:"flex items-end",children:l.jsx(u.Z,{variant:"primary",icon:f.mW3,onClick:handleSaveAttendance,loading:k,disabled:!t||!_||0===_.length,className:"w-full",children:"Save Attendance"})})]})}),T?l.jsx(o.Z,{className:"flex justify-center py-12",children:l.jsx(p.Z,{size:"lg"})}):t?_&&_.length>0?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[l.jsx(o.Z,{children:(0,l.jsxs)("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-12 h-12 bg-gray-500 rounded-lg flex items-center justify-center mr-4",children:l.jsx(f.WY8,{className:"w-6 h-6 text-white"})}),(0,l.jsxs)("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Students"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:_.length})]})]})}),l.jsx(o.Z,{children:(0,l.jsxs)("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-12 h-12 bg-accent-green rounded-lg flex items-center justify-center mr-4",children:l.jsx(f.UgA,{className:"w-6 h-6 text-white"})}),(0,l.jsxs)("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Present"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:$.present})]})]})}),l.jsx(o.Z,{children:(0,l.jsxs)("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-12 h-12 bg-accent-orange rounded-lg flex items-center justify-center mr-4",children:l.jsx(f.TCC,{className:"w-6 h-6 text-white"})}),(0,l.jsxs)("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Late"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:$.late})]})]})}),l.jsx(o.Z,{children:(0,l.jsxs)("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-12 h-12 bg-accent-red rounded-lg flex items-center justify-center mr-4",children:l.jsx(f.q5L,{className:"w-6 h-6 text-white"})}),(0,l.jsxs)("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Absent"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:$.absent})]})]})})]}),(0,l.jsxs)(o.Z,{children:[l.jsx(o.Z.Header,{children:(0,l.jsxs)(o.Z.Title,{children:["Student Attendance - ",new Date(a).toLocaleDateString()]})}),(0,l.jsxs)(j.Z,{children:[l.jsx(j.Z.Header,{children:(0,l.jsxs)(j.Z.Row,{children:[l.jsx(j.Z.Head,{children:"Student ID"}),l.jsx(j.Z.Head,{children:"Name"}),l.jsx(j.Z.Head,{children:"Status"}),l.jsx(j.Z.Head,{children:"Notes"})]})}),l.jsx(j.Z.Body,{children:_.map((e,s)=>{let t=y[e.id]||"present";return getStatusIcon(t),(0,l.jsxs)(j.Z.Row,{children:[l.jsx(j.Z.Cell,{children:l.jsx("span",{className:"font-mono text-sm",children:e.id})}),(0,l.jsxs)(j.Z.Cell,{children:[(0,l.jsxs)("div",{className:"font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),l.jsx("div",{className:"text-sm text-gray-500",children:e.email})]}),l.jsx(j.Z.Cell,{children:l.jsx("div",{className:"flex space-x-2",children:["present","late","absent"].map(s=>{let a=getStatusIcon(s),n=t===s;return l.jsx("button",{onClick:()=>handleAttendanceChange(e.id,s),className:`p-2 rounded-lg border-2 transition-colors ${n?"present"===s?"border-green-500 bg-green-50 text-green-600":"late"===s?"border-yellow-500 bg-yellow-50 text-yellow-600":"border-red-500 bg-red-50 text-red-600":"border-gray-200 bg-white text-gray-400 hover:border-gray-300"}`,title:s.charAt(0).toUpperCase()+s.slice(1),children:l.jsx(a,{className:"w-4 h-4"})},s)})})}),l.jsx(j.Z.Cell,{children:l.jsx("input",{type:"text",value:b[e.id]||"",onChange:s=>handleNotesChange(e.id,s.target.value),placeholder:"Add notes...",className:"form-input text-sm"})})]},s)})})]})]})]}):(0,l.jsxs)(o.Z,{className:"text-center py-12",children:[l.jsx(f.WY8,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Students Found"}),l.jsx("p",{className:"text-gray-500",children:"This class doesn't have any students enrolled."})]}):(0,l.jsxs)(o.Z,{className:"text-center py-12",children:[l.jsx(f.vlc,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select a Class"}),l.jsx("p",{className:"text-gray-500",children:"Choose a class from the dropdown above to mark attendance."})]})]})})]})]})};a()}catch(e){a(e)}})}};