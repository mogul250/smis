"use strict";exports.id=7809,exports.ids=[7809],exports.modules={7809:(e,t,s)=>{s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var r=s(997),n=s(6689),l=s.n(n),c=s(5152),d=s.n(c),i=s(6761),x=s(3242),m=s(8303),o=e([i,m]);[i,m]=o.then?(await o)():o;let h=d()(()=>s.e(4082).then(s.bind(s,4082)),{loadableGenerated:{modules:["student\\attendance.js -> ../../components/common/Header"]},ssr:!1,loading:()=>r.jsx("header",{className:"bg-blue-600 text-white shadow-lg",children:r.jsx("div",{className:"container mx-auto px-4 py-3",children:r.jsx("h1",{className:"text-xl font-bold",children:"SMIS - Loading..."})})})}),g=d()(()=>Promise.all([s.e(7689),s.e(1163),s.e(6422)]).then(s.bind(s,6422)),{loadableGenerated:{modules:["student\\attendance.js -> ../../components/common/Sidebar"]},ssr:!1,loading:()=>r.jsx("aside",{className:"w-64 bg-gray-800 text-white min-h-screen",children:r.jsx("div",{className:"p-4",children:r.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Loading..."})})})}),useFontAwesome=()=>{let[e,t]=(0,n.useState)(null);return(0,n.useEffect)(()=>{Promise.resolve().then(s.bind(s,3803)).then(e=>{Promise.resolve().then(s.bind(s,9783)).then(s=>{t({FontAwesomeIcon:e.FontAwesomeIcon,faChartBar:s.faChartBar,faCalendarAlt:s.faCalendarAlt,faCheck:s.faCheck,faClock:s.faClock,faTimes:s.faTimes,faCalendar:s.faCalendar})})}).catch(()=>{t({FontAwesomeIcon:({icon:e,className:t})=>r.jsx("span",{className:t,children:{"chart-bar":"\uD83D\uDCCA","calendar-alt":"\uD83D\uDCC5",check:"✅",clock:"\uD83D\uDD50",times:"❌",calendar:"\uD83D\uDCC5"}[e?.iconName]||"\uD83D\uDCCB"}),faChartBar:{iconName:"chart-bar"},faCalendarAlt:{iconName:"calendar-alt"},faCheck:{iconName:"check"},faClock:{iconName:"clock"},faTimes:{iconName:"times"},faCalendar:{iconName:"calendar"}})})},[]),e},Card=({children:e,className:t=""})=>r.jsx("div",{className:`bg-white rounded-lg shadow border border-gray-200 p-6 ${t}`,children:e}),Alert=({children:e,variant:t="info"})=>r.jsx("div",{className:`p-4 rounded ${{error:"bg-red-100 text-red-800 border border-red-200",info:"bg-blue-100 text-blue-800 border border-blue-200",success:"bg-green-100 text-green-800 border border-green-200"}[t]}`,children:e}),LoadingSpinner=()=>r.jsx("div",{className:"flex justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),Badge=({children:e,variant:t="default"})=>r.jsx("span",{className:`px-2 py-1 rounded text-sm font-medium ${{success:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-800",default:"bg-gray-100 text-gray-800"}[t]}`,children:e}),__WEBPACK_DEFAULT_EXPORT__=()=>{let{user:e}=(0,i.a)(),t=useFontAwesome(),[s,a]=(0,n.useState)({startDate:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]}),{data:c,loading:d,error:o,refetch:u}=(0,x.h)(()=>m.t7.getAttendance(s.startDate,s.endDate),[s]),j=l().useMemo(()=>{if(!c||0===c.length)return{total:0,present:0,absent:0,late:0,percentage:0};let e=c.length,t=c.filter(e=>"present"===e.status).length,s=c.filter(e=>"absent"===e.status).length,a=c.filter(e=>"late"===e.status).length,r=e>0?((t+a)/e*100).toFixed(1):0;return{total:e,present:t,absent:s,late:a,percentage:r}},[c]),handleDateChange=(e,t)=>{a(s=>({...s,[e]:t}))};return e?"student"!==e.role?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(Alert,{variant:"error",children:"Access denied. Student access required."})}):(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(h,{}),(0,r.jsxs)("div",{className:"flex",children:[r.jsx(g,{}),r.jsx("main",{className:"flex-1 p-6",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Attendance Record"}),r.jsx("p",{className:"text-gray-600",children:"Track your class attendance and participation"})]}),r.jsx(Card,{children:(0,r.jsxs)("div",{className:"flex flex-wrap items-end gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),r.jsx("input",{type:"date",value:s.startDate,onChange:e=>handleDateChange("startDate",e.target.value),className:"form-input"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),r.jsx("input",{type:"date",value:s.endDate,onChange:e=>handleDateChange("endDate",e.target.value),className:"form-input"})]}),r.jsx("button",{onClick:u,className:"btn btn-primary",children:"Update"})]})}),d?r.jsx(Card,{className:"flex justify-center py-12",children:r.jsx(LoadingSpinner,{size:"lg"})}):o?r.jsx(Alert,{variant:"error",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{children:[r.jsx("strong",{children:"Failed to load attendance:"})," ",o]}),(0,r.jsxs)("p",{className:"text-sm mt-2",children:["Debug info: User role: ",e?.role,", User ID: ",e?.id]}),r.jsx("button",{onClick:u,className:"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700",children:"Retry"})]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[r.jsx(Card,{children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-12 h-12 bg-primary-blue rounded-lg flex items-center justify-center mr-4",children:t?r.jsx(t.FontAwesomeIcon,{icon:t.faChartBar,className:"text-white text-xl"}):r.jsx("span",{className:"text-white text-xl",children:"\uD83D\uDCCA"})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Attendance Rate"}),(0,r.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[j.percentage,"%"]})]})]})}),r.jsx(Card,{children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-12 h-12 bg-gray-500 rounded-lg flex items-center justify-center mr-4",children:t?r.jsx(t.FontAwesomeIcon,{icon:t.faCalendarAlt,className:"text-white text-xl"}):r.jsx("span",{className:"text-white text-xl",children:"\uD83D\uDCC5"})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Classes"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j.total})]})]})}),r.jsx(Card,{children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-12 h-12 bg-accent-green rounded-lg flex items-center justify-center mr-4",children:t?r.jsx(t.FontAwesomeIcon,{icon:t.faCheck,className:"text-white text-xl"}):r.jsx("span",{className:"text-white text-xl",children:"✅"})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Present"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j.present})]})]})}),r.jsx(Card,{children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-12 h-12 bg-accent-orange rounded-lg flex items-center justify-center mr-4",children:t?r.jsx(t.FontAwesomeIcon,{icon:t.faClock,className:"text-white text-xl"}):r.jsx("span",{className:"text-white text-xl",children:"\uD83D\uDD50"})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Late"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j.late})]})]})}),r.jsx(Card,{children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-12 h-12 bg-accent-red rounded-lg flex items-center justify-center mr-4",children:t?r.jsx(t.FontAwesomeIcon,{icon:t.faTimes,className:"text-white text-xl"}):r.jsx("span",{className:"text-white text-xl",children:"❌"})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Absent"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j.absent})]})]})})]}),(0,r.jsxs)(Card,{children:[r.jsx("div",{className:"border-b border-gray-200 pb-4 mb-4",children:r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Attendance Records"})}),c&&c.length>0?r.jsx("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Notes"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map((e,s)=>{let a=function(e){if(!t)return()=>r.jsx("span",{children:"⏳"});let{FontAwesomeIcon:s,faCheck:a,faClock:n,faTimes:l,faCalendar:c}=t;switch(e){case"present":return()=>r.jsx(s,{icon:a,className:"text-green-600"});case"late":return()=>r.jsx(s,{icon:n,className:"text-yellow-600"});case"absent":return()=>r.jsx(s,{icon:l,className:"text-red-600"});default:return()=>r.jsx(s,{icon:c,className:"text-gray-600"})}}(e.status);return(0,r.jsxs)("tr",{className:"transition-colors hover:bg-gray-50",children:[(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[r.jsx("div",{className:"font-medium text-gray-900",children:new Date(e.date).toLocaleDateString()}),r.jsx("div",{className:"text-sm text-gray-500",children:new Date(e.date).toLocaleDateString("en-US",{weekday:"short"})})]}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[r.jsx("div",{className:"font-medium text-gray-900",children:e.course_name}),r.jsx("div",{className:"text-sm text-gray-500",children:e.course_code})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:r.jsx("span",{className:"text-gray-900",children:e.teacher_name||"N/A"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(a,{}),r.jsx(Badge,{variant:function(e){switch(e){case"present":return"success";case"late":return"warning";case"absent":return"danger";default:return"default"}}(e.status),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:r.jsx("span",{className:"text-sm text-gray-600",children:e.marked_at?new Date(e.marked_at).toLocaleTimeString():"-"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:r.jsx("span",{className:"text-sm text-gray-600",children:e.notes||"-"})})]},s)})})]})}):(0,r.jsxs)("div",{className:"text-center py-8",children:[t?r.jsx(t.FontAwesomeIcon,{icon:t.faCalendar,className:"text-4xl mb-4 block text-gray-400"}):r.jsx("span",{className:"text-4xl mb-4 block",children:"\uD83D\uDCC5"}),r.jsx("p",{className:"text-gray-500",children:"No attendance records found for the selected date range."})]})]})]})]})})]})]}):r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(Alert,{variant:"error",children:"Please log in to access attendance records."})})};a()}catch(e){a(e)}})}};