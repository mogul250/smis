"use strict";(()=>{var e={};e.id=1072,e.ids=[1072,2888,660],e.modules={1116:(e,t,s)=>{s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{config:()=>j,default:()=>m,getServerSideProps:()=>g,getStaticPaths:()=>h,getStaticProps:()=>o,reportWebVitals:()=>v,routeModule:()=>_,unstable_getServerProps:()=>b,unstable_getServerSideProps:()=>N,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>f,unstable_getStaticProps:()=>p});var l=s(7093),r=s(5244),n=s(1323),i=s(9209),d=s.n(i),c=s(8397),x=s(8441),u=e([c,x]);[c,x]=u.then?(await u)():u;let m=(0,n.l)(x,"default"),o=(0,n.l)(x,"getStaticProps"),h=(0,n.l)(x,"getStaticPaths"),g=(0,n.l)(x,"getServerSideProps"),j=(0,n.l)(x,"config"),v=(0,n.l)(x,"reportWebVitals"),p=(0,n.l)(x,"unstable_getStaticProps"),f=(0,n.l)(x,"unstable_getStaticPaths"),y=(0,n.l)(x,"unstable_getStaticParams"),b=(0,n.l)(x,"unstable_getServerProps"),N=(0,n.l)(x,"unstable_getServerSideProps"),_=new l.PagesRouteModule({definition:{kind:r.x.PAGES,page:"/finance/students",pathname:"/finance/students",bundlePath:"",filename:""},components:{App:c.default,Document:d()},userland:x});a()}catch(e){a(e)}})},7014:(e,t,s)=>{s.d(t,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var a=s(997);s(6689);let __WEBPACK_DEFAULT_EXPORT__=({children:e,variant:t="default",size:s="md",className:l="",...r})=>a.jsx("span",{className:`inline-flex items-center font-medium rounded-full ${{default:"bg-gray-100 text-gray-800",primary:"bg-blue-100 text-blue-800",success:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-800",info:"bg-blue-100 text-blue-800"}[t]} ${{sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-0.5 text-xs",lg:"px-3 py-1 text-sm"}[s]} ${l}`,...r,children:e})},8441:(e,t,s)=>{s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var l=s(997),r=s(6689),n=s(6761),i=s(3242),d=s(3240),c=s(4082),x=s(6422),u=s(4105),m=s(6208),o=s(7014),h=s(9180),g=s(5822),j=s(9175),v=s(4549),p=s(6893),f=e([n,d,c,x]);[n,d,c,x]=f.then?(await f)():f;let __WEBPACK_DEFAULT_EXPORT__=()=>{let{user:e}=(0,n.a)(),[t,s]=(0,r.useState)(""),[a,f]=(0,r.useState)("all"),[y,b]=(0,r.useState)("all"),[N,_]=(0,r.useState)(null),{data:S,loading:w,error:Z,refetch:P}=(0,i.h)(()=>d.sz.getAllStudents({search:t,status:a,year:y}),[t,a,y],{fallbackData:{students:[],stats:{}}}),{loading:A,execute:C}=(0,i.c)();if(!e||"finance"!==e.role)return l.jsx("div",{className:"min-h-screen flex items-center justify-center",children:l.jsx(j.Z,{variant:"error",children:"Access denied. Finance access required."})});let F=S?.students||[],E=S?.stats||{},handleViewStudent=e=>{window.location.href=`/finance/students/${e}`},handleViewFees=async e=>{try{let t=await C(()=>d.sz.getStudentFees(e));alert(`Student has ${t?.length||0} fee records`)}catch(e){_({type:"error",text:e.response?.data?.message||"Failed to load student fees"})}},handleGenerateInvoice=async e=>{try{let t=await C(()=>d.sz.generateInvoice(e));alert(`Invoice generated for student ${e}. Total: $${t?.totalAmount||0}`)}catch(e){_({type:"error",text:e.response?.data?.message||"Failed to generate invoice"})}},getStatusBadgeVariant=e=>{switch(e){case"active":return"success";case"inactive":return"warning";case"graduated":return"primary";case"suspended":return"danger";default:return"default"}},getOutstandingBadgeVariant=e=>0===e?"success":e<500?"warning":"danger";return(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[l.jsx(c.Z,{}),(0,l.jsxs)("div",{className:"flex",children:[l.jsx(x.Z,{}),l.jsx("main",{className:"flex-1 p-6",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Management"}),l.jsx("p",{className:"text-gray-600",children:"Manage student accounts and financial records"})]}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[l.jsx(h.Z,{variant:"outline",icon:p.QqI,children:"Export Report"}),l.jsx(h.Z,{variant:"primary",icon:p.WY8,children:"Add Student"})]})]}),N&&l.jsx(j.Z,{variant:N.type,dismissible:!0,onDismiss:()=>_(null),children:N.text}),w?l.jsx(u.Z,{className:"flex justify-center py-12",children:l.jsx(v.Z,{size:"lg"})}):Z?(0,l.jsxs)(j.Z,{variant:"error",children:["Failed to load students: ",Z]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[l.jsx(u.Z,{children:(0,l.jsxs)("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-12 h-12 bg-primary-blue rounded-lg flex items-center justify-center mr-4",children:l.jsx(p.WY8,{className:"w-6 h-6 text-white"})}),(0,l.jsxs)("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Students"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:E.totalStudents||0}),(0,l.jsxs)("p",{className:"text-xs text-gray-500",children:[E.activeStudents||0," active"]})]})]})}),l.jsx(u.Z,{children:(0,l.jsxs)("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-12 h-12 bg-accent-green rounded-lg flex items-center justify-center mr-4",children:l.jsx(p.oQC,{className:"w-6 h-6 text-white"})}),(0,l.jsxs)("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Outstanding"}),(0,l.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["$",E.totalOutstanding?.toLocaleString()||"0"]}),(0,l.jsxs)("p",{className:"text-xs text-gray-500",children:[E.studentsWithFees||0," students"]})]})]})}),l.jsx(u.Z,{children:(0,l.jsxs)("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-12 h-12 bg-accent-orange rounded-lg flex items-center justify-center mr-4",children:l.jsx(p.bcx,{className:"w-6 h-6 text-white"})}),(0,l.jsxs)("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Overdue Fees"}),(0,l.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["$",E.overdueAmount?.toLocaleString()||"0"]}),(0,l.jsxs)("p",{className:"text-xs text-gray-500",children:[E.overdueStudents||0," students"]})]})]})}),l.jsx(u.Z,{children:(0,l.jsxs)("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-12 h-12 bg-accent-red rounded-lg flex items-center justify-center mr-4",children:l.jsx(p.vlc,{className:"w-6 h-6 text-white"})}),(0,l.jsxs)("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Graduated"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:E.graduatedStudents||0}),l.jsx("p",{className:"text-xs text-gray-500",children:"This year"})]})]})})]}),l.jsx(u.Z,{children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsx("div",{children:l.jsx(g.Z,{label:"Search",placeholder:"Search by name, ID, or email...",value:t,onChange:e=>s(e.target.value),icon:p.jRj})}),(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),l.jsx("select",{value:a,onChange:e=>f(e.target.value),className:"form-select",children:[{value:"all",label:"All Status"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"graduated",label:"Graduated"},{value:"suspended",label:"Suspended"}].map(e=>l.jsx("option",{value:e.value,children:e.label},e.value))})]}),(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Enrollment Year"}),l.jsx("select",{value:y,onChange:e=>b(e.target.value),className:"form-select",children:[{value:"all",label:"All Years"},{value:"2024",label:"2024"},{value:"2023",label:"2023"},{value:"2022",label:"2022"},{value:"2021",label:"2021"}].map(e=>l.jsx("option",{value:e.value,children:e.label},e.value))})]}),l.jsx("div",{className:"flex items-end",children:l.jsx(h.Z,{variant:"outline",onClick:P,className:"w-full",children:"Refresh"})})]})}),(0,l.jsxs)(u.Z,{children:[l.jsx(u.Z.Header,{children:l.jsx(u.Z.Title,{children:"Student Records"})}),F.length>0?(0,l.jsxs)(m.Z,{children:[l.jsx(m.Z.Header,{children:(0,l.jsxs)(m.Z.Row,{children:[l.jsx(m.Z.Head,{children:"Student"}),l.jsx(m.Z.Head,{children:"Contact"}),l.jsx(m.Z.Head,{children:"Enrollment"}),l.jsx(m.Z.Head,{children:"Status"}),l.jsx(m.Z.Head,{children:"Outstanding"}),l.jsx(m.Z.Head,{children:"Actions"})]})}),l.jsx(m.Z.Body,{children:F.map((e,t)=>(0,l.jsxs)(m.Z.Row,{children:[(0,l.jsxs)(m.Z.Cell,{children:[(0,l.jsxs)("div",{className:"font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),(0,l.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",e.student_id||e.id]})]}),l.jsx(m.Z.Cell,{children:(0,l.jsxs)("div",{className:"text-sm text-gray-900",children:[(0,l.jsxs)("div",{className:"flex items-center mb-1",children:[l.jsx(p.Imn,{className:"w-4 h-4 mr-2 text-gray-400"}),e.email]}),e.phone&&(0,l.jsxs)("div",{className:"flex items-center",children:[l.jsx(p.tUt,{className:"w-4 h-4 mr-2 text-gray-400"}),e.phone]})]})}),(0,l.jsxs)(m.Z.Cell,{children:[l.jsx("div",{className:"text-gray-900",children:e.enrollment_year||"N/A"}),(0,l.jsxs)("div",{className:"text-sm text-gray-500",children:["Year ",e.current_year||"N/A"]})]}),l.jsx(m.Z.Cell,{children:l.jsx(o.Z,{variant:getStatusBadgeVariant(e.status),children:e.status})}),l.jsx(m.Z.Cell,{children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsxs)(o.Z,{variant:getOutstandingBadgeVariant(e.outstanding_amount||0),children:["$",(e.outstanding_amount||0).toFixed(2)]}),e.overdue_count>0&&(0,l.jsxs)("span",{className:"ml-2 text-xs text-red-600",children:[e.overdue_count," overdue"]})]})}),l.jsx(m.Z.Cell,{children:(0,l.jsxs)("div",{className:"flex space-x-2",children:[l.jsx(h.Z,{variant:"outline",size:"sm",icon:p.rDJ,onClick:()=>handleViewStudent(e.id),children:"View"}),l.jsx(h.Z,{variant:"primary",size:"sm",icon:p.oQC,onClick:()=>handleViewFees(e.id),children:"Fees"}),l.jsx(h.Z,{variant:"warning",size:"sm",onClick:()=>handleGenerateInvoice(e.id),loading:A,children:"Invoice"})]})})]},t))})]}):(0,l.jsxs)("div",{className:"text-center py-8",children:[l.jsx(p.WY8,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Students Found"}),l.jsx("p",{className:"text-gray-500",children:"No students match the current filters. Try adjusting your search criteria."})]})]})]})]})})]})]})};a()}catch(e){a(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9648:e=>{e.exports=import("axios")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[7689,1163,9801,4608,9209,8450,9142,9175,3242,8397,6208,5822],()=>__webpack_exec__(1116));module.exports=s})();