"use strict";(()=>{var e={};e.id=7684,e.ids=[7684,2888,660],e.modules={8725:()=>{},4676:(e,t,s)=>{s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{config:()=>g,default:()=>o,getServerSideProps:()=>p,getStaticPaths:()=>u,getStaticProps:()=>h,reportWebVitals:()=>j,routeModule:()=>w,unstable_getServerProps:()=>y,unstable_getServerSideProps:()=>v,unstable_getStaticParams:()=>f,unstable_getStaticPaths:()=>N,unstable_getStaticProps:()=>b});var r=s(7093),l=s(5244),d=s(1323),i=s(9209),n=s.n(i),c=s(8397),m=s(2935),x=e([c,m]);[c,m]=x.then?(await x)():x;let o=(0,d.l)(m,"default"),h=(0,d.l)(m,"getStaticProps"),u=(0,d.l)(m,"getStaticPaths"),p=(0,d.l)(m,"getServerSideProps"),g=(0,d.l)(m,"config"),j=(0,d.l)(m,"reportWebVitals"),b=(0,d.l)(m,"unstable_getStaticProps"),N=(0,d.l)(m,"unstable_getStaticPaths"),f=(0,d.l)(m,"unstable_getStaticParams"),y=(0,d.l)(m,"unstable_getServerProps"),v=(0,d.l)(m,"unstable_getServerSideProps"),w=new r.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/admin/departments",pathname:"/admin/departments",bundlePath:"",filename:""},components:{App:c.default,Document:n()},userland:m});a()}catch(e){a(e)}})},6761:(e,t,s)=>{s.a(e,async(e,a)=>{try{s.d(t,{a:()=>useAuth});var r=s(6689),l=s(8786),d=e([l]);l=(d.then?(await d)():d)[0];let useAuth=()=>{let e=(0,r.useContext)(l.ZP);if(!e)throw Error("useAuth must be used within an AuthProvider");return e};a()}catch(e){a(e)}})},2935:(e,t,s)=>{s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var r=s(997),l=s(6689),d=s(1163),i=s(6761),n=s(8303),c=s(4082),m=s(6422),x=s(8725),o=s(6893),h=e([i,n,c,m]);[i,n,c,m]=h.then?(await h)():h;let __WEBPACK_DEFAULT_EXPORT__=()=>{let{user:e,isAuthenticated:t}=(0,i.a)(),s=(0,d.useRouter)(),[a,h]=(0,l.useState)([]),[u,p]=(0,l.useState)(!0),[g,j]=(0,l.useState)(null),[b,N]=(0,l.useState)(!1),[f,y]=(0,l.useState)(null),fetchDepartments=async()=>{try{p(!0),j(null);let e=await n.Sb.getAllDepartments(1,50);e&&e.departments?h(e.departments):Array.isArray(e)?h(e):h([])}catch(e){j(e.message||"Failed to fetch departments"),h([])}finally{p(!1)}};(0,l.useEffect)(()=>{t&&e?.role==="admin"&&fetchDepartments()},[t,e]);let handleDeleteDepartment=async(e,t)=>{if(confirm(`Are you sure you want to delete ${t}? This action cannot be undone.`))try{await n.Sb.deleteDepartment(e),fetchDepartments(),alert("Department deleted successfully!")}catch(e){alert("Failed to delete department. Please try again.")}},handleAction=(e,t)=>{switch(e){case"view":y(t),N(!0);break;case"edit":s.push(`/admin/departments/edit?departmentId=${t.id}`);break;case"delete":handleDeleteDepartment(t.id,t.name)}},closeModal=()=>{N(!1),y(null)};return t&&e?.role==="admin"?u?r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"Loading departments..."})]})}):(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(c.default,{}),(0,r.jsxs)("div",{className:"flex",children:[r.jsx(m.default,{}),(0,r.jsxs)("main",{className:"flex-1 p-6",children:[r.jsx("div",{className:"mb-6",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Department Management"}),r.jsx("p",{className:"text-gray-600",children:"Manage academic departments and their information"})]}),r.jsx("button",{onClick:()=>s.push("/admin/departments/new"),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:"Add Department"})]})}),g&&(0,r.jsxs)("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:[r.jsx("p",{className:"text-red-800",children:g}),r.jsx("button",{onClick:fetchDepartments,className:"mt-2 text-red-600 hover:text-red-800 underline",children:"Try again"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[r.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:r.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded"})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Departments"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.length})]})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:r.jsx("div",{className:"w-6 h-6 bg-green-600 rounded"})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Departments"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.filter(e=>"active"===e.status).length})]})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:r.jsx("div",{className:"w-6 h-6 bg-purple-600 rounded"})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("p",{className:"text-sm font-medium text-gray-600",children:"With HOD"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.filter(e=>e.hod_name).length})]})]})})]}),(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,r.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Departments (",a.length,")"]})}),r.jsx("div",{className:"overflow-x-auto",children:0===a.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx("div",{className:"mx-auto h-12 w-12 bg-gray-400 rounded"}),r.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No departments found"}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating a new department."}),r.jsx("div",{className:"mt-6",children:r.jsx("button",{onClick:()=>s.push("/admin/departments/new"),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:"Add Department"})})]}):(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Head of Department"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("div",{className:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center",children:r.jsx("div",{className:"h-5 w-5 bg-blue-600 rounded"})})}),(0,r.jsxs)("div",{className:"ml-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name||"N/A"}),r.jsx("div",{className:"text-sm text-gray-500",children:e.code||"N/A"})]})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:e.hod_name||"Not assigned"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${"active"===e.status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:e.status||"active"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[r.jsx("button",{onClick:()=>handleAction("view",e),className:"text-blue-600 hover:text-blue-900 p-1 rounded",title:"View Department",children:"View"}),r.jsx("button",{onClick:()=>handleAction("edit",e),className:"text-indigo-600 hover:text-indigo-900 p-1 rounded",title:"Edit Department",children:"Edit"}),r.jsx("button",{onClick:()=>handleAction("delete",e),className:"text-red-600 hover:text-red-900 p-1 rounded",title:"Delete Department",children:"Delete"})]})})]},e.id))})]})})]}),b&&f&&r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,r.jsxs)("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between pb-4 border-b border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(x.FiBuilding,{className:"w-6 h-6 text-blue-600 mr-3"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Department Details"})]}),r.jsx("button",{onClick:closeModal,className:"text-gray-400 hover:text-gray-600 transition-colors",children:r.jsx(o.q5L,{className:"w-6 h-6"})})]}),(0,r.jsxs)("div",{className:"mt-4 space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"text-md font-medium text-gray-900 mb-3 flex items-center",children:[r.jsx(o.H33,{className:"w-4 h-4 mr-2"}),"Basic Information"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Department Name"}),r.jsx("p",{className:"mt-1 text-sm text-gray-900",children:f.name||"N/A"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Department Code"}),r.jsx("p",{className:"mt-1 text-sm text-gray-900",children:f.code||"N/A"})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Description"}),r.jsx("p",{className:"mt-1 text-sm text-gray-900",children:f.description||"No description provided"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"text-md font-medium text-gray-900 mb-3 flex items-center",children:[r.jsx(o.fzv,{className:"w-4 h-4 mr-2"}),"Management"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Head of Department"}),r.jsx("p",{className:"mt-1 text-sm text-gray-900",children:f.hod_name||"Not assigned"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Status"}),r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${"active"===f.status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:f.status||"active"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"text-md font-medium text-gray-900 mb-3 flex items-center",children:[r.jsx(o.bAx,{className:"w-4 h-4 mr-2"}),"Statistics"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Staff Count"}),(0,r.jsxs)("p",{className:"mt-1 text-sm text-gray-900 flex items-center",children:[r.jsx(o.WY8,{className:"w-4 h-4 mr-1"}),f.staff_count||0]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Student Count"}),(0,r.jsxs)("p",{className:"mt-1 text-sm text-gray-900 flex items-center",children:[r.jsx(o.WY8,{className:"w-4 h-4 mr-1"}),f.student_count||0]})]})]})]}),(f.created_at||f.updated_at)&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"text-md font-medium text-gray-900 mb-3 flex items-center",children:[r.jsx(o.vlc,{className:"w-4 h-4 mr-2"}),"Timestamps"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.created_at&&(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Created At"}),r.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(f.created_at).toLocaleDateString()})]}),f.updated_at&&(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Last Updated"}),r.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(f.updated_at).toLocaleDateString()})]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-end pt-6 border-t border-gray-200 mt-6 space-x-3",children:[r.jsx("button",{onClick:()=>{closeModal(),handleAction("edit",f)},className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Edit Department"}),r.jsx("button",{onClick:closeModal,className:"px-4 py-2 bg-gray-300 text-gray-700 text-sm font-medium rounded-md hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Close"})]})]})})]})]})]}):r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Access Denied"}),r.jsx("p",{className:"text-gray-600 mt-2",children:"You need admin privileges to access this page."})]})})};a()}catch(e){a(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9783:e=>{e.exports=import("@fortawesome/free-solid-svg-icons")},3803:e=>{e.exports=import("@fortawesome/react-fontawesome")},9648:e=>{e.exports=import("axios")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[7689,1163,9801,4608,9209,8450,6422,4082,8397],()=>__webpack_exec__(4676));module.exports=s})();