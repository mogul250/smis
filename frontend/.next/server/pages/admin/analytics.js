"use strict";(()=>{var e={};e.id=867,e.ids=[867,2888,660],e.modules={934:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{config:()=>p,default:()=>x,getServerSideProps:()=>u,getStaticPaths:()=>h,getStaticProps:()=>g,reportWebVitals:()=>b,routeModule:()=>w,unstable_getServerProps:()=>f,unstable_getServerSideProps:()=>N,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>v,unstable_getStaticProps:()=>j});var l=t(7093),r=t(5244),i=t(1323),n=t(9209),c=t.n(n),d=t(8397),o=t(5744),m=e([d,o]);[d,o]=m.then?(await m)():m;let x=(0,i.l)(o,"default"),g=(0,i.l)(o,"getStaticProps"),h=(0,i.l)(o,"getStaticPaths"),u=(0,i.l)(o,"getServerSideProps"),p=(0,i.l)(o,"config"),b=(0,i.l)(o,"reportWebVitals"),j=(0,i.l)(o,"unstable_getStaticProps"),v=(0,i.l)(o,"unstable_getStaticPaths"),y=(0,i.l)(o,"unstable_getStaticParams"),f=(0,i.l)(o,"unstable_getServerProps"),N=(0,i.l)(o,"unstable_getServerSideProps"),w=new l.PagesRouteModule({definition:{kind:r.x.PAGES,page:"/admin/analytics",pathname:"/admin/analytics",bundlePath:"",filename:""},components:{App:d.default,Document:c()},userland:o});a()}catch(e){a(e)}})},880:(e,s,t)=>{t.d(s,{ZP:()=>__WEBPACK_DEFAULT_EXPORT__,gp:()=>UserActivityTimeline,se:()=>UserDistributionChart});var a=t(997);t(6689);var l=t(4105),r=t(6893);let UserActivityTimeline=({activities:e=[],loading:s})=>{let t=[{id:1,type:"user_created",message:"New student John Doe was created",timestamp:new Date(Date.now()-72e5),icon:r.zy7,color:"blue"},{id:2,type:"user_login",message:"Teacher Sarah Wilson logged in",timestamp:new Date(Date.now()-144e5),icon:r.bAx,color:"green"},{id:3,type:"user_updated",message:"Admin updated user permissions",timestamp:new Date(Date.now()-216e5),icon:r.WY8,color:"orange"},{id:4,type:"user_deactivated",message:"User account was deactivated",timestamp:new Date(Date.now()-288e5),icon:r.tMu,color:"red"}],i=e.length>0?e:t,getTimeAgo=e=>{let s=new Date,t=s-new Date(e),a=Math.floor(t/36e5),l=Math.floor(t/6e4);return a>0?`${a}h ago`:l>0?`${l}m ago`:"Just now"},getColorClasses=e=>{let s={blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",orange:"bg-orange-100 text-orange-600",red:"bg-red-100 text-red-600",purple:"bg-purple-100 text-purple-600"};return s[e]||s.blue};return s?a.jsx(l.Z,{className:"p-6",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[a.jsx("div",{className:"h-6 bg-gray-200 rounded w-32 mb-4"}),a.jsx("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full"}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-1"}),a.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]})]},s))})]})}):(0,a.jsxs)(l.Z,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Activity"}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[a.jsx(r.TCC,{className:"w-4 h-4 mr-1"}),"Live updates"]})]}),a.jsx("div",{className:"space-y-4",children:i.map((e,s)=>{let t=e.icon,l=getColorClasses(e.color);return(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${l}`,children:a.jsx(t,{className:"w-4 h-4"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm text-gray-900",children:e.message}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:getTimeAgo(e.timestamp)})]})]},e.id||s)})}),a.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:a.jsx("button",{className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View all activity â†’"})})]})},UserDistributionChart=({stats:e,loading:s})=>{let t=Object.values(e.byRole||{}).reduce((e,s)=>e+s,0);return s?a.jsx(l.Z,{className:"p-6",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[a.jsx("div",{className:"h-6 bg-gray-200 rounded w-32 mb-4"}),a.jsx("div",{className:"h-48 bg-gray-200 rounded"})]})}):(0,a.jsxs)(l.Z,{className:"p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"User Distribution"}),a.jsx("div",{className:"space-y-4",children:[{key:"student",label:"Students",color:"bg-blue-500"},{key:"teacher",label:"Teachers",color:"bg-green-500"},{key:"hod",label:"HODs",color:"bg-purple-500"},{key:"finance",label:"Finance",color:"bg-orange-500"},{key:"admin",label:"Admins",color:"bg-red-500"}].map(s=>{let l=e.byRole?.[s.key]||0,r=t>0?l/t*100:0;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:s.label}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[l," (",Math.round(r),"%)"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:`${s.color} h-2 rounded-full transition-all duration-300`,style:{width:`${r}%`}})})]},s.key)})}),a.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200 text-center",children:(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Total: ",(0,a.jsxs)("span",{className:"font-medium text-gray-900",children:[t," users"]})]})})]})},__WEBPACK_DEFAULT_EXPORT__=({stats:e,loading:s})=>{let t=[{title:"User Growth",description:"New users this month",value:e.newThisMonth||0,change:"+23%",changeType:"positive",icon:r.zy7,color:"blue"},{title:"Active Rate",description:"Users active in last 30 days",value:`${e.totalUsers>0?Math.round(e.activeUsers/e.totalUsers*100):0}%`,change:"+5%",changeType:"positive",icon:r.bAx,color:"green"},{title:"Login Rate",description:"Users logged in today",value:Math.round(.3*e.activeUsers)||0,change:"-2%",changeType:"negative",icon:r.TCC,color:"orange"},{title:"Completion Rate",description:"Profiles completed",value:`${Math.round(.85*e.activeUsers)||0}%`,change:"+12%",changeType:"positive",icon:r.tMu,color:"purple"}],getColorClasses=e=>{let s={blue:{bg:"bg-blue-50",icon:"text-blue-600",iconBg:"bg-blue-100"},green:{bg:"bg-green-50",icon:"text-green-600",iconBg:"bg-green-100"},orange:{bg:"bg-orange-50",icon:"text-orange-600",iconBg:"bg-orange-100"},purple:{bg:"bg-purple-50",icon:"text-purple-600",iconBg:"bg-purple-100"}};return s[e]||s.blue};return s?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[void 0,void 0,void 0,void 0].map((e,s)=>a.jsx(l.Z,{className:"p-6 animate-pulse",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 mb-2"}),a.jsx("div",{className:"h-8 bg-gray-200 rounded w-16 mb-2"}),a.jsx("div",{className:"h-3 bg-gray-200 rounded w-20"})]}),a.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-lg"})]})},s))}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:t.map((e,s)=>{let t=e.icon,i=getColorClasses(e.color),n="positive"===e.changeType;return a.jsx(l.Z,{className:"p-6 hover:shadow-md transition-shadow duration-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:e.title}),a.jsx("p",{className:"text-2xl font-bold text-gray-900 mb-2",children:"number"==typeof e.value?e.value.toLocaleString():e.value}),(0,a.jsxs)("div",{className:"flex items-center",children:[n?a.jsx(r.QqI,{className:"w-4 h-4 text-green-500 mr-1"}):a.jsx(r.ZBs,{className:"w-4 h-4 text-red-500 mr-1"}),a.jsx("span",{className:`text-sm font-medium ${n?"text-green-600":"text-red-600"}`,children:e.change}),a.jsx("span",{className:"text-sm text-gray-500 ml-1",children:e.description})]})]}),a.jsx("div",{className:`w-12 h-12 ${i.iconBg} rounded-lg flex items-center justify-center`,children:a.jsx(t,{className:`w-6 h-6 ${i.icon}`})})]})},s)})})}},5744:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var l=t(997),r=t(6689),i=t(1163),n=t(6761),c=t(8303),d=t(4082),o=t(6422),m=t(9180),x=t(4105),g=t(880),h=t(856),u=t(6893),p=e([n,c,d,o]);[n,c,d,o]=p.then?(await p)():p;let __WEBPACK_DEFAULT_EXPORT__=()=>{let{user:e,isAuthenticated:s}=(0,n.a)(),t=(0,i.useRouter)(),[a,p]=(0,r.useState)(!0),[b,j]=(0,r.useState)(!1),[v,y]=(0,r.useState)("30d"),[f,N]=(0,r.useState)({totalUsers:0,activeUsers:0,newThisMonth:0,byRole:{}}),[w,_]=(0,r.useState)({totalLogins:0,avgSessionTime:0,bounceRate:0,systemUptime:0});(0,r.useEffect)(()=>{if(!s||e?.role!=="admin"){t.push("/dashboard");return}},[s,e,t]);let fetchAnalytics=async()=>{try{p(!0);let e=await c.Sb.getAllUsers(1,1e3),s=e.users||[],t={totalUsers:s.length,activeUsers:s.filter(e=>"active"===e.status).length,newThisMonth:s.filter(e=>{let s=new Date(e.created_at),t=new Date;return s.getMonth()===t.getMonth()&&s.getFullYear()===t.getFullYear()}).length,byRole:{}};s.forEach(e=>{t.byRole[e.role]=(t.byRole[e.role]||0)+1}),N(t),_({totalLogins:Math.floor(2.3*t.totalUsers),avgSessionTime:24,bounceRate:12,systemUptime:99.9})}catch(e){}finally{p(!1),j(!1)}};if((0,r.useEffect)(()=>{s&&e?.role==="admin"&&fetchAnalytics()},[s,e,v]),!s||e?.role!=="admin")return null;let S=[{title:"Total Logins",value:w.totalLogins,change:"+15%",changeType:"positive",icon:u.bAx,color:"blue"},{title:"Avg Session Time",value:`${w.avgSessionTime}m`,change:"+8%",changeType:"positive",icon:u.QqI,color:"green"},{title:"Bounce Rate",value:`${w.bounceRate}%`,change:"-3%",changeType:"positive",icon:u.DKx,color:"orange"},{title:"System Uptime",value:`${w.systemUptime}%`,change:"+0.1%",changeType:"positive",icon:u.bAx,color:"purple"}];return(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[l.jsx(d.default,{}),(0,l.jsxs)("div",{className:"flex",children:[l.jsx(o.default,{}),l.jsx("main",{className:"flex-1 overflow-auto",children:(0,l.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[l.jsx("div",{className:"mb-8",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[l.jsx(u.DKx,{className:"mr-3 text-blue-600"}),"Analytics Dashboard"]}),l.jsx("p",{className:"text-gray-600 mt-1",children:"System performance and user insights"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsxs)("select",{value:v,onChange:e=>y(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"7d",children:"Last 7 days"}),l.jsx("option",{value:"30d",children:"Last 30 days"}),l.jsx("option",{value:"90d",children:"Last 90 days"}),l.jsx("option",{value:"1y",children:"Last year"})]}),l.jsx(m.Z,{variant:"outline",icon:u.Bw1,onClick:()=>{j(!0),fetchAnalytics()},loading:b,size:"sm",children:"Refresh"}),l.jsx(m.Z,{variant:"outline",icon:u._hL,onClick:()=>{let e={userStats:f,systemStats:w,exportDate:new Date().toISOString(),timeRange:v},s=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),t=URL.createObjectURL(s),a=document.createElement("a");a.href=t,a.download=`analytics-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t)},size:"sm",children:"Export"})]})]})}),(0,l.jsxs)("div",{className:"mb-8",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"User Overview"}),l.jsx(h.Z,{stats:f,totalUsers:f.totalUsers,loading:a})]}),(0,l.jsxs)("div",{className:"mb-8",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"User Analytics"}),l.jsx(g.ZP,{stats:f,loading:a})]}),(0,l.jsxs)("div",{className:"mb-8",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"System Metrics"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:S.map((e,s)=>{let t=e.icon,a="positive"===e.changeType;return l.jsx(x.Z,{className:"p-6 hover:shadow-md transition-shadow duration-200",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:e.title}),l.jsx("p",{className:"text-2xl font-bold text-gray-900 mb-2",children:"number"==typeof e.value?e.value.toLocaleString():e.value}),(0,l.jsxs)("div",{className:"flex items-center",children:[l.jsx(u.QqI,{className:`w-4 h-4 mr-1 ${a?"text-green-500":"text-red-500"}`}),l.jsx("span",{className:`text-sm font-medium ${a?"text-green-600":"text-red-600"}`,children:e.change}),l.jsx("span",{className:"text-sm text-gray-500 ml-1",children:"vs last period"})]})]}),l.jsx("div",{className:`w-12 h-12 bg-${e.color}-100 rounded-lg flex items-center justify-center`,children:l.jsx(t,{className:`w-6 h-6 text-${e.color}-600`})})]})},s)})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[l.jsx(g.se,{stats:f,loading:a}),l.jsx(g.gp,{loading:a})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,l.jsxs)(x.Z,{className:"p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Peak Usage Times"}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Morning (8-12 PM)"}),(0,l.jsxs)("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:l.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:"75%"}})}),l.jsx("span",{className:"text-sm font-medium",children:"75%"})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Afternoon (12-6 PM)"}),(0,l.jsxs)("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:l.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"90%"}})}),l.jsx("span",{className:"text-sm font-medium",children:"90%"})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Evening (6-10 PM)"}),(0,l.jsxs)("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:l.jsx("div",{className:"bg-orange-500 h-2 rounded-full",style:{width:"45%"}})}),l.jsx("span",{className:"text-sm font-medium",children:"45%"})]})]})]})]}),(0,l.jsxs)(x.Z,{className:"p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Departments"}),l.jsx("div",{className:"space-y-3",children:["Computer Science","Mathematics","Physics","Chemistry"].map((e,s)=>(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:e}),l.jsx("span",{className:"text-sm font-medium",children:Math.floor(50*Math.random())+20})]},e))})]}),(0,l.jsxs)(x.Z,{className:"p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),(0,l.jsxs)("div",{className:"space-y-3",children:[l.jsx(m.Z,{variant:"outline",className:"w-full justify-start",icon:u.WY8,onClick:()=>t.push("/admin/users"),children:"Manage Users"}),l.jsx(m.Z,{variant:"outline",className:"w-full justify-start",icon:u.vlc,onClick:()=>t.push("/admin/calendar"),children:"Academic Calendar"}),l.jsx(m.Z,{variant:"outline",className:"w-full justify-start",icon:u.DKx,children:"Generate Report"})]})]})]})]})})]})]})};a()}catch(e){a(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9783:e=>{e.exports=import("@fortawesome/free-solid-svg-icons")},3803:e=>{e.exports=import("@fortawesome/react-fontawesome")},9648:e=>{e.exports=import("axios")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var s=require("../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[7689,1163,9801,4608,9209,8450,6422,4082,8397,111],()=>__webpack_exec__(934));module.exports=t})();