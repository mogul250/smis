"use strict";(()=>{var e={};e.id=5994,e.ids=[5994,2888,660],e.modules={8609:(e,t,s)=>{s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{config:()=>S,default:()=>u,getServerSideProps:()=>_,getStaticPaths:()=>x,getStaticProps:()=>h,reportWebVitals:()=>p,routeModule:()=>y,unstable_getServerProps:()=>j,unstable_getServerSideProps:()=>v,unstable_getStaticParams:()=>f,unstable_getStaticPaths:()=>b,unstable_getStaticProps:()=>g});var r=s(7093),i=s(5244),l=s(1323),o=s(9209),d=s.n(o),c=s(8397),n=s(5906),m=e([c,n]);[c,n]=m.then?(await m)():m;let u=(0,l.l)(n,"default"),h=(0,l.l)(n,"getStaticProps"),x=(0,l.l)(n,"getStaticPaths"),_=(0,l.l)(n,"getServerSideProps"),S=(0,l.l)(n,"config"),p=(0,l.l)(n,"reportWebVitals"),g=(0,l.l)(n,"unstable_getStaticProps"),b=(0,l.l)(n,"unstable_getStaticPaths"),f=(0,l.l)(n,"unstable_getStaticParams"),j=(0,l.l)(n,"unstable_getServerProps"),v=(0,l.l)(n,"unstable_getServerSideProps"),y=new r.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/admin/timetable",pathname:"/admin/timetable",bundlePath:"",filename:""},components:{App:c.default,Document:d()},userland:n});a()}catch(e){a(e)}})},5906:(e,t,s)=>{s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var r=s(997),i=s(6689),l=s(968),o=s.n(l),d=s(6761),c=s(3242),n=s(3240),m=s(4082),u=s(6422),h=s(4105),x=s(9180),_=s(9175),S=s(4549),p=s(1618),g=e([d,n,m,u]);[d,n,m,u]=g.then?(await g)():g;let __WEBPACK_DEFAULT_EXPORT__=()=>{let{user:e}=(0,d.a)(),[t,s]=(0,i.useState)({}),[a,l]=(0,i.useState)(!1),[g,b]=(0,i.useState)(null),[f,j]=(0,i.useState)("create"),[v,y]=(0,i.useState)(""),[w,P]=(0,i.useState)(!1),{data:N,loading:C,error:T,refetch:A}=(0,c.h)(()=>Promise.resolve([{id:1,course_id:1,course_name:"Computer Science 101",course_code:"CS101",teacher_id:2,teacher_name:"Dr. John Smith",day_of_week:1,start_time:"09:00:00",end_time:"10:30:00",room:"Room 101",semester:"Fall 2024"},{id:2,course_id:2,course_name:"Mathematics 201",course_code:"MATH201",teacher_id:3,teacher_name:"Prof. Jane Doe",day_of_week:2,start_time:"11:00:00",end_time:"12:30:00",room:"Room 102",semester:"Fall 2024"}])),D=[{id:1,name:"Computer Science 101",course_code:"CS101"},{id:2,name:"Mathematics 201",course_code:"MATH201"},{id:3,name:"Physics 101",course_code:"PHY101"}],E=[{id:2,first_name:"John",last_name:"Smith"},{id:3,first_name:"Jane",last_name:"Doe"},{id:4,first_name:"Bob",last_name:"Wilson"}],{execute:Z,loading:k}=(0,c.c)(),{execute:q,loading:R}=(0,c.c)(),{execute:M,loading:F}=(0,c.c)();if(!e||"admin"!==e.role)return r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(_.Z,{variant:"error",children:"Access denied. Admin access required."})});let handleRefresh=async()=>{P(!0);try{await A()}finally{P(!1)}},handleAddSlot=(e={})=>{b(e),j("create"),l(!0)},handleEditSlot=e=>{b(e),j("edit"),l(!0)},handleDeleteSlot=async e=>{if(confirm(`Are you sure you want to delete this timetable slot for ${e.course_name}?`))try{await M(()=>n.Sb.setupTimetable({action:"delete",timetableData:{id:e.id}})),y("Timetable slot deleted successfully"),setTimeout(()=>y(""),3e3),A()}catch(e){}},handleSaveSlot=async e=>{try{"create"===f?(await Z(()=>n.Sb.setupTimetable({action:"add",timetableData:{course_id:e.course_id,teacher_id:e.teacher_id,day:e.day_of_week,start_time:e.start_time,end_time:e.end_time,room:e.room,semester:e.semester}})),y("Timetable slot created successfully")):(await q(()=>n.Sb.setupTimetable({action:"update",timetableData:{id:e.id,course_id:e.course_id,teacher_id:e.teacher_id,day:e.day_of_week,start_time:e.start_time,end_time:e.end_time,room:e.room,semester:e.semester}})),y("Timetable slot updated successfully")),setTimeout(()=>y(""),3e3),l(!1),b(null),A()}catch(e){}},L=N?.filter(e=>{if(t.semester&&e.semester!==t.semester||t.day&&e.day_of_week.toString()!==t.day||t.teacher&&e.teacher_id.toString()!==t.teacher||t.course&&e.course_id.toString()!==t.course)return!1;if(t.search){let s=t.search.toLowerCase();return e.course_name?.toLowerCase().includes(s)||e.course_code?.toLowerCase().includes(s)||e.teacher_name?.toLowerCase().includes(s)||e.room?.toLowerCase().includes(s)}return!0})||[];return(0,r.jsxs)(r.Fragment,{children:[r.jsx(o(),{children:r.jsx("title",{children:"Timetable Management - Admin Dashboard"})}),(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(m.Z,{}),(0,r.jsxs)("div",{className:"flex",children:[r.jsx(u.Z,{}),r.jsx("main",{className:"flex-1 overflow-auto",children:(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Timetable Management"}),r.jsx("p",{className:"text-gray-600 mt-1",children:"Create and manage class schedules across all departments"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx(x.Z,{variant:"outline",size:"sm",onClick:handleRefresh,loading:w,children:"\uD83D\uDD04 Refresh"}),r.jsx(x.Z,{onClick:()=>handleAddSlot(),children:"âž• Add Slot"})]})]}),v&&r.jsx(_.Z,{variant:"success",dismissible:!0,onDismiss:()=>y(""),children:v}),T&&(0,r.jsxs)(_.Z,{variant:"error",children:["Error loading timetable: ",T]}),r.jsx(p.QD,{filters:t,onFilterChange:e=>{s(e)},teachers:E,courses:D,showTeacherFilter:!0,showCourseFilter:!0,onReset:()=>{s({})},onExport:()=>{}}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,r.jsxs)(h.Z,{className:"p-4",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:N?.length||0}),r.jsx("div",{className:"text-sm text-gray-600",children:"Total Slots"})]}),(0,r.jsxs)(h.Z,{className:"p-4",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:new Set(N?.map(e=>e.course_id)).size||0}),r.jsx("div",{className:"text-sm text-gray-600",children:"Courses Scheduled"})]}),(0,r.jsxs)(h.Z,{className:"p-4",children:[r.jsx("div",{className:"text-2xl font-bold text-purple-600",children:new Set(N?.map(e=>e.teacher_id)).size||0}),r.jsx("div",{className:"text-sm text-gray-600",children:"Teachers Assigned"})]}),(0,r.jsxs)(h.Z,{className:"p-4",children:[r.jsx("div",{className:"text-2xl font-bold text-orange-600",children:new Set(N?.map(e=>e.room)).size||0}),r.jsx("div",{className:"text-sm text-gray-600",children:"Rooms Used"})]})]}),C?r.jsx(h.Z,{className:"p-12",children:r.jsx("div",{className:"flex justify-center",children:r.jsx(S.Z,{size:"lg"})})}):r.jsx(p.mG,{timetable:L,editable:!0,showActions:!0,colorScheme:"course",title:"Master Timetable",onSlotClick:handleEditSlot,onSlotEdit:handleEditSlot,onSlotDelete:handleDeleteSlot,onAddSlot:handleAddSlot})]})})]})]}),r.jsx(p.V,{isOpen:a,onClose:()=>{l(!1),b(null)},onSave:handleSaveSlot,slot:g,mode:f,courses:D,teachers:E,loading:k||R})]})};a()}catch(e){a(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9648:e=>{e.exports=import("axios")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[7689,1163,9801,4608,9209,8450,9142,9175,3242,8397,5822,9060],()=>__webpack_exec__(8609));module.exports=s})();