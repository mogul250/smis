"use strict";(()=>{var e={};e.id=4916,e.ids=[4916,2888,660],e.modules={7881:(e,a,t)=>{t.a(e,async(e,s)=>{try{t.r(a),t.d(a,{config:()=>g,default:()=>u,getServerSideProps:()=>p,getStaticPaths:()=>h,getStaticProps:()=>x,reportWebVitals:()=>v,routeModule:()=>y,unstable_getServerProps:()=>N,unstable_getServerSideProps:()=>S,unstable_getStaticParams:()=>j,unstable_getStaticPaths:()=>b,unstable_getStaticProps:()=>f});var r=t(7093),l=t(5244),i=t(1323),n=t(9209),d=t.n(n),m=t(8397),c=t(627),o=e([m,c]);[m,c]=o.then?(await o)():o;let u=(0,i.l)(c,"default"),x=(0,i.l)(c,"getStaticProps"),h=(0,i.l)(c,"getStaticPaths"),p=(0,i.l)(c,"getServerSideProps"),g=(0,i.l)(c,"config"),v=(0,i.l)(c,"reportWebVitals"),f=(0,i.l)(c,"unstable_getStaticProps"),b=(0,i.l)(c,"unstable_getStaticPaths"),j=(0,i.l)(c,"unstable_getStaticParams"),N=(0,i.l)(c,"unstable_getServerProps"),S=(0,i.l)(c,"unstable_getServerSideProps"),y=new r.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/admin/users/edit",pathname:"/admin/users/edit",bundlePath:"",filename:""},components:{App:m.default,Document:d()},userland:c});s()}catch(e){s(e)}})},6761:(e,a,t)=>{t.a(e,async(e,s)=>{try{t.d(a,{a:()=>useAuth});var r=t(6689),l=t(8786),i=e([l]);l=(i.then?(await i)():i)[0];let useAuth=()=>{let e=(0,r.useContext)(l.ZP);if(!e)throw Error("useAuth must be used within an AuthProvider");return e};s()}catch(e){s(e)}})},627:(e,a,t)=>{t.a(e,async(e,s)=>{try{t.r(a),t.d(a,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var r=t(997),l=t(6689),i=t(1163),n=t(6761),d=t(8303),m=t(4082),c=t(6422),o=t(9180),u=t(4105),x=t(5822),h=t(897),p=t(4549),g=t(6893),v=e([n,d,m,c]);[n,d,m,c]=v.then?(await v)():v;let __WEBPACK_DEFAULT_EXPORT__=()=>{let{user:e,isAuthenticated:a}=(0,n.a)(),t=(0,i.useRouter)(),{userId:s}=t.query,[v,f]=(0,l.useState)({firstName:"",lastName:"",email:"",role:"student",departmentId:"",status:"active"}),[b,j]=(0,l.useState)([]),[N,S]=(0,l.useState)(!0),[y,_]=(0,l.useState)(!1),[P,C]=(0,l.useState)(null),[w,q]=(0,l.useState)(null),[I,A]=(0,l.useState)({});(0,l.useEffect)(()=>{if(!a||e?.role!=="admin"){t.push("/dashboard");return}},[a,e,t]),(0,l.useEffect)(()=>{s&&a&&e?.role==="admin"&&fetchData()},[s,a,e]);let fetchData=async()=>{try{S(!0),C(null);let[e,a]=await Promise.all([d.Sb.getUserById(parseInt(s)),d.Sb.getAllDepartments()]);f({firstName:e.first_name||"",lastName:e.last_name||"",email:e.email||"",role:e.role||"student",departmentId:e.department_id?.toString()||"",status:e.status||"active"}),j(a)}catch(e){C("Failed to load user data. Please try again.")}finally{S(!1)}},handleInputChange=e=>{let{name:a,value:t}=e.target;f(e=>({...e,[a]:t})),I[a]&&A(e=>({...e,[a]:null}))},validateForm=()=>{let e={};return v.firstName.trim()||(e.firstName="First name is required"),v.lastName.trim()||(e.lastName="Last name is required"),v.email.trim()?/\S+@\S+\.\S+/.test(v.email)||(e.email="Email is invalid"):e.email="Email is required",v.role||(e.role="Role is required"),A(e),0===Object.keys(e).length},handleSubmit=async e=>{if(e.preventDefault(),validateForm())try{_(!0),C(null);let e={firstName:v.firstName.trim(),lastName:v.lastName.trim(),email:v.email.trim().toLowerCase(),role:v.role,departmentId:v.departmentId||null,status:v.status};await d.Sb.updateUser(parseInt(s),e),q({type:"success",text:"User updated successfully!"}),setTimeout(()=>{t.push("/admin/users")},2e3)}catch(e){C(e.message||"Failed to update user. Please try again.")}finally{_(!1)}};return a&&e?.role==="admin"?N?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(m.default,{}),(0,r.jsxs)("div",{className:"flex",children:[r.jsx(c.default,{}),r.jsx("main",{className:"flex-1 p-6 flex justify-center items-center",children:r.jsx(p.Z,{size:"lg"})})]})]}):P&&!v.firstName?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(m.default,{}),(0,r.jsxs)("div",{className:"flex",children:[r.jsx(c.default,{}),r.jsx("main",{className:"flex-1 p-6",children:r.jsx("div",{className:"max-w-4xl mx-auto",children:(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"text-red-500 mr-3",children:r.jsx(g.fzv,{className:"w-6 h-6"})}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-red-800",children:"Error Loading User"}),r.jsx("p",{className:"text-red-600 mt-1",children:P})]})]}),r.jsx("div",{className:"mt-4",children:r.jsx(o.Z,{variant:"outline",onClick:()=>t.push("/admin/users"),icon:g.Ao2,children:"Back to Users"})})]})})})]})]}):(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(m.default,{}),(0,r.jsxs)("div",{className:"flex",children:[r.jsx(c.default,{}),r.jsx("main",{className:"flex-1 p-6",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto",children:[r.jsx("div",{className:"mb-6",children:r.jsx("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(o.Z,{variant:"outline",onClick:()=>t.push("/admin/users"),icon:g.Ao2,className:"mr-4",children:"Back"}),(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit User"}),r.jsx("p",{className:"text-gray-600 mt-1",children:"Update user information"})]})]})})}),w&&r.jsx("div",{className:`mb-6 p-4 rounded-lg border-l-4 ${"success"===w.type?"bg-green-50 border-green-400 text-green-800":"bg-red-50 border-red-400 text-red-800"}`,children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(g.fzv,{className:"w-5 h-5 mr-2"}),r.jsx("span",{className:"font-medium",children:w.text})]})}),P&&r.jsx("div",{className:"mb-6 p-4 rounded-lg border-l-4 bg-red-50 border-red-400 text-red-800",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(g.H33,{className:"w-5 h-5 mr-2"}),r.jsx("span",{className:"font-medium",children:P})]})}),r.jsx(u.Z,{children:r.jsx("div",{className:"p-6",children:(0,r.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Personal Information"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(x.Z,{label:"First Name",name:"firstName",value:v.firstName,onChange:handleInputChange,error:I.firstName,required:!0,icon:g.fzv}),r.jsx(x.Z,{label:"Last Name",name:"lastName",value:v.lastName,onChange:handleInputChange,error:I.lastName,required:!0,icon:g.fzv})]})]}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Account Information"}),r.jsx("div",{className:"space-y-4",children:r.jsx(x.Z,{label:"Email Address",name:"email",type:"email",value:v.email,onChange:handleInputChange,error:I.email,required:!0,icon:g.Imn})})]}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Role and Department"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(h.Z,{label:"Role",name:"role",value:v.role,onChange:handleInputChange,options:[{value:"student",label:"Student"},{value:"teacher",label:"Teacher"},{value:"hod",label:"Head of Department"},{value:"finance",label:"Finance Officer"},{value:"admin",label:"Administrator"}],error:I.role,required:!0}),r.jsx(h.Z,{label:"Department",name:"departmentId",value:v.departmentId,onChange:handleInputChange,options:[{value:"",label:"Select Department (Optional)"},...b.map(e=>({value:e.id.toString(),label:e.name}))]})]})]}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Account Status"}),r.jsx(h.Z,{label:"Status",name:"status",value:v.status,onChange:handleInputChange,options:[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"suspended",label:"Suspended"},{value:"pending",label:"Pending"}],required:!0})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[r.jsx(o.Z,{type:"button",variant:"outline",onClick:()=>t.push("/admin/users"),disabled:y,children:"Cancel"}),r.jsx(o.Z,{type:"submit",variant:"primary",icon:g.mW3,disabled:y,loading:y,children:y?"Updating User...":"Update User"})]})]})})})]})})]})]}):null};s()}catch(e){s(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9783:e=>{e.exports=import("@fortawesome/free-solid-svg-icons")},3803:e=>{e.exports=import("@fortawesome/react-fontawesome")},9648:e=>{e.exports=import("axios")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var a=require("../../../webpack-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),t=a.X(0,[7689,1163,9801,4608,9209,8450,6422,4082,8397,5822,897],()=>__webpack_exec__(7881));module.exports=t})();