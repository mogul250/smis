"use strict";(()=>{var e={};e.id=5138,e.ids=[5138,2888,660],e.modules={361:()=>{},1519:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{config:()=>g,default:()=>u,getServerSideProps:()=>x,getStaticPaths:()=>h,getStaticProps:()=>p,reportWebVitals:()=>b,routeModule:()=>_,unstable_getServerProps:()=>S,unstable_getServerSideProps:()=>y,unstable_getStaticParams:()=>j,unstable_getStaticPaths:()=>v,unstable_getStaticProps:()=>f});var r=a(7093),n=a(5244),l=a(1323),i=a(9209),d=a.n(i),c=a(8397),o=a(8818),m=e([c,o]);[c,o]=m.then?(await m)():m;let u=(0,l.l)(o,"default"),p=(0,l.l)(o,"getStaticProps"),h=(0,l.l)(o,"getStaticPaths"),x=(0,l.l)(o,"getServerSideProps"),g=(0,l.l)(o,"config"),b=(0,l.l)(o,"reportWebVitals"),f=(0,l.l)(o,"unstable_getStaticProps"),v=(0,l.l)(o,"unstable_getStaticPaths"),j=(0,l.l)(o,"unstable_getStaticParams"),S=(0,l.l)(o,"unstable_getServerProps"),y=(0,l.l)(o,"unstable_getServerSideProps"),_=new r.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/admin/departments/create",pathname:"/admin/departments/create",bundlePath:"",filename:""},components:{App:c.default,Document:d()},userland:o});s()}catch(e){s(e)}})},6761:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{a:()=>useAuth});var r=a(6689),n=a(8786),l=e([n]);n=(l.then?(await l)():l)[0];let useAuth=()=>{let e=(0,r.useContext)(n.ZP);if(!e)throw Error("useAuth must be used within an AuthProvider");return e};s()}catch(e){s(e)}})},8818:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var r=a(997),n=a(6689),l=a(1163),i=a(6761),d=a(8303),c=a(4082),o=a(6422),m=a(9180),u=a(4105),p=a(5822),h=a(897),x=a(4549),g=a(6893),b=a(361),f=e([i,d,c,o]);[i,d,c,o]=f.then?(await f)():f;let __WEBPACK_DEFAULT_EXPORT__=()=>{let{user:e,isAuthenticated:t}=(0,i.a)(),a=(0,l.useRouter)(),[s,f]=(0,n.useState)({name:"",code:"",description:"",hodId:"",status:"active"}),[v,j]=(0,n.useState)([]),[S,y]=(0,n.useState)(!0),[_,N]=(0,n.useState)(!1),[P,C]=(0,n.useState)(null),[w,D]=(0,n.useState)(null),[q,A]=(0,n.useState)({});(0,n.useEffect)(()=>{if(!t||e?.role!=="admin"){a.push("/dashboard");return}},[t,e,a]),(0,n.useEffect)(()=>{t&&e?.role==="admin"&&fetchUsers()},[t,e]);let fetchUsers=async()=>{try{y(!0);let e=await d.Sb.getAllUsers(1,1e3),t=e.users?.filter(e=>"teacher"===e.role||"hod"===e.role)||[];j(t)}catch(e){C("Failed to load users. Please try again.")}finally{y(!1)}},handleInputChange=e=>{let{name:t,value:a}=e.target;f(e=>({...e,[t]:a})),q[t]&&A(e=>({...e,[t]:null}))},validateForm=()=>{let e={};return s.name.trim()||(e.name="Department name is required"),s.code.trim()?(s.code.length<2||s.code.length>10)&&(e.code="Department code must be between 2 and 10 characters"):e.code="Department code is required",s.status||(e.status="Status is required"),A(e),0===Object.keys(e).length},handleSubmit=async e=>{if(e.preventDefault(),validateForm())try{N(!0),C(null);let e={name:s.name.trim(),code:s.code.trim().toUpperCase(),description:s.description.trim()||null,hodId:s.hodId||null,status:s.status};await d.Sb.createDepartment(e),D({type:"success",text:"Department created successfully!"}),setTimeout(()=>{a.push("/admin/departments")},2e3)}catch(e){C(e.message||"Failed to create department. Please try again.")}finally{N(!1)}};return t&&e?.role==="admin"?S?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(c.default,{}),(0,r.jsxs)("div",{className:"flex",children:[r.jsx(o.default,{}),r.jsx("main",{className:"flex-1 p-6 flex justify-center items-center",children:r.jsx(x.Z,{size:"lg"})})]})]}):(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(c.default,{}),(0,r.jsxs)("div",{className:"flex",children:[r.jsx(o.default,{}),r.jsx("main",{className:"flex-1 p-6",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto",children:[r.jsx("div",{className:"mb-6",children:r.jsx("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(m.Z,{variant:"outline",onClick:()=>a.push("/admin/departments"),icon:g.Ao2,className:"mr-4",children:"Back"}),(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Create New Department"}),r.jsx("p",{className:"text-gray-600 mt-1",children:"Add a new department to the system"})]})]})})}),w&&r.jsx("div",{className:`mb-6 p-4 rounded-lg border-l-4 ${"success"===w.type?"bg-green-50 border-green-400 text-green-800":"bg-red-50 border-red-400 text-red-800"}`,children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(b.FiBuilding,{className:"w-5 h-5 mr-2"}),r.jsx("span",{className:"font-medium",children:w.text})]})}),P&&r.jsx("div",{className:"mb-6 p-4 rounded-lg border-l-4 bg-red-50 border-red-400 text-red-800",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(g.H33,{className:"w-5 h-5 mr-2"}),r.jsx("span",{className:"font-medium",children:P})]})}),r.jsx(u.Z,{children:r.jsx("div",{className:"p-6",children:(0,r.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Basic Information"}),(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx(p.Z,{label:"Department Name",name:"name",value:s.name,onChange:handleInputChange,error:q.name,required:!0,icon:b.FiBuilding,placeholder:"e.g., Computer Science"}),r.jsx(p.Z,{label:"Department Code",name:"code",value:s.code,onChange:handleInputChange,error:q.code,required:!0,icon:b.FiBuilding,placeholder:"e.g., CS",maxLength:10}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),r.jsx("textarea",{name:"description",value:s.description,onChange:handleInputChange,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Brief description of the department (optional)"})]})]})]}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Management"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(h.Z,{label:"Head of Department",name:"hodId",value:s.hodId,onChange:handleInputChange,options:[{value:"",label:"Select HOD (Optional)"},...v.map(e=>({value:e.id.toString(),label:`${e.first_name} ${e.last_name} (${e.role})`}))]}),r.jsx(h.Z,{label:"Status",name:"status",value:s.status,onChange:handleInputChange,options:[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],error:q.status,required:!0})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[r.jsx(m.Z,{type:"button",variant:"outline",onClick:()=>a.push("/admin/departments"),disabled:_,children:"Cancel"}),r.jsx(m.Z,{type:"submit",variant:"primary",icon:g.mW3,disabled:_,loading:_,children:_?"Creating Department...":"Create Department"})]})]})})})]})})]})]}):null};s()}catch(e){s(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9783:e=>{e.exports=import("@fortawesome/free-solid-svg-icons")},3803:e=>{e.exports=import("@fortawesome/react-fontawesome")},9648:e=>{e.exports=import("axios")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[7689,1163,9801,4608,9209,8450,6422,4082,8397,5822,897],()=>__webpack_exec__(1519));module.exports=a})();