"use strict";(()=>{var e={};e.id=4570,e.ids=[4570,2888,660],e.modules={8908:()=>{},3196:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{config:()=>g,default:()=>u,getServerSideProps:()=>h,getStaticPaths:()=>p,getStaticProps:()=>x,reportWebVitals:()=>f,routeModule:()=>w,unstable_getServerProps:()=>v,unstable_getServerSideProps:()=>N,unstable_getStaticParams:()=>j,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>b});var s=r(7093),l=r(5244),n=r(1323),i=r(9209),d=r.n(i),o=r(8397),c=r(3681),m=e([o,c]);[o,c]=m.then?(await m)():m;let u=(0,n.l)(c,"default"),x=(0,n.l)(c,"getStaticProps"),p=(0,n.l)(c,"getStaticPaths"),h=(0,n.l)(c,"getServerSideProps"),g=(0,n.l)(c,"config"),f=(0,n.l)(c,"reportWebVitals"),b=(0,n.l)(c,"unstable_getStaticProps"),y=(0,n.l)(c,"unstable_getStaticPaths"),j=(0,n.l)(c,"unstable_getStaticParams"),v=(0,n.l)(c,"unstable_getServerProps"),N=(0,n.l)(c,"unstable_getServerSideProps"),w=new s.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/admin/departments/new",pathname:"/admin/departments/new",bundlePath:"",filename:""},components:{App:o.default,Document:d()},userland:c});a()}catch(e){a(e)}})},2463:(e,t,r)=>{r.d(t,{Cd:()=>d,X:()=>o,bZ:()=>i});var a=r(997),s=r(6689),l=r.n(s);let n={default:"bg-white border-gray-200",destructive:"border-red-200 bg-red-50 text-red-900 [&>svg]:text-red-600",success:"border-green-200 bg-green-50 text-green-900 [&>svg]:text-green-600",warning:"border-yellow-200 bg-yellow-50 text-yellow-900 [&>svg]:text-yellow-600"},i=l().forwardRef(({className:e="",variant:t="default",...r},s)=>a.jsx("div",{ref:s,role:"alert",className:`relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-gray-950 ${n[t]} ${e}`,...r}));i.displayName="Alert";let d=l().forwardRef(({className:e="",...t},r)=>a.jsx("h5",{ref:r,className:`mb-1 font-medium leading-none tracking-tight ${e}`,...t}));d.displayName="AlertTitle";let o=l().forwardRef(({className:e="",...t},r)=>a.jsx("div",{ref:r,className:`text-sm [&_p]:leading-relaxed ${e}`,...t}));o.displayName="AlertDescription"},4498:(e,t,r)=>{r.d(t,{zx:()=>d});var a=r(997),s=r(6689),l=r.n(s);let n={default:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",destructive:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-blue-500",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 focus:ring-gray-500",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-500",link:"text-blue-600 underline-offset-4 hover:underline focus:ring-blue-500"},i={default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"},d=l().forwardRef(({className:e="",variant:t="default",size:r="default",disabled:s=!1,loading:l=!1,children:d,...o},c)=>{let m=n[t]||n.default,u=i[r]||i.default,x=`inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ${m} ${u} ${e}`;return(0,a.jsxs)("button",{className:x,ref:c,disabled:s||l,...o,children:[l&&(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),d]})});d.displayName="Button"},2942:(e,t,r)=>{r.d(t,{Ol:()=>i,Zb:()=>n,aY:()=>c,eW:()=>m,ll:()=>d});var a=r(997),s=r(6689),l=r.n(s);let n=l().forwardRef(({className:e="",...t},r)=>a.jsx("div",{ref:r,className:`rounded-lg border border-gray-200 bg-white text-gray-950 shadow-sm ${e}`,...t}));n.displayName="Card";let i=l().forwardRef(({className:e="",...t},r)=>a.jsx("div",{ref:r,className:`flex flex-col space-y-1.5 p-6 ${e}`,...t}));i.displayName="CardHeader";let d=l().forwardRef(({className:e="",...t},r)=>a.jsx("h3",{ref:r,className:`text-2xl font-semibold leading-none tracking-tight ${e}`,...t}));d.displayName="CardTitle";let o=l().forwardRef(({className:e="",...t},r)=>a.jsx("p",{ref:r,className:`text-sm text-gray-500 ${e}`,...t}));o.displayName="CardDescription";let c=l().forwardRef(({className:e="",...t},r)=>a.jsx("div",{ref:r,className:`p-6 pt-0 ${e}`,...t}));c.displayName="CardContent";let m=l().forwardRef(({className:e="",...t},r)=>a.jsx("div",{ref:r,className:`flex items-center p-6 pt-0 ${e}`,...t}));m.displayName="CardFooter"},9535:(e,t,r)=>{r.d(t,{I:()=>n});var a=r(997),s=r(6689),l=r.n(s);let n=l().forwardRef(({className:e="",type:t="text",error:r=!1,...s},l)=>{let n=`flex h-10 w-full rounded-md border px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ${r?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"} ${e}`;return a.jsx("input",{type:t,className:n,ref:l,...s})});n.displayName="Input"},6761:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.d(t,{a:()=>useAuth});var s=r(6689),l=r(8786),n=e([l]);l=(n.then?(await n)():n)[0];let useAuth=()=>{let e=(0,s.useContext)(l.ZP);if(!e)throw Error("useAuth must be used within an AuthProvider");return e};a()}catch(e){a(e)}})},3681:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var s=r(997),l=r(6689),n=r(1163),i=r(6761),d=r(8303),o=r(4082),c=r(6422),m=r(4498),u=r(9535),x=r(2942),p=r(2463),h=r(6893),g=r(8908),f=e([i,d,o,c]);[i,d,o,c]=f.then?(await f)():f;let __WEBPACK_DEFAULT_EXPORT__=()=>{let{user:e,isAuthenticated:t}=(0,i.a)(),r=(0,n.useRouter)(),[a,f]=(0,l.useState)({name:"",code:"",description:"",head_id:"",status:"active"}),[b,y]=(0,l.useState)([]),[j,v]=(0,l.useState)(!0),[N,w]=(0,l.useState)(!1),[_,C]=(0,l.useState)(null),[S,P]=(0,l.useState)(!1),[A,D]=(0,l.useState)({});if((0,l.useEffect)(()=>{let fetchUsers=async()=>{try{v(!0);let e=await d.Sb.getAllUsers(1,100,{role:"teacher"});e&&e.users&&y(e.users)}catch(e){C("Failed to load teachers for HOD selection")}finally{v(!1)}};t&&e?.role==="admin"&&fetchUsers()},[t,e]),!t||e?.role!=="admin")return null;let validateForm=()=>{let e={};return a.name.trim()?a.name.length<2&&(e.name="Department name must be at least 2 characters"):e.name="Department name is required",a.code.trim()?a.code.length<2?e.code="Department code must be at least 2 characters":/^[A-Z0-9]+$/.test(a.code)||(e.code="Department code must contain only uppercase letters and numbers"):e.code="Department code is required",a.description&&a.description.length>500&&(e.description="Description must be less than 500 characters"),D(e),0===Object.keys(e).length},handleInputChange=e=>{let{name:t,value:r}=e.target;f(e=>({...e,[t]:r})),A[t]&&D(e=>({...e,[t]:""}))},handleSubmit=async e=>{if(e.preventDefault(),validateForm()){w(!0),C(null);try{let e={name:a.name.trim(),code:a.code.trim().toUpperCase(),description:a.description.trim()||null,head_id:a.head_id?parseInt(a.head_id):null,status:a.status};await d.Sb.createDepartment(e),P(!0),setTimeout(()=>{r.push("/admin/departments")},2e3)}catch(e){C(e.message||"Failed to create department")}finally{w(!1)}}};return j?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx(h.dAq,{className:"animate-spin h-8 w-8 text-blue-600 mx-auto"}),s.jsx("p",{className:"mt-2 text-gray-600",children:"Loading..."})]})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[s.jsx(o.default,{}),(0,s.jsxs)("div",{className:"flex",children:[s.jsx(c.default,{}),(0,s.jsxs)("main",{className:"flex-1 p-6",children:[s.jsx("div",{className:"mb-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[s.jsx(m.zx,{variant:"ghost",size:"icon",onClick:()=>r.back(),className:"mr-4",children:s.jsx(h.Ao2,{className:"w-5 h-5"})}),(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Create New Department"}),s.jsx("p",{className:"text-gray-600",children:"Add a new academic department to the system"})]})]})}),S&&(0,s.jsxs)(p.bZ,{variant:"success",className:"mb-6",children:[s.jsx(h.UgA,{className:"h-4 w-4"}),s.jsx(p.Cd,{children:"Department Created Successfully!"}),s.jsx(p.X,{children:"Redirecting to departments list..."})]}),_&&(0,s.jsxs)(p.bZ,{variant:"destructive",className:"mb-6",children:[s.jsx(h.bcx,{className:"h-4 w-4"}),s.jsx(p.Cd,{children:"Error"}),s.jsx(p.X,{children:_})]}),(0,s.jsxs)(x.Zb,{children:[s.jsx(x.Ol,{children:(0,s.jsxs)(x.ll,{className:"flex items-center",children:[s.jsx(g.FiBuilding,{className:"w-5 h-5 text-blue-600 mr-2"}),"Department Information"]})}),(0,s.jsxs)("form",{onSubmit:handleSubmit,children:[(0,s.jsxs)(x.aY,{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Department Name *"}),s.jsx(u.I,{id:"name",name:"name",value:a.name,onChange:handleInputChange,error:!!A.name,placeholder:"e.g., Computer Science",disabled:N}),A.name&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:A.name})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"code",className:"block text-sm font-medium text-gray-700 mb-2",children:"Department Code *"}),s.jsx(u.I,{id:"code",name:"code",value:a.code,onChange:handleInputChange,error:!!A.code,placeholder:"e.g., CS, ENG, MATH",disabled:N,style:{textTransform:"uppercase"}}),A.code&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:A.code}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Use uppercase letters and numbers only"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),s.jsx("textarea",{id:"description",name:"description",value:a.description,onChange:handleInputChange,rows:4,className:`w-full px-3 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ${A.description?"border-red-300":"border-gray-300"}`,placeholder:"Brief description of the department...",disabled:N}),A.description&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:A.description}),(0,s.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:[a.description.length,"/500 characters"]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"head_id",className:"block text-sm font-medium text-gray-700 mb-2",children:"Head of Department"}),(0,s.jsxs)("select",{id:"head_id",name:"head_id",value:a.head_id,onChange:handleInputChange,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:N,children:[s.jsx("option",{value:"",children:"Select a teacher (optional)"}),b.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.first_name," ",e.last_name," (",e.email,")"]},e.id))]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,s.jsxs)("select",{id:"status",name:"status",value:a.status,onChange:handleInputChange,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:N,children:[s.jsx("option",{value:"active",children:"Active"}),s.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),(0,s.jsxs)(x.eW,{className:"flex items-center justify-end space-x-4",children:[s.jsx(m.zx,{type:"button",variant:"outline",onClick:()=>r.back(),disabled:N,children:"Cancel"}),s.jsx(m.zx,{type:"submit",loading:N,disabled:N,children:N?(0,s.jsxs)(s.Fragment,{children:[s.jsx(h.dAq,{className:"animate-spin w-4 h-4 mr-2"}),"Creating..."]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx(h.mW3,{className:"w-4 h-4 mr-2"}),"Create Department"]})})]})]})]})]})]})]})};a()}catch(e){a(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9783:e=>{e.exports=import("@fortawesome/free-solid-svg-icons")},3803:e=>{e.exports=import("@fortawesome/react-fontawesome")},9648:e=>{e.exports=import("axios")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[7689,1163,9801,4608,9209,8450,6422,4082,8397],()=>__webpack_exec__(3196));module.exports=r})();