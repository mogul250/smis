"use strict";(()=>{var e={};e.id=1833,e.ids=[1833,2888,660],e.modules={3082:(e,t,s)=>{s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{config:()=>b,default:()=>u,getServerSideProps:()=>x,getStaticPaths:()=>p,getStaticProps:()=>h,reportWebVitals:()=>g,routeModule:()=>_,unstable_getServerProps:()=>v,unstable_getServerSideProps:()=>N,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>j,unstable_getStaticProps:()=>f});var a=s(7093),n=s(5244),d=s(1323),i=s(9209),l=s.n(i),c=s(8397),o=s(1353),m=e([c,o]);[c,o]=m.then?(await m)():m;let u=(0,d.l)(o,"default"),h=(0,d.l)(o,"getStaticProps"),p=(0,d.l)(o,"getStaticPaths"),x=(0,d.l)(o,"getServerSideProps"),b=(0,d.l)(o,"config"),g=(0,d.l)(o,"reportWebVitals"),f=(0,d.l)(o,"unstable_getStaticProps"),j=(0,d.l)(o,"unstable_getStaticPaths"),y=(0,d.l)(o,"unstable_getStaticParams"),v=(0,d.l)(o,"unstable_getServerProps"),N=(0,d.l)(o,"unstable_getServerSideProps"),_=new a.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/admin/departments/edit",pathname:"/admin/departments/edit",bundlePath:"",filename:""},components:{App:c.default,Document:l()},userland:o});r()}catch(e){r(e)}})},6761:(e,t,s)=>{s.a(e,async(e,r)=>{try{s.d(t,{a:()=>useAuth});var a=s(6689),n=s(8786),d=e([n]);n=(d.then?(await d)():d)[0];let useAuth=()=>{let e=(0,a.useContext)(n.ZP);if(!e)throw Error("useAuth must be used within an AuthProvider");return e};r()}catch(e){r(e)}})},1353:(e,t,s)=>{s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var a=s(997),n=s(6689),d=s(1163),i=s(6761),l=s(8303),c=s(4082),o=s(6422),m=e([i,l,c,o]);[i,l,c,o]=m.then?(await m)():m;let __WEBPACK_DEFAULT_EXPORT__=()=>{let{user:e,isAuthenticated:t}=(0,i.a)(),s=(0,d.useRouter)(),{departmentId:r}=s.query,[m,u]=(0,n.useState)(null),[h,p]=(0,n.useState)(!0),[x,b]=(0,n.useState)(!1),[g,f]=(0,n.useState)(null),[j,y]=(0,n.useState)(!1),[v,N]=(0,n.useState)([]),[_,S]=(0,n.useState)({name:"",code:"",description:"",head_id:"",status:"active"}),[w,D]=(0,n.useState)({}),fetchDepartment=async()=>{if(r)try{p(!0);let e=await l.Sb.getDepartmentById(parseInt(r));e&&(u(e),S({name:e.name||"",code:e.code||"",description:e.description||"",head_id:e.head_id||"",status:e.status||"active"}))}catch(e){f(e.message||"Failed to fetch department details")}finally{p(!1)}},fetchTeachers=async()=>{try{let e=await l.Sb.getAllUsers(1,100,{role:"teacher"});e&&e.users?N(e.users):Array.isArray(e)&&N(e)}catch(e){}};(0,n.useEffect)(()=>{t&&e?.role==="admin"&&(fetchDepartment(),fetchTeachers())},[t,e,r]);let handleInputChange=e=>{let{name:t,value:s}=e.target;S(e=>({...e,[t]:s})),w[t]&&D(e=>({...e,[t]:""}))},validateForm=()=>{let e={};return _.name.trim()?_.name.length<2&&(e.name="Department name must be at least 2 characters"):e.name="Department name is required",_.code.trim()?_.code.length<2?e.code="Department code must be at least 2 characters":/^[A-Z0-9]+$/.test(_.code)||(e.code="Department code must contain only uppercase letters and numbers"):e.code="Department code is required",_.description&&_.description.length>500&&(e.description="Description must be less than 500 characters"),D(e),0===Object.keys(e).length},handleSubmit=async e=>{if(e.preventDefault(),validateForm())try{b(!0),f(null);let e={name:_.name.trim(),code:_.code.trim().toUpperCase(),description:_.description.trim()||null,head_id:_.head_id?parseInt(_.head_id):null,status:_.status};await l.Sb.updateDepartment(parseInt(r),e),y(!0),setTimeout(()=>{s.push("/admin/departments")},2e3)}catch(e){f(e.message||"Failed to update department")}finally{b(!1)}};return t&&e?.role==="admin"?h?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),a.jsx("p",{className:"mt-4 text-gray-600",children:"Loading department..."})]})}):g&&!m?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Error"}),a.jsx("p",{className:"text-gray-600 mt-2",children:g}),a.jsx("button",{onClick:()=>s.push("/admin/departments"),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Back to Departments"})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx(c.default,{}),(0,a.jsxs)("div",{className:"flex",children:[a.jsx(o.default,{}),(0,a.jsxs)("main",{className:"flex-1 p-6",children:[a.jsx("div",{className:"mb-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("button",{onClick:()=>s.back(),className:"mr-4 p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:"← Back"}),(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit Department"}),a.jsx("p",{className:"text-gray-600",children:"Update department information"})]})]})}),j&&a.jsx("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-5 h-5 text-green-600 mr-3",children:"✓"}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Department Updated Successfully!"}),a.jsx("p",{className:"text-sm text-green-700 mt-1",children:"Redirecting to departments list..."})]})]})}),g&&a.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-5 h-5 text-red-600 mr-3",children:"!"}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),a.jsx("p",{className:"text-sm text-red-700 mt-1",children:g})]})]})}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[a.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-5 h-5 text-blue-600 mr-2",children:"\uD83C\uDFE2"}),a.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Department Information"})]})}),(0,a.jsxs)("form",{onSubmit:handleSubmit,className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Department Name *"}),a.jsx("input",{type:"text",id:"name",name:"name",value:_.name,onChange:handleInputChange,className:`w-full px-3 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ${w.name?"border-red-300":"border-gray-300"}`,placeholder:"e.g., Computer Science",disabled:x}),w.name&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:w.name})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"code",className:"block text-sm font-medium text-gray-700 mb-2",children:"Department Code *"}),a.jsx("input",{type:"text",id:"code",name:"code",value:_.code,onChange:handleInputChange,className:`w-full px-3 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ${w.code?"border-red-300":"border-gray-300"}`,placeholder:"e.g., CS, ENG, MATH",disabled:x,style:{textTransform:"uppercase"}}),w.code&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:w.code}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Use uppercase letters and numbers only"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),a.jsx("textarea",{id:"description",name:"description",value:_.description,onChange:handleInputChange,rows:4,className:`w-full px-3 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ${w.description?"border-red-300":"border-gray-300"}`,placeholder:"Brief description of the department...",disabled:x}),w.description&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:w.description}),(0,a.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:[_.description.length,"/500 characters"]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"head_id",className:"block text-sm font-medium text-gray-700 mb-2",children:"Head of Department"}),(0,a.jsxs)("select",{id:"head_id",name:"head_id",value:_.head_id,onChange:handleInputChange,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:x,children:[a.jsx("option",{value:"",children:"Select a teacher (optional)"}),v.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName," (",e.email,")"]},e.id))]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,a.jsxs)("select",{id:"status",name:"status",value:_.status,onChange:handleInputChange,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:x,children:[a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"inactive",children:"Inactive"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:()=>s.back(),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:x,children:"Cancel"}),a.jsx("button",{type:"submit",disabled:x,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:x?(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"animate-spin w-4 h-4 mr-2 border-2 border-white border-t-transparent rounded-full"}),"Updating..."]}):a.jsx(a.Fragment,{children:"\uD83D\uDCBE Update Department"})})]})]})]})]})]})]}):a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Access Denied"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"You need admin privileges to access this page."})]})})};r()}catch(e){r(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9783:e=>{e.exports=import("@fortawesome/free-solid-svg-icons")},3803:e=>{e.exports=import("@fortawesome/react-fontawesome")},9648:e=>{e.exports=import("axios")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[7689,1163,9801,4608,9209,8450,6422,4082,8397],()=>__webpack_exec__(3082));module.exports=s})();