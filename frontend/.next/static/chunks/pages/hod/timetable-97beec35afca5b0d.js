(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2795],{7710:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/hod/timetable",function(){return t(816)}])},816:function(e,s,t){"use strict";t.r(s);var a=t(5893),l=t(7294),n=t(9008),r=t.n(n),c=t(6761),i=t(3242),d=t(591),m=t(4082),o=t(2983),x=t(4105),h=t(9180),u=t(9175),j=t(4549),p=t(9060),N=t(7219);s.default=()=>{let{user:e}=(0,c.a)(),[s,t]=(0,l.useState)({semester:"current"}),[n,g]=(0,l.useState)(!1),{data:v,loading:f,error:b,refetch:y}=(0,i.h)(()=>d.pW.getDepartmentTimetable({semester:"current"===s.semester?void 0:s.semester})),{execute:w}=(0,i.c)();if(!e||"hod"!==e.role)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)(u.Z,{variant:"error",children:"Access denied. HOD access required."})});let handleRefresh=async()=>{g(!0);try{await y()}catch(e){}finally{g(!1)}},handleApproval=async(e,s)=>{try{await w(()=>d.pW.approveTimetable({timetableId:e,approve:s})),await y()}catch(e){}},handleExport=()=>{if(!v||0===v.length){alert("No timetable data to export");return}let e=v.map(e=>{var s,t;return{Day:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e.day_of_week]||"Unknown",Time:"".concat(null===(s=e.start_time)||void 0===s?void 0:s.substring(0,5)," - ").concat(null===(t=e.end_time)||void 0===t?void 0:t.substring(0,5)),Course:"".concat(e.course_code," - ").concat(e.course_name),Teacher:e.teacher_name,Room:e.room||"TBA",Status:e.status||"N/A",Semester:e.semester||"N/A"}}),s=[Object.keys(e[0]).join(","),...e.map(e=>Object.values(e).join(","))].join("\n"),t=new Blob([s],{type:"text/csv"}),a=window.URL.createObjectURL(t),l=document.createElement("a");l.href=a,l.download="department-timetable-".concat(new Date().toISOString().split("T")[0],".csv"),l.click(),window.URL.revokeObjectURL(a)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(r(),{children:[(0,a.jsx)("title",{children:"Timetable Management - HOD Dashboard"}),(0,a.jsx)("meta",{name:"description",content:"Manage department timetable and approve scheduling"})]}),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(m.default,{}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(o.default,{}),(0,a.jsx)("main",{className:"flex-1 overflow-auto",children:(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Timetable Management"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"View and manage your department's class schedule"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(h.Z,{variant:"outline",size:"sm",onClick:handleRefresh,loading:n,children:"\uD83D\uDD04 Refresh"}),(0,a.jsx)(h.Z,{variant:"outline",size:"sm",onClick:handleExport,disabled:!v||0===v.length,children:"\uD83D\uDCE5 Export"})]})]}),b&&(0,a.jsxs)(u.Z,{variant:"error",className:"mb-6",children:["Error loading timetable: ",b.message]}),(0,a.jsx)(p.QD,{filters:s,onFilterChange:e=>{t(e)},onReset:()=>{t({semester:"current"})},onExport:handleExport,showTeacherFilter:!0,showRoomFilter:!0}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsx)(x.Z,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 rounded-lg bg-blue-50",children:(0,a.jsx)(N.vlc,{className:"w-6 h-6 text-blue-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Classes"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:f?"...":(null==v?void 0:v.length)||0})]})]})}),(0,a.jsx)(x.Z,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 rounded-lg bg-green-50",children:(0,a.jsx)(N.UgA,{className:"w-6 h-6 text-green-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Approved"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:f?"...":(null==v?void 0:v.filter(e=>"approved"===e.status).length)||0})]})]})}),(0,a.jsx)(x.Z,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 rounded-lg bg-yellow-50",children:(0,a.jsx)(N.TCC,{className:"w-6 h-6 text-yellow-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Pending"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:f?"...":(null==v?void 0:v.filter(e=>"pending"===e.status).length)||0})]})]})}),(0,a.jsx)(x.Z,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 rounded-lg bg-red-50",children:(0,a.jsx)(N.q5L,{className:"w-6 h-6 text-red-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Rejected"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:f?"...":(null==v?void 0:v.filter(e=>"rejected"===e.status).length)||0})]})]})})]}),f?(0,a.jsx)(x.Z,{className:"p-12",children:(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(j.Z,{size:"lg"})})}):v&&v.length>0?(0,a.jsx)(p.mG,{timetable:v,editable:!1,showActions:!0,colorScheme:"teacher",title:"Department Timetable",onApprove:handleApproval,showApprovalActions:!0}):(0,a.jsx)(x.Z,{className:"p-12 text-center",children:(0,a.jsxs)("div",{className:"text-gray-500",children:[(0,a.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDCC5"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Classes Scheduled"}),(0,a.jsx)("p",{className:"text-gray-600",children:"No classes are scheduled for the selected semester."})]})})]})})]})]})]})}}},function(e){e.O(0,[1216,8592,2888,179],function(){return e(e.s=7710)}),_N_E=e.O()}]);