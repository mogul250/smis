(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[370],{8703:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/hod/notifications",function(){return t(3963)}])},3963:function(e,s,t){"use strict";t.r(s);var a=t(5893),i=t(7294),r=t(9008),n=t.n(r),l=t(6761),c=t(3242),d=t(3240),m=t(4082),o=t(5936),x=t(4105),h=t(9180),u=t(9175);t(4549);var g=t(5822),j=t(7014),p=t(7219);s.default=()=>{let{user:e}=(0,l.a)(),[s,t]=(0,i.useState)(!1),[r,N]=(0,i.useState)(!1),[f,y]=(0,i.useState)({subject:"",message:"",priority:"normal",recipients:"all"}),{data:b,loading:v,error:w,refetch:C}=(0,c.h)(d.pW.getDepartmentTeachers),{execute:Z,loading:k}=(0,c.c)(e=>d.pW.sendToDepartmentTeachers?d.pW.sendToDepartmentTeachers(e):Promise.resolve()),[S]=(0,i.useState)([{id:1,subject:"Department Meeting Reminder",message:"Please attend the monthly department meeting scheduled for tomorrow at 2 PM.",priority:"high",recipients:12,sent_at:"2024-01-15T10:30:00Z",status:"sent"},{id:2,subject:"Grade Submission Deadline",message:"Reminder: Grade submissions are due by end of this week.",priority:"normal",recipients:12,sent_at:"2024-01-14T09:15:00Z",status:"sent"},{id:3,subject:"New Course Guidelines",message:"Please review the updated course guidelines attached to this notification.",priority:"normal",recipients:8,sent_at:"2024-01-13T14:45:00Z",status:"sent"}]);if(!e||"hod"!==e.role)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)(u.Z,{variant:"error",children:"Access denied. HOD access required."})});let handleRefresh=async()=>{N(!0);try{await C()}catch(e){}finally{N(!1)}},handleInputChange=e=>{let{name:s,value:t}=e.target;y(e=>({...e,[s]:t}))},handleSendNotification=async e=>{e.preventDefault();try{await Z({subject:f.subject,message:f.message,priority:f.priority,recipients:f.recipients}),t(!1),y({subject:"",message:"",priority:"normal",recipients:"all"}),alert("Notification sent successfully!")}catch(e){alert("Error sending notification. Please try again.")}},getPriorityBadge=e=>{switch(e){case"high":return(0,a.jsx)(j.Z,{variant:"danger",size:"sm",children:"High Priority"});case"normal":return(0,a.jsx)(j.Z,{variant:"default",size:"sm",children:"Normal"});case"low":return(0,a.jsx)(j.Z,{variant:"success",size:"sm",children:"Low Priority"});default:return(0,a.jsx)(j.Z,{variant:"default",size:"sm",children:e})}},formatDate=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n(),{children:[(0,a.jsx)("title",{children:"Notifications - HOD Dashboard"}),(0,a.jsx)("meta",{name:"description",content:"Send notifications to department teachers"})]}),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(m.Z,{}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(o.Z,{}),(0,a.jsx)("main",{className:"flex-1 overflow-auto",children:(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Notifications"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Send notifications and communicate with your department teachers"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(h.Z,{variant:"outline",size:"sm",onClick:handleRefresh,loading:r,icon:p.Bw1,children:"Refresh"}),(0,a.jsx)(h.Z,{variant:"primary",size:"sm",onClick:()=>t(!0),icon:p.OvN,children:"Compose"})]})]}),w&&(0,a.jsxs)(u.Z,{variant:"error",className:"mb-6",children:["Error loading teachers: ",w.message]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsx)(x.Z,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 rounded-lg bg-blue-50",children:(0,a.jsx)(p.Imn,{className:"w-6 h-6 text-blue-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Sent"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:S.length})]})]})}),(0,a.jsx)(x.Z,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 rounded-lg bg-green-50",children:(0,a.jsx)(p.WY8,{className:"w-6 h-6 text-green-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Recipients"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:v?"...":(null==b?void 0:b.length)||0})]})]})}),(0,a.jsx)(x.Z,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 rounded-lg bg-purple-50",children:(0,a.jsx)(p.TCC,{className:"w-6 h-6 text-purple-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"This Week"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:S.filter(e=>{let s=new Date(e.sent_at),t=new Date;return t.setDate(t.getDate()-7),s>t}).length})]})]})}),(0,a.jsx)(x.Z,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 rounded-lg bg-orange-50",children:(0,a.jsx)(p.UgA,{className:"w-6 h-6 text-orange-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Success Rate"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:"100%"})]})]})})]}),(0,a.jsxs)(x.Z,{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)(h.Z,{variant:"outline",className:"p-4 h-auto flex-col items-start text-left",onClick:()=>{y(e=>({...e,subject:"Department Meeting Reminder",message:"Please attend the upcoming department meeting.",priority:"high"})),t(!0)},children:[(0,a.jsx)(p.WY8,{className:"w-6 h-6 text-blue-600 mb-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:"Meeting Reminder"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Send meeting notifications"})]})]}),(0,a.jsxs)(h.Z,{variant:"outline",className:"p-4 h-auto flex-col items-start text-left",onClick:()=>{y(e=>({...e,subject:"Grade Submission Reminder",message:"Please submit grades by the deadline.",priority:"normal"})),t(!0)},children:[(0,a.jsx)(p.TCC,{className:"w-6 h-6 text-green-600 mb-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:"Grade Reminder"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Remind about grade submissions"})]})]}),(0,a.jsxs)(h.Z,{variant:"outline",className:"p-4 h-auto flex-col items-start text-left",onClick:()=>{y(e=>({...e,subject:"General Announcement",message:"",priority:"normal"})),t(!0)},children:[(0,a.jsx)(p.Imn,{className:"w-6 h-6 text-purple-600 mb-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:"General Notice"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Send general announcements"})]})]})]})]}),(0,a.jsxs)(x.Z,{className:"overflow-hidden",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Notification History"})}),S.length>0?(0,a.jsx)("div",{className:"divide-y divide-gray-200",children:S.map(e=>(0,a.jsx)("div",{className:"p-6 hover:bg-gray-50",children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(p.Imn,{className:"w-5 h-5 text-blue-600"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:e.subject}),getPriorityBadge(e.priority)]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.message}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(p.WY8,{className:"w-3 h-3 mr-1"}),e.recipients," recipients"]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(p.TCC,{className:"w-3 h-3 mr-1"}),formatDate(e.sent_at)]}),(0,a.jsx)(j.Z,{variant:"success",size:"sm",children:e.status})]})]})]})})},e.id))}):(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(p.Imn,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No notifications sent"}),(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"You haven't sent any notifications yet."}),(0,a.jsx)(h.Z,{variant:"primary",onClick:()=>t(!0),icon:p.OvN,children:"Send First Notification"})]})]}),s&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Compose Notification"}),(0,a.jsx)(h.Z,{variant:"ghost",size:"sm",onClick:()=>t(!1),icon:p.q5L})]})}),(0,a.jsxs)("form",{onSubmit:handleSendNotification,className:"p-6 space-y-6",children:[(0,a.jsx)(g.Z,{label:"Subject",name:"subject",value:f.subject,onChange:handleInputChange,required:!0,placeholder:"Enter notification subject"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Message ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("textarea",{name:"message",value:f.message,onChange:handleInputChange,required:!0,rows:6,className:"block w-full border border-gray-300 rounded-md shadow-sm focus:ring-primary-light focus:border-primary-light sm:text-sm px-3 py-2",placeholder:"Enter your message here..."})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),(0,a.jsxs)("select",{name:"priority",value:f.priority,onChange:handleInputChange,className:"block w-full border border-gray-300 rounded-md shadow-sm focus:ring-primary-light focus:border-primary-light sm:text-sm px-3 py-2",children:[(0,a.jsx)("option",{value:"low",children:"Low Priority"}),(0,a.jsx)("option",{value:"normal",children:"Normal Priority"}),(0,a.jsx)("option",{value:"high",children:"High Priority"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Recipients"}),(0,a.jsxs)("select",{name:"recipients",value:f.recipients,onChange:handleInputChange,className:"block w-full border border-gray-300 rounded-md shadow-sm focus:ring-primary-light focus:border-primary-light sm:text-sm px-3 py-2",children:[(0,a.jsx)("option",{value:"all",children:"All Department Teachers"}),(0,a.jsx)("option",{value:"selected",children:"Selected Teachers"})]})]})]}),(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[(0,a.jsx)(p.WY8,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:["This notification will be sent to"," ",(0,a.jsx)("strong",{children:"all"===f.recipients?"all ".concat((null==b?void 0:b.length)||0," department teachers"):"selected teachers"})]})]})}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,a.jsx)(h.Z,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),(0,a.jsx)(h.Z,{type:"submit",variant:"primary",loading:k,icon:p.LbG,children:"Send Notification"})]})]})]})})]})})]})]})]})}}},function(e){e.O(0,[216,592,888,179],function(){return e(e.s=8703)}),_N_E=e.O()}]);