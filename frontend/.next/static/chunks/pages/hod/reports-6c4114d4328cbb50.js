(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4854],{8871:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/hod/reports",function(){return t(4469)}])},4469:function(e,s,t){"use strict";t.r(s);var a=t(5893),r=t(7294),n=t(9008),l=t.n(n),c=t(6761),i=t(3242),d=t(591),x=t(4082),o=t(2983),m=t(4105),h=t(9180),g=t(9175),p=t(4549),u=t(7014),j=t(7219);s.default=()=>{var e,s,t,n,v,y;let{user:N}=(0,c.a)(),[f,b]=(0,r.useState)("attendance"),[w,_]=(0,r.useState)(null),[C,D]=(0,r.useState)(!1),{data:R,loading:Z,error:A,refetch:k}=(0,i.h)(d.pW.getDepartmentStats),{execute:G,loading:O}=(0,i.c)(d.pW.generateReports);if(!N||"hod"!==N.role)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)(g.Z,{variant:"error",children:"Access denied. HOD access required."})});let handleRefresh=async()=>{D(!0);try{await k()}catch(e){}finally{D(!1)}},handleGenerateReport=async e=>{try{let s=await G(e,{semester:"current",year:new Date().getFullYear()});_(s),b(e)}catch(e){}},T=[{id:"attendance",title:"Attendance Report",description:"Detailed attendance statistics by course and teacher",icon:j.WY8,color:"bg-blue-500"},{id:"grades",title:"Grade Distribution Report",description:"Grade distribution and performance analytics",icon:j.DKx,color:"bg-green-500"},{id:"performance",title:"Department Performance",description:"Overall department performance metrics",icon:j.QqI,color:"bg-purple-500"},{id:"courses",title:"Course Analytics",description:"Course enrollment and completion statistics",icon:j.yK7,color:"bg-orange-500"}],z=[{title:"Total Teachers",value:(null==R?void 0:R.teachers)||0,icon:j.WY8,color:"text-blue-600",bgColor:"bg-blue-50",change:null},{title:"Total Courses",value:(null==R?void 0:R.courses)||0,icon:j.yK7,color:"text-green-600",bgColor:"bg-green-50",change:null},{title:"Avg Attendance",value:"".concat((null==R?void 0:null===(e=R.attendance)||void 0===e?void 0:e.avg_attendance_percentage)||0,"%"),icon:j.QqI,color:"text-purple-600",bgColor:"bg-purple-50",change:null},{title:"Total Records",value:(null==R?void 0:null===(s=R.attendance)||void 0===s?void 0:s.total_records)||0,icon:j.bAx,color:"text-orange-600",bgColor:"bg-orange-50",change:null}];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l(),{children:[(0,a.jsx)("title",{children:"Reports & Analytics - HOD Dashboard"}),(0,a.jsx)("meta",{name:"description",content:"Generate and view department reports and analytics"})]}),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(x.default,{}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(o.default,{}),(0,a.jsx)("main",{className:"flex-1 overflow-auto",children:(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Reports & Analytics"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Generate comprehensive reports and view department analytics"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(h.Z,{variant:"outline",size:"sm",onClick:handleRefresh,loading:C,icon:j.Bw1,children:"Refresh"}),w&&(0,a.jsx)(h.Z,{variant:"outline",size:"sm",icon:j._hL,children:"Export Report"})]})]}),A&&(0,a.jsxs)(g.Z,{variant:"error",className:"mb-6",children:["Error loading statistics: ",A.message]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:z.map((e,s)=>{let t=e.icon;return(0,a.jsx)(m.Z,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 rounded-lg ".concat(e.bgColor),children:(0,a.jsx)(t,{className:"w-6 h-6 ".concat(e.color)})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:e.title}),(0,a.jsx)("div",{className:"flex items-center",children:Z?(0,a.jsx)(p.Z,{size:"sm"}):(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:e.value})})]})]})},s)})}),(0,a.jsxs)(m.Z,{className:"p-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Generate Reports"})}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:T.map(e=>{let s=e.icon;return(0,a.jsx)("div",{className:"p-4 border border-gray-200 rounded-lg hover:border-gray-300 hover:shadow-sm transition-all duration-200",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-10 h-10 ".concat(e.color," rounded-lg flex items-center justify-center"),children:(0,a.jsx)(s,{className:"w-5 h-5 text-white"})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.description})]})]}),(0,a.jsx)(h.Z,{variant:"outline",size:"sm",onClick:()=>handleGenerateReport(e.id),loading:O&&f===e.id,icon:j.NOg,children:"Generate"})]})},e.id)})})]}),w&&(0,a.jsxs)(m.Z,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:[null===(t=T.find(e=>e.id===f))||void 0===t?void 0:t.title," Results"]}),(0,a.jsxs)(u.Z,{variant:"success",size:"sm",children:["Generated ",new Date().toLocaleDateString()]})]}),"attendance"===f&&w.attendance&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"text-md font-medium text-gray-900",children:"Attendance by Course"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Code"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Classes"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Present Count"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Attendance %"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:w.attendance.map((e,s)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.course_name}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.course_code}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.total_classes}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.present_count}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,a.jsxs)(u.Z,{variant:e.attendance_percentage>=75?"success":e.attendance_percentage>=60?"warning":"danger",size:"sm",children:[e.attendance_percentage,"%"]})})]},s))})]})})]}),"grades"===f&&w.grades&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"text-md font-medium text-gray-900",children:"Grade Distribution"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(w.grades).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:t}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["Grade ",s]})]},s)})})]}),!w.attendance&&!w.grades&&(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(j.NOg,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{children:"Report generated successfully. Data will be displayed here."})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(m.Z,{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Department Overview"}),Z?(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)(p.Z,{})}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Teachers"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:(null==R?void 0:R.teachers)||0})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Courses"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:(null==R?void 0:R.courses)||0})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Average Attendance"}),(0,a.jsxs)(u.Z,{variant:((null==R?void 0:null===(n=R.attendance)||void 0===n?void 0:n.avg_attendance_percentage)||0)>=75?"success":((null==R?void 0:null===(v=R.attendance)||void 0===v?void 0:v.avg_attendance_percentage)||0)>=60?"warning":"danger",size:"sm",children:[(null==R?void 0:null===(y=R.attendance)||void 0===y?void 0:y.avg_attendance_percentage)||0,"%"]})]})]})]}),(0,a.jsxs)(m.Z,{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activity"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(j.NOg,{className:"w-4 h-4 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Last report generated"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:w?"Just now":"No reports generated yet"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(j.QqI,{className:"w-4 h-4 text-green-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Data last updated"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:new Date().toLocaleDateString()})]})]})]})]})]})]})})]})]})]})}}},function(e){e.O(0,[1216,8592,2888,179],function(){return e(e.s=8871)}),_N_E=e.O()}]);