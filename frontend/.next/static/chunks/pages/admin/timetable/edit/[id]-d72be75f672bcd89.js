(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3128],{5280:function(e,a,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/timetable/edit/[id]",function(){return l(1671)}])},1671:function(e,a,l){"use strict";l.r(a);var s=l(5893),d=l(7294),t=l(1163),r=l(6761),i=l(3242),n=l(9993),c=l(2983),o=l(4082),u=l(9180),m=l(5822);a.default=()=>{let e=(0,t.useRouter)(),{id:a}=e.query,{user:l}=(0,r.a)(),[h,x]=(0,d.useState)({course_id:"",teacher_id:"",class_id:"",day:"",start_time:"",end_time:"",room:"",semester:"Fall 2024"}),[b,g]=(0,d.useState)({}),[v,j]=(0,d.useState)(!0),{data:y,loading:p}=(0,i.h)(()=>n.Ho().catch(e=>[])),{data:f,loading:_}=(0,i.h)(()=>n.Os(1,100).catch(e=>({users:[]}))),{data:N,loading:w}=(0,i.h)(()=>n.k().catch(e=>[])),C=(null==f?void 0:f.users)||[],{execute:S,loading:k}=(0,i.c)(),{execute:T,loading:E}=(0,i.c)();(0,d.useEffect)(()=>{a&&loadTimetableSlot()},[a]);let loadTimetableSlot=async()=>{try{j(!0);let e=await n.zk(a);x({course_id:e.course_id||"",teacher_id:e.teacher_id||"",class_id:e.class_id||"",day:e.day||"",start_time:e.start_time||"",end_time:e.end_time||"",room:e.room||"",semester:e.semester||"Fall 2024"})}catch(a){e.push("/admin/timetable?error=not-found")}finally{j(!1)}};if(!l||"admin"!==l.role)return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"You don't have permission to access this page."}),(0,s.jsx)(u.Z,{onClick:()=>e.push("/login"),children:"Go to Login"})]})});let handleInputChange=(e,a)=>{x(l=>({...l,[e]:a})),b[e]&&g(a=>({...a,[e]:""}))},validateForm=()=>{let e={};return h.course_id||(e.course_id="Course is required"),h.teacher_id||(e.teacher_id="Teacher is required"),h.class_id||(e.class_id="Class is required"),h.day||(e.day="Day is required"),h.start_time||(e.start_time="Start time is required"),h.end_time||(e.end_time="End time is required"),h.room||(e.room="Room is required"),h.start_time&&h.end_time&&h.start_time>=h.end_time&&(e.end_time="End time must be after start time"),g(e),0===Object.keys(e).length},handleSubmit=async l=>{if(l.preventDefault(),validateForm())try{await S(async()=>{let e=await n.e3(a,h);return e}),e.push("/admin/timetable?success=updated")}catch(e){}},handleDelete=async()=>{if(confirm("Are you sure you want to delete this timetable slot? This action cannot be undone."))try{await T(async()=>{let e=await n.nE(a);return e}),e.push("/admin/timetable?success=deleted")}catch(e){}},handleCancel=()=>{e.push("/admin/timetable")},F=[{value:"",label:"Select time"},{value:"08:00",label:"08:00"},{value:"09:00",label:"09:00"},{value:"10:00",label:"10:00"},{value:"11:00",label:"11:00"},{value:"12:00",label:"12:00"},{value:"13:00",label:"13:00"},{value:"14:00",label:"14:00"},{value:"15:00",label:"15:00"},{value:"16:00",label:"16:00"},{value:"17:00",label:"17:00"},{value:"18:00",label:"18:00"}];return v?(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(o.default,{}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(c.default,{}),(0,s.jsx)("main",{className:"flex-1 p-6",children:(0,s.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,s.jsxs)("div",{className:"animate-pulse",children:[(0,s.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-4"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]})]})})})})]})]}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(o.default,{}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(c.default,{}),(0,s.jsx)("main",{className:"flex-1 p-6",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit Timetable Slot"}),(0,s.jsx)("p",{className:"text-gray-600 mt-1",children:"Modify or delete this timetable slot"})]}),(0,s.jsx)(u.Z,{variant:"outline",onClick:handleCancel,children:"← Back to Timetable"})]})}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:(0,s.jsx)("div",{className:"p-6",children:(0,s.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Course *"}),(0,s.jsxs)("select",{value:h.course_id,onChange:e=>handleInputChange("course_id",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(b.course_id?"border-red-500":"border-gray-300"),disabled:p,children:[(0,s.jsx)("option",{value:"",children:"Select a course"}),y&&y.length>0?y.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.course_code," - ",e.name]},e.id)):(0,s.jsx)("option",{value:"",disabled:!0,children:p?"Loading courses...":"No courses available"})]}),b.course_id&&(0,s.jsx)("p",{className:"text-red-500 text-xs mt-1",children:b.course_id})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Teacher *"}),(0,s.jsxs)("select",{value:h.teacher_id,onChange:e=>handleInputChange("teacher_id",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(b.teacher_id?"border-red-500":"border-gray-300"),disabled:_,children:[(0,s.jsx)("option",{value:"",children:"Select a teacher"}),C&&C.length>0?C.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.first_name," ",e.last_name]},e.id)):(0,s.jsx)("option",{value:"",disabled:!0,children:_?"Loading teachers...":"No teachers available"})]}),b.teacher_id&&(0,s.jsx)("p",{className:"text-red-500 text-xs mt-1",children:b.teacher_id})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class *"}),(0,s.jsxs)("select",{value:h.class_id,onChange:e=>handleInputChange("class_id",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(b.class_id?"border-red-500":"border-gray-300"),disabled:w,children:[(0,s.jsx)("option",{value:"",children:"Select a class"}),N&&N.length>0?N.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.name," (",e.academic_year,")"]},e.id)):(0,s.jsx)("option",{value:"",disabled:!0,children:w?"Loading classes...":"No classes available"})]}),b.class_id&&(0,s.jsx)("p",{className:"text-red-500 text-xs mt-1",children:b.class_id})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Day *"}),(0,s.jsx)("select",{value:h.day,onChange:e=>handleInputChange("day",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(b.day?"border-red-500":"border-gray-300"),children:[{value:"",label:"Select a day"},{value:"Monday",label:"Monday"},{value:"Tuesday",label:"Tuesday"},{value:"Wednesday",label:"Wednesday"},{value:"Thursday",label:"Thursday"},{value:"Friday",label:"Friday"},{value:"Saturday",label:"Saturday"},{value:"Sunday",label:"Sunday"}].map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))}),b.day&&(0,s.jsx)("p",{className:"text-red-500 text-xs mt-1",children:b.day})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Time *"}),(0,s.jsx)("select",{value:h.start_time,onChange:e=>handleInputChange("start_time",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(b.start_time?"border-red-500":"border-gray-300"),children:F.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))}),b.start_time&&(0,s.jsx)("p",{className:"text-red-500 text-xs mt-1",children:b.start_time})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Time *"}),(0,s.jsx)("select",{value:h.end_time,onChange:e=>handleInputChange("end_time",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(b.end_time?"border-red-500":"border-gray-300"),children:F.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))}),b.end_time&&(0,s.jsx)("p",{className:"text-red-500 text-xs mt-1",children:b.end_time})]}),(0,s.jsx)("div",{children:(0,s.jsx)(m.Z,{label:"Room *",value:h.room,onChange:e=>handleInputChange("room",e.target.value),placeholder:"e.g., Room 101, Lab A",error:b.room})})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Semester"}),(0,s.jsx)("select",{value:h.semester,onChange:e=>handleInputChange("semester",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[{value:"Fall 2024",label:"Fall 2024"},{value:"Spring 2025",label:"Spring 2025"},{value:"Summer 2025",label:"Summer 2025"},{value:"Fall 2025",label:"Fall 2025"}].map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))})]})}),(0,s.jsxs)("div",{className:"flex justify-between pt-6 border-t border-gray-200",children:[(0,s.jsx)(u.Z,{type:"button",variant:"danger",onClick:handleDelete,loading:E,disabled:k||E,children:"Delete Slot"}),(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)(u.Z,{type:"button",variant:"outline",onClick:handleCancel,disabled:k||E,children:"Cancel"}),(0,s.jsx)(u.Z,{type:"submit",loading:k,disabled:k||E,children:"Update Slot"})]})]})]})})})]})})]})]})}}},function(e){e.O(0,[1216,8592,2888,179],function(){return e(e.s=5280)}),_N_E=e.O()}]);