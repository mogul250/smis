(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[994],{6701:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/timetable",function(){return s(5906)}])},5906:function(e,t,s){"use strict";s.r(t);var a=s(5893),i=s(7294),l=s(9008),r=s.n(l),d=s(6761),n=s(3242),o=s(3240),c=s(4082),m=s(5936),u=s(4105),h=s(9180),x=s(9175),_=s(4549),f=s(9060);t.default=()=>{let{user:e}=(0,d.a)(),[t,s]=(0,i.useState)({}),[l,j]=(0,i.useState)(!1),[v,S]=(0,i.useState)(null),[b,y]=(0,i.useState)("create"),[g,p]=(0,i.useState)(""),[w,N]=(0,i.useState)(!1),{data:C,loading:T,error:D,refetch:A}=(0,n.h)(()=>Promise.resolve([{id:1,course_id:1,course_name:"Computer Science 101",course_code:"CS101",teacher_id:2,teacher_name:"Dr. John Smith",day_of_week:1,start_time:"09:00:00",end_time:"10:30:00",room:"Room 101",semester:"Fall 2024"},{id:2,course_id:2,course_name:"Mathematics 201",course_code:"MATH201",teacher_id:3,teacher_name:"Prof. Jane Doe",day_of_week:2,start_time:"11:00:00",end_time:"12:30:00",room:"Room 102",semester:"Fall 2024"}])),Z=[{id:1,name:"Computer Science 101",course_code:"CS101"},{id:2,name:"Mathematics 201",course_code:"MATH201"},{id:3,name:"Physics 101",course_code:"PHY101"}],k=[{id:2,first_name:"John",last_name:"Smith"},{id:3,first_name:"Jane",last_name:"Doe"},{id:4,first_name:"Bob",last_name:"Wilson"}],{execute:E,loading:M}=(0,n.c)(),{execute:R,loading:F}=(0,n.c)(),{execute:P,loading:z}=(0,n.c)();if(!e||"admin"!==e.role)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)(x.Z,{variant:"error",children:"Access denied. Admin access required."})});let handleRefresh=async()=>{N(!0);try{await A()}finally{N(!1)}},handleAddSlot=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};S(e),y("create"),j(!0)},handleEditSlot=e=>{S(e),y("edit"),j(!0)},handleDeleteSlot=async e=>{if(confirm("Are you sure you want to delete this timetable slot for ".concat(e.course_name,"?")))try{await P(()=>o.Sb.setupTimetable({action:"delete",timetableData:{id:e.id}})),p("Timetable slot deleted successfully"),setTimeout(()=>p(""),3e3),A()}catch(e){}},handleSaveSlot=async e=>{try{"create"===b?(await E(()=>o.Sb.setupTimetable({action:"add",timetableData:{course_id:e.course_id,teacher_id:e.teacher_id,day:e.day_of_week,start_time:e.start_time,end_time:e.end_time,room:e.room,semester:e.semester}})),p("Timetable slot created successfully")):(await R(()=>o.Sb.setupTimetable({action:"update",timetableData:{id:e.id,course_id:e.course_id,teacher_id:e.teacher_id,day:e.day_of_week,start_time:e.start_time,end_time:e.end_time,room:e.room,semester:e.semester}})),p("Timetable slot updated successfully")),setTimeout(()=>p(""),3e3),j(!1),S(null),A()}catch(e){}},L=(null==C?void 0:C.filter(e=>{if(t.semester&&e.semester!==t.semester||t.day&&e.day_of_week.toString()!==t.day||t.teacher&&e.teacher_id.toString()!==t.teacher||t.course&&e.course_id.toString()!==t.course)return!1;if(t.search){var s,a,i,l;let r=t.search.toLowerCase();return(null===(s=e.course_name)||void 0===s?void 0:s.toLowerCase().includes(r))||(null===(a=e.course_code)||void 0===a?void 0:a.toLowerCase().includes(r))||(null===(i=e.teacher_name)||void 0===i?void 0:i.toLowerCase().includes(r))||(null===(l=e.room)||void 0===l?void 0:l.toLowerCase().includes(r))}return!0}))||[];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r(),{children:(0,a.jsx)("title",{children:"Timetable Management - Admin Dashboard"})}),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(c.Z,{}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(m.Z,{}),(0,a.jsx)("main",{className:"flex-1 overflow-auto",children:(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Timetable Management"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Create and manage class schedules across all departments"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(h.Z,{variant:"outline",size:"sm",onClick:handleRefresh,loading:w,children:"\uD83D\uDD04 Refresh"}),(0,a.jsx)(h.Z,{onClick:()=>handleAddSlot(),children:"âž• Add Slot"})]})]}),g&&(0,a.jsx)(x.Z,{variant:"success",dismissible:!0,onDismiss:()=>p(""),children:g}),D&&(0,a.jsxs)(x.Z,{variant:"error",children:["Error loading timetable: ",D]}),(0,a.jsx)(f.QD,{filters:t,onFilterChange:e=>{s(e)},teachers:k,courses:Z,showTeacherFilter:!0,showCourseFilter:!0,onReset:()=>{s({})},onExport:()=>{}}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsxs)(u.Z,{className:"p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:(null==C?void 0:C.length)||0}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Total Slots"})]}),(0,a.jsxs)(u.Z,{className:"p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:new Set(null==C?void 0:C.map(e=>e.course_id)).size||0}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Courses Scheduled"})]}),(0,a.jsxs)(u.Z,{className:"p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:new Set(null==C?void 0:C.map(e=>e.teacher_id)).size||0}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Teachers Assigned"})]}),(0,a.jsxs)(u.Z,{className:"p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:new Set(null==C?void 0:C.map(e=>e.room)).size||0}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Rooms Used"})]})]}),T?(0,a.jsx)(u.Z,{className:"p-12",children:(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(_.Z,{size:"lg"})})}):(0,a.jsx)(f.mG,{timetable:L,editable:!0,showActions:!0,colorScheme:"course",title:"Master Timetable",onSlotClick:handleEditSlot,onSlotEdit:handleEditSlot,onSlotDelete:handleDeleteSlot,onAddSlot:handleAddSlot})]})})]})]}),(0,a.jsx)(f.V,{isOpen:l,onClose:()=>{j(!1),S(null)},onSave:handleSaveSlot,slot:v,mode:b,courses:Z,teachers:k,loading:M||F})]})}}},function(e){e.O(0,[216,592,888,179],function(){return e(e.s=6701)}),_N_E=e.O()}]);