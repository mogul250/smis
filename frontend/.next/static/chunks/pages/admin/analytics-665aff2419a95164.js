(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[867],{8197:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/analytics",function(){return t(2812)}])},2812:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return analytics}});var a=t(5893),l=t(7294),i=t(1163),n=t(6761),r=t(3240),c=t(4082),d=t(5936),o=t(9180),m=t(4105),x=t(7219);let UserActivityTimeline=e=>{let{activities:s=[],loading:t}=e,l=[{id:1,type:"user_created",message:"New student John Doe was created",timestamp:new Date(Date.now()-72e5),icon:x.zy7,color:"blue"},{id:2,type:"user_login",message:"Teacher Sarah Wilson logged in",timestamp:new Date(Date.now()-144e5),icon:x.bAx,color:"green"},{id:3,type:"user_updated",message:"Admin updated user permissions",timestamp:new Date(Date.now()-216e5),icon:x.WY8,color:"orange"},{id:4,type:"user_deactivated",message:"User account was deactivated",timestamp:new Date(Date.now()-288e5),icon:x.tMu,color:"red"}],i=s.length>0?s:l,getTimeAgo=e=>{let s=new Date,t=s-new Date(e),a=Math.floor(t/36e5),l=Math.floor(t/6e4);return a>0?"".concat(a,"h ago"):l>0?"".concat(l,"m ago"):"Just now"},getColorClasses=e=>{let s={blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",orange:"bg-orange-100 text-orange-600",red:"bg-red-100 text-red-600",purple:"bg-purple-100 text-purple-600"};return s[e]||s.blue};return t?(0,a.jsx)(m.Z,{className:"p-6",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-6 bg-gray-200 rounded w-32 mb-4"}),(0,a.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded-full"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-1"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]})]},s))})]})}):(0,a.jsxs)(m.Z,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Activity"}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,a.jsx)(x.TCC,{className:"w-4 h-4 mr-1"}),"Live updates"]})]}),(0,a.jsx)("div",{className:"space-y-4",children:i.map((e,s)=>{let t=e.icon,l=getColorClasses(e.color);return(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ".concat(l),children:(0,a.jsx)(t,{className:"w-4 h-4"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm text-gray-900",children:e.message}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:getTimeAgo(e.timestamp)})]})]},e.id||s)})}),(0,a.jsx)("div",{className:"mt-6 pt-4 border-t border-gray-200",children:(0,a.jsx)("button",{className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View all activity â†’"})})]})},UserDistributionChart=e=>{let{stats:s,loading:t}=e,l=Object.values(s.byRole||{}).reduce((e,s)=>e+s,0);return t?(0,a.jsx)(m.Z,{className:"p-6",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-6 bg-gray-200 rounded w-32 mb-4"}),(0,a.jsx)("div",{className:"h-48 bg-gray-200 rounded"})]})}):(0,a.jsxs)(m.Z,{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"User Distribution"}),(0,a.jsx)("div",{className:"space-y-4",children:[{key:"student",label:"Students",color:"bg-blue-500"},{key:"teacher",label:"Teachers",color:"bg-green-500"},{key:"hod",label:"HODs",color:"bg-purple-500"},{key:"finance",label:"Finance",color:"bg-orange-500"},{key:"admin",label:"Admins",color:"bg-red-500"}].map(e=>{var t;let i=(null===(t=s.byRole)||void 0===t?void 0:t[e.key])||0,n=l>0?i/l*100:0;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.label}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[i," (",Math.round(n),"%)"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"".concat(e.color," h-2 rounded-full transition-all duration-300"),style:{width:"".concat(n,"%")}})})]},e.key)})}),(0,a.jsx)("div",{className:"mt-6 pt-4 border-t border-gray-200 text-center",children:(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Total: ",(0,a.jsxs)("span",{className:"font-medium text-gray-900",children:[l," users"]})]})})]})};var users_UserAnalytics=e=>{let{stats:s,loading:t}=e,l=[{title:"User Growth",description:"New users this month",value:s.newThisMonth||0,change:"+23%",changeType:"positive",icon:x.zy7,color:"blue"},{title:"Active Rate",description:"Users active in last 30 days",value:"".concat(s.totalUsers>0?Math.round(s.activeUsers/s.totalUsers*100):0,"%"),change:"+5%",changeType:"positive",icon:x.bAx,color:"green"},{title:"Login Rate",description:"Users logged in today",value:Math.round(.3*s.activeUsers)||0,change:"-2%",changeType:"negative",icon:x.TCC,color:"orange"},{title:"Completion Rate",description:"Profiles completed",value:"".concat(Math.round(.85*s.activeUsers)||0,"%"),change:"+12%",changeType:"positive",icon:x.tMu,color:"purple"}],getColorClasses=e=>{let s={blue:{bg:"bg-blue-50",icon:"text-blue-600",iconBg:"bg-blue-100"},green:{bg:"bg-green-50",icon:"text-green-600",iconBg:"bg-green-100"},orange:{bg:"bg-orange-50",icon:"text-orange-600",iconBg:"bg-orange-100"},purple:{bg:"bg-purple-50",icon:"text-purple-600",iconBg:"bg-purple-100"}};return s[e]||s.blue};return t?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(m.Z,{className:"p-6 animate-pulse",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-24 mb-2"}),(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded w-16 mb-2"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-20"})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-gray-200 rounded-lg"})]})},s))}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:l.map((e,s)=>{let t=e.icon,l=getColorClasses(e.color),i="positive"===e.changeType;return(0,a.jsx)(m.Z,{className:"p-6 hover:shadow-md transition-shadow duration-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600 mb-1",children:e.title}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 mb-2",children:"number"==typeof e.value?e.value.toLocaleString():e.value}),(0,a.jsxs)("div",{className:"flex items-center",children:[i?(0,a.jsx)(x.QqI,{className:"w-4 h-4 text-green-500 mr-1"}):(0,a.jsx)(x.ZBs,{className:"w-4 h-4 text-red-500 mr-1"}),(0,a.jsx)("span",{className:"text-sm font-medium ".concat(i?"text-green-600":"text-red-600"),children:e.change}),(0,a.jsx)("span",{className:"text-sm text-gray-500 ml-1",children:e.description})]})]}),(0,a.jsx)("div",{className:"w-12 h-12 ".concat(l.iconBg," rounded-lg flex items-center justify-center"),children:(0,a.jsx)(t,{className:"w-6 h-6 ".concat(l.icon)})})]})},s)})})},g=t(856),analytics=()=>{let{user:e,isAuthenticated:s}=(0,n.a)(),t=(0,i.useRouter)(),[h,u]=(0,l.useState)(!0),[j,p]=(0,l.useState)(!1),[v,b]=(0,l.useState)("30d"),[y,N]=(0,l.useState)({totalUsers:0,activeUsers:0,newThisMonth:0,byRole:{}}),[f,w]=(0,l.useState)({totalLogins:0,avgSessionTime:0,bounceRate:0,systemUptime:0});(0,l.useEffect)(()=>{if(!s||(null==e?void 0:e.role)!=="admin"){t.push("/dashboard");return}},[s,e,t]);let fetchAnalytics=async()=>{try{u(!0);let e=await r.Sb.getAllUsers({limit:1e3}),s=e.data.users||[],t={totalUsers:s.length,activeUsers:s.filter(e=>"active"===e.status).length,newThisMonth:s.filter(e=>{let s=new Date(e.created_at),t=new Date;return s.getMonth()===t.getMonth()&&s.getFullYear()===t.getFullYear()}).length,byRole:{}};s.forEach(e=>{t.byRole[e.role]=(t.byRole[e.role]||0)+1}),N(t),w({totalLogins:Math.floor(2.3*t.totalUsers),avgSessionTime:24,bounceRate:12,systemUptime:99.9})}catch(e){}finally{u(!1),p(!1)}};if((0,l.useEffect)(()=>{s&&(null==e?void 0:e.role)==="admin"&&fetchAnalytics()},[s,e,v]),!s||(null==e?void 0:e.role)!=="admin")return null;let U=[{title:"Total Logins",value:f.totalLogins,change:"+15%",changeType:"positive",icon:x.bAx,color:"blue"},{title:"Avg Session Time",value:"".concat(f.avgSessionTime,"m"),change:"+8%",changeType:"positive",icon:x.QqI,color:"green"},{title:"Bounce Rate",value:"".concat(f.bounceRate,"%"),change:"-3%",changeType:"positive",icon:x.DKx,color:"orange"},{title:"System Uptime",value:"".concat(f.systemUptime,"%"),change:"+0.1%",changeType:"positive",icon:x.bAx,color:"purple"}];return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(c.Z,{}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(d.Z,{}),(0,a.jsx)("main",{className:"flex-1 overflow-auto",children:(0,a.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[(0,a.jsx)(x.DKx,{className:"mr-3 text-blue-600"}),"Analytics Dashboard"]}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"System performance and user insights"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("select",{value:v,onChange:e=>b(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"7d",children:"Last 7 days"}),(0,a.jsx)("option",{value:"30d",children:"Last 30 days"}),(0,a.jsx)("option",{value:"90d",children:"Last 90 days"}),(0,a.jsx)("option",{value:"1y",children:"Last year"})]}),(0,a.jsx)(o.Z,{variant:"outline",icon:x.Bw1,onClick:()=>{p(!0),fetchAnalytics()},loading:j,size:"sm",children:"Refresh"}),(0,a.jsx)(o.Z,{variant:"outline",icon:x._hL,onClick:()=>{let e={userStats:y,systemStats:f,exportDate:new Date().toISOString(),timeRange:v},s=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),t=URL.createObjectURL(s),a=document.createElement("a");a.href=t,a.download="analytics-".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t)},size:"sm",children:"Export"})]})]})}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"User Overview"}),(0,a.jsx)(g.Z,{stats:y,totalUsers:y.totalUsers,loading:h})]}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"User Analytics"}),(0,a.jsx)(users_UserAnalytics,{stats:y,loading:h})]}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"System Metrics"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:U.map((e,s)=>{let t=e.icon,l="positive"===e.changeType;return(0,a.jsx)(m.Z,{className:"p-6 hover:shadow-md transition-shadow duration-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600 mb-1",children:e.title}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 mb-2",children:"number"==typeof e.value?e.value.toLocaleString():e.value}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(x.QqI,{className:"w-4 h-4 mr-1 ".concat(l?"text-green-500":"text-red-500")}),(0,a.jsx)("span",{className:"text-sm font-medium ".concat(l?"text-green-600":"text-red-600"),children:e.change}),(0,a.jsx)("span",{className:"text-sm text-gray-500 ml-1",children:"vs last period"})]})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-".concat(e.color,"-100 rounded-lg flex items-center justify-center"),children:(0,a.jsx)(t,{className:"w-6 h-6 text-".concat(e.color,"-600")})})]})},s)})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[(0,a.jsx)(UserDistributionChart,{stats:y,loading:h}),(0,a.jsx)(UserActivityTimeline,{loading:h})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)(m.Z,{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Peak Usage Times"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Morning (8-12 PM)"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:(0,a.jsx)("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:"75%"}})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"75%"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Afternoon (12-6 PM)"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:(0,a.jsx)("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"90%"}})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"90%"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Evening (6-10 PM)"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:(0,a.jsx)("div",{className:"bg-orange-500 h-2 rounded-full",style:{width:"45%"}})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"45%"})]})]})]})]}),(0,a.jsxs)(m.Z,{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Departments"}),(0,a.jsx)("div",{className:"space-y-3",children:["Computer Science","Mathematics","Physics","Chemistry"].map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:e}),(0,a.jsx)("span",{className:"text-sm font-medium",children:Math.floor(50*Math.random())+20})]},e))})]}),(0,a.jsxs)(m.Z,{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(o.Z,{variant:"outline",className:"w-full justify-start",icon:x.WY8,onClick:()=>t.push("/admin/users"),children:"Manage Users"}),(0,a.jsx)(o.Z,{variant:"outline",className:"w-full justify-start",icon:x.vlc,onClick:()=>t.push("/admin/calendar"),children:"Academic Calendar"}),(0,a.jsx)(o.Z,{variant:"outline",className:"w-full justify-start",icon:x.DKx,children:"Generate Report"})]})]})]})]})})]})]})}}},function(e){e.O(0,[216,592,888,179],function(){return e(e.s=8197)}),_N_E=e.O()}]);