(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5994],{6701:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/timetable",function(){return t(5906)}])},5906:function(e,s,t){"use strict";t.r(s);var a=t(5893),l=t(7294),i=t(9008),r=t.n(i),d=t(1163),c=t(6761),n=t(3242),o=t(591),m=t(4082),h=t(2983),u=t(4105),x=t(9180),f=t(9175),v=t(4549),j=t(9060);s.default=()=>{let{user:e}=(0,c.a)(),s=(0,d.useRouter)(),[t,i]=(0,l.useState)({}),[_,g]=(0,l.useState)(""),[S,b]=(0,l.useState)(!1),{data:p,loading:N,error:y,refetch:w}=(0,n.h)(()=>o.Sb.getTimetable({semester:"Fall 2024"}).catch(()=>Promise.resolve([{id:1,course_id:1,course_name:"Computer Science 101",course_code:"CS101",teacher_id:2,teacher_name:"Dr. John Smith",day_of_week:1,start_time:"09:00:00",end_time:"10:30:00",class_id:1,room:"Room 101",semester:"Fall 2024"},{id:2,course_id:2,course_name:"Mathematics 201",course_code:"MATH201",teacher_id:3,teacher_name:"Prof. Jane Doe",day_of_week:2,start_time:"11:00:00",end_time:"12:30:00",class_id:1,room:"Room 102",semester:"Fall 2024"}]))),{data:C}=(0,n.h)(()=>o.Sb.getCourses().catch(e=>Promise.resolve([]))),{data:T}=(0,n.h)(()=>o.Sb.getTeachers(1,100).catch(e=>Promise.resolve([])));if(!e||"admin"!==e.role)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)(f.Z,{variant:"error",children:"Access denied. Admin access required."})});let handleRefresh=async()=>{b(!0);try{await w()}finally{b(!1)}},handleAddSlot=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;e.day&&t.append("day",e.day),e.time&&t.append("time",e.time);let a=t.toString();s.push("/admin/timetable/create".concat(a?"?".concat(a):""))},handleEditSlot=e=>{s.push("/admin/timetable/edit/".concat(e.id))};l.useEffect(()=>{let{success:e}=s.query;if(e){switch(e){case"created":g("Timetable slot created successfully!");break;case"updated":g("Timetable slot updated successfully!");break;case"deleted":g("Timetable slot deleted successfully!")}s.replace("/admin/timetable",void 0,{shallow:!0}),setTimeout(()=>g(""),3e3),w()}},[s.query.success]);let E=(null==p?void 0:p.filter(e=>{if(t.semester&&e.semester!==t.semester||t.day&&e.day_of_week.toString()!==t.day||t.teacher&&e.teacher_id.toString()!==t.teacher||t.course&&e.course_id.toString()!==t.course)return!1;if(t.search){var s,a,l,i;let r=t.search.toLowerCase();return(null===(s=e.course_name)||void 0===s?void 0:s.toLowerCase().includes(r))||(null===(a=e.course_code)||void 0===a?void 0:a.toLowerCase().includes(r))||(null===(l=e.teacher_name)||void 0===l?void 0:l.toLowerCase().includes(r))||(null===(i=e.room)||void 0===i?void 0:i.toLowerCase().includes(r))}return!0}))||[];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r(),{children:(0,a.jsx)("title",{children:"Timetable Management - Admin Dashboard"})}),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(m.default,{}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(h.default,{}),(0,a.jsx)("main",{className:"flex-1 overflow-auto",children:(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Timetable Management"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Create and manage class schedules across all departments"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(x.Z,{variant:"outline",size:"sm",onClick:handleRefresh,loading:S,children:"\uD83D\uDD04 Refresh"}),(0,a.jsx)(x.Z,{onClick:()=>handleAddSlot(),children:"âž• Add Slot"})]})]}),_&&(0,a.jsx)(f.Z,{variant:"success",dismissible:!0,onDismiss:()=>g(""),children:_}),y&&(0,a.jsxs)(f.Z,{variant:"error",children:["Error loading timetable: ",y]}),(0,a.jsx)(j.QD,{filters:t,onFilterChange:e=>{i(e)},teachers:T,courses:C,showTeacherFilter:!0,showCourseFilter:!0,onReset:()=>{i({})},onExport:()=>{}}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsxs)(u.Z,{className:"p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:(null==p?void 0:p.length)||0}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Total Slots"})]}),(0,a.jsxs)(u.Z,{className:"p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:new Set(null==p?void 0:p.map(e=>e.course_id)).size||0}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Courses Scheduled"})]}),(0,a.jsxs)(u.Z,{className:"p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:new Set(null==p?void 0:p.map(e=>e.teacher_id)).size||0}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Teachers Assigned"})]}),(0,a.jsxs)(u.Z,{className:"p-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:new Set(null==p?void 0:p.map(e=>e.room)).size||0}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Rooms Used"})]})]}),N?(0,a.jsx)(u.Z,{className:"p-12",children:(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(v.Z,{size:"lg"})})}):(0,a.jsx)(j.mG,{timetable:E,editable:!0,showActions:!0,colorScheme:"course",title:"Master Timetable",onSlotClick:handleEditSlot,onSlotEdit:handleEditSlot,onSlotDelete:handleEditSlot,onAddSlot:handleAddSlot})]})})]})]})]})}}},function(e){e.O(0,[1216,8592,2888,179],function(){return e(e.s=6701)}),_N_E=e.O()}]);