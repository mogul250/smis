(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4570],{2785:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/departments/new",function(){return a(4143)}])},4143:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return departments_new}});var r={};a.r(r);var s=a(5893),n=a(7294),l=a(1163),d=a(6761),i=a(591),c=a(4082),o=a(2983);let m={default:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",destructive:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-blue-500",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 focus:ring-gray-500",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-500",link:"text-blue-600 underline-offset-4 hover:underline focus:ring-blue-500"},u={default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"},x=n.forwardRef((e,t)=>{let{className:a="",variant:r="default",size:n="default",disabled:l=!1,loading:d=!1,children:i,...c}=e,o=m[r]||m.default,x=u[n]||u.default,h="".concat("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none"," ").concat(o," ").concat(x," ").concat(a);return(0,s.jsxs)("button",{className:h,ref:t,disabled:l||d,...c,children:[d&&(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),i]})});x.displayName="Button";let h=n.forwardRef((e,t)=>{let{className:a="",type:r="text",error:n=!1,...l}=e,d="".concat("flex h-10 w-full rounded-md border px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"," ").concat(n?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"," ").concat(a);return(0,s.jsx)("input",{type:r,className:d,ref:t,...l})});h.displayName="Input";let f=n.forwardRef((e,t)=>{let{className:a="",...r}=e;return(0,s.jsx)("div",{ref:t,className:"rounded-lg border border-gray-200 bg-white text-gray-950 shadow-sm ".concat(a),...r})});f.displayName="Card";let p=n.forwardRef((e,t)=>{let{className:a="",...r}=e;return(0,s.jsx)("div",{ref:t,className:"flex flex-col space-y-1.5 p-6 ".concat(a),...r})});p.displayName="CardHeader";let g=n.forwardRef((e,t)=>{let{className:a="",...r}=e;return(0,s.jsx)("h3",{ref:t,className:"text-2xl font-semibold leading-none tracking-tight ".concat(a),...r})});g.displayName="CardTitle";let b=n.forwardRef((e,t)=>{let{className:a="",...r}=e;return(0,s.jsx)("p",{ref:t,className:"text-sm text-gray-500 ".concat(a),...r})});b.displayName="CardDescription";let j=n.forwardRef((e,t)=>{let{className:a="",...r}=e;return(0,s.jsx)("div",{ref:t,className:"p-6 pt-0 ".concat(a),...r})});j.displayName="CardContent";let y=n.forwardRef((e,t)=>{let{className:a="",...r}=e;return(0,s.jsx)("div",{ref:t,className:"flex items-center p-6 pt-0 ".concat(a),...r})});y.displayName="CardFooter";let N={default:"bg-white border-gray-200",destructive:"border-red-200 bg-red-50 text-red-900 [&>svg]:text-red-600",success:"border-green-200 bg-green-50 text-green-900 [&>svg]:text-green-600",warning:"border-yellow-200 bg-yellow-50 text-yellow-900 [&>svg]:text-yellow-600"},v=n.forwardRef((e,t)=>{let{className:a="",variant:r="default",...n}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-gray-950 ".concat(N[r]," ").concat(a),...n})});v.displayName="Alert";let w=n.forwardRef((e,t)=>{let{className:a="",...r}=e;return(0,s.jsx)("h5",{ref:t,className:"mb-1 font-medium leading-none tracking-tight ".concat(a),...r})});w.displayName="AlertTitle";let C=n.forwardRef((e,t)=>{let{className:a="",...r}=e;return(0,s.jsx)("div",{ref:t,className:"text-sm [&_p]:leading-relaxed ".concat(a),...r})});C.displayName="AlertDescription";var _=a(7219),departments_new=()=>{let{user:e,isAuthenticated:t}=(0,d.a)(),a=(0,l.useRouter)(),[m,u]=(0,n.useState)({name:"",code:"",description:"",head_id:"",status:"active"}),[b,N]=(0,n.useState)([]),[k,D]=(0,n.useState)(!0),[S,A]=(0,n.useState)(!1),[F,R]=(0,n.useState)(null),[I,E]=(0,n.useState)(!1),[T,U]=(0,n.useState)({});if((0,n.useEffect)(()=>{let fetchUsers=async()=>{try{D(!0);let e=await i.Sb.getAllUsers(1,100,{role:"teacher"});e&&e.users&&N(e.users)}catch(e){R("Failed to load teachers for HOD selection")}finally{D(!1)}};t&&(null==e?void 0:e.role)==="admin"&&fetchUsers()},[t,e]),!t||(null==e?void 0:e.role)!=="admin")return null;let validateForm=()=>{let e={};return m.name.trim()?m.name.length<2&&(e.name="Department name must be at least 2 characters"):e.name="Department name is required",m.code.trim()?m.code.length<2?e.code="Department code must be at least 2 characters":/^[A-Z0-9]+$/.test(m.code)||(e.code="Department code must contain only uppercase letters and numbers"):e.code="Department code is required",m.description&&m.description.length>500&&(e.description="Description must be less than 500 characters"),U(e),0===Object.keys(e).length},handleInputChange=e=>{let{name:t,value:a}=e.target;u(e=>({...e,[t]:a})),T[t]&&U(e=>({...e,[t]:""}))},handleSubmit=async e=>{if(e.preventDefault(),validateForm()){A(!0),R(null);try{let e={name:m.name.trim(),code:m.code.trim().toUpperCase(),description:m.description.trim()||null,head_id:m.head_id?parseInt(m.head_id):null,status:m.status};await i.Sb.createDepartment(e),E(!0),setTimeout(()=>{a.push("/admin/departments")},2e3)}catch(e){R(e.message||"Failed to create department")}finally{A(!1)}}};return k?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(_.dAq,{className:"animate-spin h-8 w-8 text-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading..."})]})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(c.default,{}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(o.default,{}),(0,s.jsxs)("main",{className:"flex-1 p-6",children:[(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(x,{variant:"ghost",size:"icon",onClick:()=>a.back(),className:"mr-4",children:(0,s.jsx)(_.Ao2,{className:"w-5 h-5"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Create New Department"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Add a new academic department to the system"})]})]})}),I&&(0,s.jsxs)(v,{variant:"success",className:"mb-6",children:[(0,s.jsx)(_.UgA,{className:"h-4 w-4"}),(0,s.jsx)(w,{children:"Department Created Successfully!"}),(0,s.jsx)(C,{children:"Redirecting to departments list..."})]}),F&&(0,s.jsxs)(v,{variant:"destructive",className:"mb-6",children:[(0,s.jsx)(_.bcx,{className:"h-4 w-4"}),(0,s.jsx)(w,{children:"Error"}),(0,s.jsx)(C,{children:F})]}),(0,s.jsxs)(f,{children:[(0,s.jsx)(p,{children:(0,s.jsxs)(g,{className:"flex items-center",children:[(0,s.jsx)(r.FiBuilding,{className:"w-5 h-5 text-blue-600 mr-2"}),"Department Information"]})}),(0,s.jsxs)("form",{onSubmit:handleSubmit,children:[(0,s.jsxs)(j,{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Department Name *"}),(0,s.jsx)(h,{id:"name",name:"name",value:m.name,onChange:handleInputChange,error:!!T.name,placeholder:"e.g., Computer Science",disabled:S}),T.name&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:T.name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"code",className:"block text-sm font-medium text-gray-700 mb-2",children:"Department Code *"}),(0,s.jsx)(h,{id:"code",name:"code",value:m.code,onChange:handleInputChange,error:!!T.code,placeholder:"e.g., CS, ENG, MATH",disabled:S,style:{textTransform:"uppercase"}}),T.code&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:T.code}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Use uppercase letters and numbers only"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,s.jsx)("textarea",{id:"description",name:"description",value:m.description,onChange:handleInputChange,rows:4,className:"w-full px-3 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ".concat(T.description?"border-red-300":"border-gray-300"),placeholder:"Brief description of the department...",disabled:S}),T.description&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:T.description}),(0,s.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:[m.description.length,"/500 characters"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"head_id",className:"block text-sm font-medium text-gray-700 mb-2",children:"Head of Department"}),(0,s.jsxs)("select",{id:"head_id",name:"head_id",value:m.head_id,onChange:handleInputChange,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:S,children:[(0,s.jsx)("option",{value:"",children:"Select a teacher (optional)"}),b.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.first_name," ",e.last_name," (",e.email,")"]},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,s.jsxs)("select",{id:"status",name:"status",value:m.status,onChange:handleInputChange,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:S,children:[(0,s.jsx)("option",{value:"active",children:"Active"}),(0,s.jsx)("option",{value:"inactive",children:"Inactive"})]})]})]}),(0,s.jsxs)(y,{className:"flex items-center justify-end space-x-4",children:[(0,s.jsx)(x,{type:"button",variant:"outline",onClick:()=>a.back(),disabled:S,children:"Cancel"}),(0,s.jsx)(x,{type:"submit",loading:S,disabled:S,children:S?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_.dAq,{className:"animate-spin w-4 h-4 mr-2"}),"Creating..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_.mW3,{className:"w-4 h-4 mr-2"}),"Create Department"]})})]})]})]})]})]})]})}}},function(e){e.O(0,[1216,8592,2888,179],function(){return e(e.s=2785)}),_N_E=e.O()}]);