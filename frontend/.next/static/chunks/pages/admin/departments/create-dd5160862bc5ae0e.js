(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5138],{9916:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/departments/create",function(){return t(2187)}])},2187:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return create}});var s={};t.r(s);var n=t(5893),l=t(7294),r=t(1163),i=t(6761),d=t(591),c=t(4082),o=t(2983),m=t(9180),u=t(4105),h=t(5822),x=t(897),p=t(4549),g=t(7219),create=()=>{let{user:e,isAuthenticated:a}=(0,i.a)(),t=(0,r.useRouter)(),[f,b]=(0,l.useState)({name:"",code:"",description:"",hodId:"",status:"active"}),[j,v]=(0,l.useState)([]),[N,y]=(0,l.useState)(!0),[C,w]=(0,l.useState)(!1),[S,D]=(0,l.useState)(null),[_,I]=(0,l.useState)(null),[k,Z]=(0,l.useState)({});(0,l.useEffect)(()=>{if(!a||(null==e?void 0:e.role)!=="admin"){t.push("/dashboard");return}},[a,e,t]),(0,l.useEffect)(()=>{a&&(null==e?void 0:e.role)==="admin"&&fetchUsers()},[a,e]);let fetchUsers=async()=>{try{var e;y(!0);let a=await d.Sb.getAllUsers(1,1e3),t=(null===(e=a.users)||void 0===e?void 0:e.filter(e=>"teacher"===e.role||"hod"===e.role))||[];v(t)}catch(e){D("Failed to load users. Please try again.")}finally{y(!1)}},handleInputChange=e=>{let{name:a,value:t}=e.target;b(e=>({...e,[a]:t})),k[a]&&Z(e=>({...e,[a]:null}))},validateForm=()=>{let e={};return f.name.trim()||(e.name="Department name is required"),f.code.trim()?(f.code.length<2||f.code.length>10)&&(e.code="Department code must be between 2 and 10 characters"):e.code="Department code is required",f.status||(e.status="Status is required"),Z(e),0===Object.keys(e).length},handleSubmit=async e=>{if(e.preventDefault(),validateForm())try{w(!0),D(null);let e={name:f.name.trim(),code:f.code.trim().toUpperCase(),description:f.description.trim()||null,hodId:f.hodId||null,status:f.status};await d.Sb.createDepartment(e),I({type:"success",text:"Department created successfully!"}),setTimeout(()=>{t.push("/admin/departments")},2e3)}catch(e){D(e.message||"Failed to create department. Please try again.")}finally{w(!1)}};return a&&(null==e?void 0:e.role)==="admin"?N?(0,n.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,n.jsx)(c.default,{}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)(o.default,{}),(0,n.jsx)("main",{className:"flex-1 p-6 flex justify-center items-center",children:(0,n.jsx)(p.Z,{size:"lg"})})]})]}):(0,n.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,n.jsx)(c.default,{}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)(o.default,{}),(0,n.jsx)("main",{className:"flex-1 p-6",children:(0,n.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,n.jsx)("div",{className:"mb-6",children:(0,n.jsx)("div",{className:"flex items-center justify-between",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(m.Z,{variant:"outline",onClick:()=>t.push("/admin/departments"),icon:g.Ao2,className:"mr-4",children:"Back"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Create New Department"}),(0,n.jsx)("p",{className:"text-gray-600 mt-1",children:"Add a new department to the system"})]})]})})}),_&&(0,n.jsx)("div",{className:"mb-6 p-4 rounded-lg border-l-4 ".concat("success"===_.type?"bg-green-50 border-green-400 text-green-800":"bg-red-50 border-red-400 text-red-800"),children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(s.FiBuilding,{className:"w-5 h-5 mr-2"}),(0,n.jsx)("span",{className:"font-medium",children:_.text})]})}),S&&(0,n.jsx)("div",{className:"mb-6 p-4 rounded-lg border-l-4 bg-red-50 border-red-400 text-red-800",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(g.H33,{className:"w-5 h-5 mr-2"}),(0,n.jsx)("span",{className:"font-medium",children:S})]})}),(0,n.jsx)(u.Z,{children:(0,n.jsx)("div",{className:"p-6",children:(0,n.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Basic Information"}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)(h.Z,{label:"Department Name",name:"name",value:f.name,onChange:handleInputChange,error:k.name,required:!0,icon:s.FiBuilding,placeholder:"e.g., Computer Science"}),(0,n.jsx)(h.Z,{label:"Department Code",name:"code",value:f.code,onChange:handleInputChange,error:k.code,required:!0,icon:s.FiBuilding,placeholder:"e.g., CS",maxLength:10}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,n.jsx)("textarea",{name:"description",value:f.description,onChange:handleInputChange,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Brief description of the department (optional)"})]})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Management"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsx)(x.Z,{label:"Head of Department",name:"hodId",value:f.hodId,onChange:handleInputChange,options:[{value:"",label:"Select HOD (Optional)"},...j.map(e=>({value:e.id.toString(),label:"".concat(e.first_name," ").concat(e.last_name," (").concat(e.role,")")}))]}),(0,n.jsx)(x.Z,{label:"Status",name:"status",value:f.status,onChange:handleInputChange,options:[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],error:k.status,required:!0})]})]}),(0,n.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[(0,n.jsx)(m.Z,{type:"button",variant:"outline",onClick:()=>t.push("/admin/departments"),disabled:C,children:"Cancel"}),(0,n.jsx)(m.Z,{type:"submit",variant:"primary",icon:g.mW3,disabled:C,loading:C,children:C?"Creating Department...":"Create Department"})]})]})})})]})})]})]}):null}}},function(e){e.O(0,[1216,8592,2888,179],function(){return e(e.s=9916)}),_N_E=e.O()}]);