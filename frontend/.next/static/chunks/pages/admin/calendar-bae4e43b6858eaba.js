(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[996],{302:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/calendar",function(){return a(444)}])},444:function(e,t,a){"use strict";a.r(t);var s=a(5893),l=a(7294),n=a(6761),i=a(3242),d=a(3240),r=a(4082),c=a(5936),o=a(4105),m=a(9180),x=a(5822),v=a(9175),u=a(4549),h=a(7219);t.default=()=>{let{user:e}=(0,n.a)(),[t,a]=(0,l.useState)(!1),[p,y]=(0,l.useState)(null),[g,j]=(0,l.useState)(null),[b,N]=(0,l.useState)({eventName:"",eventType:"holiday",startDate:"",endDate:"",description:""}),{data:f,loading:E,refetch:w}=(0,i.h)(()=>d.Sb.getAcademicCalendar()),{loading:D,execute:C}=(0,i.c)();if(!e||"admin"!==e.role)return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Admin access required."})]})});let _=[{value:"holiday",label:"Holiday",color:"bg-red-100 text-red-800"},{value:"exam",label:"Examination",color:"bg-blue-100 text-blue-800"},{value:"semester_start",label:"Semester Start",color:"bg-green-100 text-green-800"},{value:"semester_end",label:"Semester End",color:"bg-yellow-100 text-yellow-800"},{value:"announcement",label:"Announcement",color:"bg-purple-100 text-purple-800"},{value:"meeting",label:"Meeting",color:"bg-gray-100 text-gray-800"}],handleOpenModal=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(y(e),N({eventName:e.event_name||"",eventType:e.event_type||"holiday",startDate:e.start_date||"",endDate:e.end_date||"",description:e.description||""})):(y(null),N({eventName:"",eventType:"holiday",startDate:"",endDate:"",description:""})),a(!0)},handleCloseModal=()=>{a(!1),y(null),N({eventName:"",eventType:"holiday",startDate:"",endDate:"",description:""})},handleSubmit=async e=>{e.preventDefault();try{let e={eventName:b.eventName,eventType:b.eventType,eventDate:b.startDate,endDate:b.endDate,description:b.description};p?(await C(()=>d.Sb.updateAcademicEvent(p.id,e)),j({type:"success",text:"Event updated successfully!"})):(await C(()=>d.Sb.manageAcademicCalendar(e)),j({type:"success",text:"Event created successfully!"})),w(),handleCloseModal(),setTimeout(()=>j(null),5e3)}catch(e){var t,a;j({type:"error",text:(null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.message)||"Failed to save event"})}},handleDeleteEvent=async e=>{if(window.confirm("Are you sure you want to delete this event?"))try{await d.Sb.deleteAcademicEvent(e),j({type:"success",text:"Event deleted successfully!"}),w(),setTimeout(()=>j(null),5e3)}catch(e){var t,a;j({type:"error",text:(null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.message)||"Failed to delete event"})}},getEventTypeColor=e=>{let t=_.find(t=>t.value===e);return t?t.color:"bg-gray-100 text-gray-800"},getEventTypeLabel=e=>{let t=_.find(t=>t.value===e);return t?t.label:e};return E?(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(r.Z,{}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(c.Z,{}),(0,s.jsx)("main",{className:"flex-1 p-6 flex justify-center items-center",children:(0,s.jsx)(u.Z,{size:"lg"})})]})]}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(r.Z,{}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(c.Z,{}),(0,s.jsx)("main",{className:"flex-1 p-6",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Academic Calendar"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Manage academic events, holidays, and important dates"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(m.Z,{variant:"outline",size:"sm",icon:h.Bw1,onClick:w,children:"Refresh"}),(0,s.jsx)(m.Z,{variant:"primary",icon:h.OvN,onClick:()=>handleOpenModal(),children:"Add Event"})]})]}),g&&(0,s.jsx)(v.Z,{variant:g.type,dismissible:!0,onDismiss:()=>j(null),children:g.text}),(0,s.jsx)(o.Z,{children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Upcoming Events"}),f&&f.length>0?(0,s.jsx)("div",{className:"space-y-4",children:f.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)(h.vlc,{className:"w-6 h-6 text-blue-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900",children:e.event_name}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:e.description}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 mt-1",children:[(0,s.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(getEventTypeColor(e.event_type)),children:getEventTypeLabel(e.event_type)}),(0,s.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,s.jsx)(h.TCC,{className:"w-4 h-4 mr-1"}),new Date(e.start_date).toLocaleDateString(),e.end_date&&e.end_date!==e.start_date&&(0,s.jsxs)("span",{children:[" - ",new Date(e.end_date).toLocaleDateString()]})]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(m.Z,{variant:"outline",size:"sm",icon:h.vPQ,onClick:()=>handleOpenModal(e),children:"Edit"}),(0,s.jsx)(m.Z,{variant:"danger",size:"sm",icon:h.Ybf,onClick:()=>handleDeleteEvent(e.id),children:"Delete"})]})]},t))}):(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(h.vlc,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Events Found"}),(0,s.jsx)("p",{className:"text-gray-500 mb-4",children:"Get started by adding your first academic event."}),(0,s.jsx)(m.Z,{variant:"primary",icon:h.OvN,onClick:()=>handleOpenModal(),children:"Add Event"})]})]})}),(0,s.jsx)(o.Z,{children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Event Types"}),(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:_.map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e.color.split(" ")[0])}),(0,s.jsx)("span",{className:"text-sm text-gray-700",children:e.label})]},e.value))})]})})]})})]}),t&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:p?"Edit Event":"Add New Event"}),(0,s.jsx)(m.Z,{variant:"outline",size:"sm",icon:h.q5L,onClick:handleCloseModal,children:"Close"})]}),(0,s.jsxs)("form",{onSubmit:handleSubmit,className:"p-6 space-y-4",children:[(0,s.jsx)(x.Z,{label:"Event Name",value:b.eventName,onChange:e=>N({...b,eventName:e.target.value}),required:!0}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Event Type"}),(0,s.jsx)("select",{value:b.eventType,onChange:e=>N({...b,eventType:e.target.value}),className:"form-select",required:!0,children:_.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,s.jsx)(x.Z,{label:"Start Date",type:"date",value:b.startDate,onChange:e=>N({...b,startDate:e.target.value}),required:!0}),(0,s.jsx)(x.Z,{label:"End Date",type:"date",value:b.endDate,onChange:e=>N({...b,endDate:e.target.value})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,s.jsx)("textarea",{value:b.description,onChange:e=>N({...b,description:e.target.value}),rows:3,className:"form-textarea",placeholder:"Enter event description..."})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,s.jsx)(m.Z,{variant:"outline",onClick:handleCloseModal,children:"Cancel"}),(0,s.jsx)(m.Z,{variant:"primary",type:"submit",icon:h.mW3,loading:D,children:p?"Update Event":"Create Event"})]})]})]})})]})}}},function(e){e.O(0,[216,592,888,179],function(){return e(e.s=302)}),_N_E=e.O()}]);