(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7684],{9626:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/departments",function(){return s(4011)}])},4011:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return departments}});var a={};s.r(a);var l=s(5893),d=s(7294),r=s(1163),n=s(6761),i=s(591),c=s(4082),m=s(2983),x=s(7219),departments=()=>{let{user:e,isAuthenticated:t}=(0,n.a)(),s=(0,r.useRouter)(),[o,h]=(0,d.useState)([]),[u,g]=(0,d.useState)(!0),[p,j]=(0,d.useState)(null),[N,b]=(0,d.useState)(!1),[f,y]=(0,d.useState)(null),fetchDepartments=async()=>{try{g(!0),j(null);let e=await i.Sb.getAllDepartments(1,50);e&&e.departments?h(e.departments):Array.isArray(e)?h(e):h([])}catch(e){j(e.message||"Failed to fetch departments"),h([])}finally{g(!1)}};(0,d.useEffect)(()=>{t&&(null==e?void 0:e.role)==="admin"&&fetchDepartments()},[t,e]);let handleDeleteDepartment=async(e,t)=>{if(confirm("Are you sure you want to delete ".concat(t,"? This action cannot be undone.")))try{await i.Sb.deleteDepartment(e),fetchDepartments(),alert("Department deleted successfully!")}catch(e){alert("Failed to delete department. Please try again.")}},handleAction=(e,t)=>{switch(e){case"view":y(t),b(!0);break;case"edit":s.push("/admin/departments/edit?departmentId=".concat(t.id));break;case"delete":handleDeleteDepartment(t.id,t.name)}},closeModal=()=>{b(!1),y(null)};return t&&(null==e?void 0:e.role)==="admin"?u?(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,l.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading departments..."})]})}):(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)(c.default,{}),(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)(m.default,{}),(0,l.jsxs)("main",{className:"flex-1 p-6",children:[(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Department Management"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Manage academic departments and their information"})]}),(0,l.jsx)("button",{onClick:()=>s.push("/admin/departments/new"),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:"Add Department"})]})}),p&&(0,l.jsxs)("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,l.jsx)("p",{className:"text-red-800",children:p}),(0,l.jsx)("button",{onClick:fetchDepartments,className:"mt-2 text-red-600 hover:text-red-800 underline",children:"Try again"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,l.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,l.jsx)("div",{className:"w-6 h-6 bg-blue-600 rounded"})}),(0,l.jsxs)("div",{className:"ml-4",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Departments"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:o.length})]})]})}),(0,l.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,l.jsx)("div",{className:"w-6 h-6 bg-green-600 rounded"})}),(0,l.jsxs)("div",{className:"ml-4",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Departments"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:o.filter(e=>"active"===e.status).length})]})]})}),(0,l.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,l.jsx)("div",{className:"w-6 h-6 bg-purple-600 rounded"})}),(0,l.jsxs)("div",{className:"ml-4",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"With HOD"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:o.filter(e=>e.hod_name).length})]})]})})]}),(0,l.jsxs)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[(0,l.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,l.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Departments (",o.length,")"]})}),(0,l.jsx)("div",{className:"overflow-x-auto",children:0===o.length?(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)("div",{className:"mx-auto h-12 w-12 bg-gray-400 rounded"}),(0,l.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No departments found"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating a new department."}),(0,l.jsx)("div",{className:"mt-6",children:(0,l.jsx)("button",{onClick:()=>s.push("/admin/departments/new"),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:"Add Department"})})]}):(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Head of Department"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,l.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,l.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,l.jsx)("div",{className:"h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center",children:(0,l.jsx)("div",{className:"h-5 w-5 bg-blue-600 rounded"})})}),(0,l.jsxs)("div",{className:"ml-4",children:[(0,l.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name||"N/A"}),(0,l.jsx)("div",{className:"text-sm text-gray-500",children:e.code||"N/A"})]})]})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsx)("div",{className:"text-sm text-gray-900",children:e.hod_name||"Not assigned"})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("active"===e.status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:e.status||"active"})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,l.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[(0,l.jsx)("button",{onClick:()=>handleAction("view",e),className:"text-blue-600 hover:text-blue-900 p-1 rounded",title:"View Department",children:"View"}),(0,l.jsx)("button",{onClick:()=>handleAction("edit",e),className:"text-indigo-600 hover:text-indigo-900 p-1 rounded",title:"Edit Department",children:"Edit"}),(0,l.jsx)("button",{onClick:()=>handleAction("delete",e),className:"text-red-600 hover:text-red-900 p-1 rounded",title:"Delete Department",children:"Delete"})]})})]},e.id))})]})})]}),N&&f&&(0,l.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,l.jsxs)("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between pb-4 border-b border-gray-200",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(a.FiBuilding,{className:"w-6 h-6 text-blue-600 mr-3"}),(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Department Details"})]}),(0,l.jsx)("button",{onClick:closeModal,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,l.jsx)(x.q5L,{className:"w-6 h-6"})})]}),(0,l.jsxs)("div",{className:"mt-4 space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("h4",{className:"text-md font-medium text-gray-900 mb-3 flex items-center",children:[(0,l.jsx)(x.H33,{className:"w-4 h-4 mr-2"}),"Basic Information"]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Department Name"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:f.name||"N/A"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Department Code"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:f.code||"N/A"})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Description"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:f.description||"No description provided"})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("h4",{className:"text-md font-medium text-gray-900 mb-3 flex items-center",children:[(0,l.jsx)(x.fzv,{className:"w-4 h-4 mr-2"}),"Management"]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Head of Department"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:f.hod_name||"Not assigned"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Status"}),(0,l.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("active"===f.status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:f.status||"active"})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("h4",{className:"text-md font-medium text-gray-900 mb-3 flex items-center",children:[(0,l.jsx)(x.bAx,{className:"w-4 h-4 mr-2"}),"Statistics"]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Staff Count"}),(0,l.jsxs)("p",{className:"mt-1 text-sm text-gray-900 flex items-center",children:[(0,l.jsx)(x.WY8,{className:"w-4 h-4 mr-1"}),f.staff_count||0]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Student Count"}),(0,l.jsxs)("p",{className:"mt-1 text-sm text-gray-900 flex items-center",children:[(0,l.jsx)(x.WY8,{className:"w-4 h-4 mr-1"}),f.student_count||0]})]})]})]}),(f.created_at||f.updated_at)&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("h4",{className:"text-md font-medium text-gray-900 mb-3 flex items-center",children:[(0,l.jsx)(x.vlc,{className:"w-4 h-4 mr-2"}),"Timestamps"]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.created_at&&(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Created At"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:new Date(f.created_at).toLocaleDateString()})]}),f.updated_at&&(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Last Updated"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:new Date(f.updated_at).toLocaleDateString()})]})]})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-end pt-6 border-t border-gray-200 mt-6 space-x-3",children:[(0,l.jsx)("button",{onClick:()=>{closeModal(),handleAction("edit",f)},className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Edit Department"}),(0,l.jsx)("button",{onClick:closeModal,className:"px-4 py-2 bg-gray-300 text-gray-700 text-sm font-medium rounded-md hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Close"})]})]})})]})]})]}):(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Access Denied"}),(0,l.jsx)("p",{className:"text-gray-600 mt-2",children:"You need admin privileges to access this page."})]})})}}},function(e){e.O(0,[1216,8592,2888,179],function(){return e(e.s=9626)}),_N_E=e.O()}]);