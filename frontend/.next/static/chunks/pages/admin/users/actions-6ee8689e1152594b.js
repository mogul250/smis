(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3593],{7273:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/users/actions",function(){return t(5443)}])},5443:function(e,s,t){"use strict";t.r(s);var a=t(5893),l=t(7294),i=t(1163),r=t(6761),c=t(591),d=t(4082),n=t(2983),x=t(9180),m=t(4105),u=t(4549),h=t(7219);s.default=()=>{var e,s;let{user:t,isAuthenticated:o}=(0,r.a)(),j=(0,i.useRouter)(),{userId:N,action:f}=j.query,[g,v]=(0,l.useState)(null),[p,y]=(0,l.useState)(!0),[b,w]=(0,l.useState)(!1),[U,_]=(0,l.useState)(null),[C,S]=(0,l.useState)(null);(0,l.useEffect)(()=>{if(!o||(null==t?void 0:t.role)!=="admin"){j.push("/dashboard");return}},[o,t,j]),(0,l.useEffect)(()=>{N&&o&&(null==t?void 0:t.role)==="admin"&&fetchUser()},[N,o,t]);let fetchUser=async()=>{try{y(!0),_(null);let e=await c.Sb.getUserById(parseInt(N));v(e)}catch(e){_("Failed to load user data. Please try again.")}finally{y(!1)}},handleStatusUpdate=async e=>{try{w(!0),await c.Sb.updateUserStatus(parseInt(N),e),S({type:"success",text:"User status updated to ".concat(e)}),await fetchUser(),setTimeout(()=>S(null),3e3)}catch(e){S({type:"error",text:"Failed to update status: ".concat(e.message)}),setTimeout(()=>S(null),3e3)}finally{w(!1)}},handleDeleteUser=async()=>{if(window.confirm("Are you sure you want to delete this user? This action cannot be undone."))try{w(!0),await c.Sb.deleteUser(parseInt(N)),S({type:"success",text:"User deleted successfully"}),setTimeout(()=>{j.push("/admin/users")},2e3)}catch(e){S({type:"error",text:"Failed to delete user: ".concat(e.message)}),setTimeout(()=>S(null),3e3)}finally{w(!1)}};return o&&(null==t?void 0:t.role)==="admin"?p?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(d.default,{}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(n.default,{}),(0,a.jsx)("main",{className:"flex-1 p-6 flex justify-center items-center",children:(0,a.jsx)(u.Z,{size:"lg"})})]})]}):U?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(d.default,{}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(n.default,{}),(0,a.jsx)("main",{className:"flex-1 p-6",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"text-red-500 mr-3",children:(0,a.jsx)(h.fzv,{className:"w-6 h-6"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-800",children:"Error Loading User"}),(0,a.jsx)("p",{className:"text-red-600 mt-1",children:U})]})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(x.Z,{variant:"outline",onClick:()=>j.push("/admin/users"),icon:h.Ao2,children:"Back to Users"})})]})})})]})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(d.default,{}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(n.default,{}),(0,a.jsx)("main",{className:"flex-1 p-6",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(x.Z,{variant:"outline",onClick:()=>j.push("/admin/users"),icon:h.Ao2,className:"mr-4",children:"Back"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"User Actions"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage user account and permissions"})]})]})})}),C&&(0,a.jsx)("div",{className:"mb-6 p-4 rounded-lg border-l-4 ".concat("success"===C.type?"bg-green-50 border-green-400 text-green-800":"bg-red-50 border-red-400 text-red-800"),children:(0,a.jsxs)("div",{className:"flex items-center",children:["success"===C.type?(0,a.jsx)(h.tMu,{className:"w-5 h-5 mr-2"}):(0,a.jsx)(h.pBC,{className:"w-5 h-5 mr-2"}),(0,a.jsx)("span",{className:"font-medium",children:C.text})]})}),g&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.Z,{className:"mb-6",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4 mb-6",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(h.fzv,{className:"w-8 h-8 text-blue-600"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-gray-900",children:[g.first_name," ",g.last_name]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 mt-2",children:[(0,a.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,a.jsx)(h.Imn,{className:"w-4 h-4 mr-1"}),g.email]}),(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat({admin:"bg-red-100 text-red-800",teacher:"bg-blue-100 text-blue-800",student:"bg-green-100 text-green-800",hod:"bg-purple-100 text-purple-800",finance:"bg-orange-100 text-orange-800"}[g.role]||"bg-gray-100 text-gray-800"),children:null===(e=g.role)||void 0===e?void 0:e.toUpperCase()}),(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat({active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",suspended:"bg-yellow-100 text-yellow-800",pending:"bg-blue-100 text-blue-800"}[g.status]||"bg-gray-100 text-gray-800"),children:(null===(s=g.status)||void 0===s?void 0:s.toUpperCase())||"ACTIVE"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Account Information"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"User ID"}),(0,a.jsx)("p",{className:"text-gray-900",children:g.id})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Email"}),(0,a.jsx)("p",{className:"text-gray-900",children:g.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Role"}),(0,a.jsx)("p",{className:"text-gray-900 capitalize",children:g.role})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Additional Details"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Department"}),(0,a.jsx)("p",{className:"text-gray-900",children:g.department_name||"N/A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Created"}),(0,a.jsx)("p",{className:"text-gray-900",children:g.created_at?new Date(g.created_at).toLocaleDateString():"N/A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Status"}),(0,a.jsx)("p",{className:"text-gray-900 capitalize",children:g.status||"Active"})]})]})]})]})]})}),(0,a.jsx)(m.Z,{children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Available Actions"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,a.jsx)(x.Z,{variant:"outline",className:"justify-start h-auto p-4",onClick:()=>j.push("/admin/users/edit?userId=".concat(N)),disabled:b,children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(h.IYd,{className:"w-5 h-5 mr-3 text-blue-600"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("div",{className:"font-medium",children:"Edit User"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Update user information"})]})]})}),"active"!==g.status&&(0,a.jsx)(x.Z,{variant:"outline",className:"justify-start h-auto p-4",onClick:()=>handleStatusUpdate("active"),disabled:b,children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(h.tMu,{className:"w-5 h-5 mr-3 text-green-600"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("div",{className:"font-medium",children:"Activate User"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Enable user account"})]})]})}),"suspended"!==g.status&&(0,a.jsx)(x.Z,{variant:"outline",className:"justify-start h-auto p-4",onClick:()=>handleStatusUpdate("suspended"),disabled:b,children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(h.pBC,{className:"w-5 h-5 mr-3 text-yellow-600"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("div",{className:"font-medium",children:"Suspend User"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Temporarily disable account"})]})]})}),"inactive"!==g.status&&(0,a.jsx)(x.Z,{variant:"outline",className:"justify-start h-auto p-4",onClick:()=>handleStatusUpdate("inactive"),disabled:b,children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(h.pBC,{className:"w-5 h-5 mr-3 text-gray-600"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("div",{className:"font-medium",children:"Deactivate User"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Disable user account"})]})]})}),(0,a.jsx)(x.Z,{variant:"outline",className:"justify-start h-auto p-4 border-red-300 text-red-600 hover:bg-red-50",onClick:handleDeleteUser,disabled:b,children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(h.Ybf,{className:"w-5 h-5 mr-3 text-red-600"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("div",{className:"font-medium",children:"Delete User"}),(0,a.jsx)("div",{className:"text-sm text-red-500",children:"Permanently remove user"})]})]})})]})]})})]})]})})]})]}):null}}},function(e){e.O(0,[1216,8592,2888,179],function(){return e(e.s=7273)}),_N_E=e.O()}]);