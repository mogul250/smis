(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[284],{141:function(e,a,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/users/create",function(){return s(4741)}])},4741:function(e,a,s){"use strict";s.r(a);var l=s(5893),r=s(7294),t=s(1163),n=s(6761),i=s(591),d=s(4082),m=s(2983),c=s(9180),o=s(4105),u=s(5822),h=s(897),x=s(4549),p=s(7219);a.default=()=>{let{user:e,isAuthenticated:a}=(0,n.a)(),s=(0,t.useRouter)(),[f,g]=(0,r.useState)({firstName:"",lastName:"",email:"",password:"",confirmPassword:"",role:"student",departmentId:"",status:"active"}),[v,b]=(0,r.useState)([]),[j,N]=(0,r.useState)(!0),[w,y]=(0,r.useState)(!1),[C,I]=(0,r.useState)(null),[S,P]=(0,r.useState)(null),[Z,q]=(0,r.useState)({});(0,r.useEffect)(()=>{if(!a||(null==e?void 0:e.role)!=="admin"){s.push("/dashboard");return}},[a,e,s]),(0,r.useEffect)(()=>{a&&(null==e?void 0:e.role)==="admin"&&fetchDepartments()},[a,e]);let fetchDepartments=async()=>{try{N(!0);let e=await i.Sb.getAllDepartments();b(e)}catch(e){I("Failed to load departments. Please try again.")}finally{N(!1)}},handleInputChange=e=>{let{name:a,value:s}=e.target;g(e=>({...e,[a]:s})),Z[a]&&q(e=>({...e,[a]:null}))},validateForm=()=>{let e={};return f.firstName.trim()||(e.firstName="First name is required"),f.lastName.trim()||(e.lastName="Last name is required"),f.email.trim()?/\S+@\S+\.\S+/.test(f.email)||(e.email="Email is invalid"):e.email="Email is required",f.password?f.password.length<6&&(e.password="Password must be at least 6 characters"):e.password="Password is required",f.password!==f.confirmPassword&&(e.confirmPassword="Passwords do not match"),f.role||(e.role="Role is required"),q(e),0===Object.keys(e).length},handleSubmit=async e=>{if(e.preventDefault(),validateForm())try{y(!0),I(null);let e={firstName:f.firstName.trim(),lastName:f.lastName.trim(),email:f.email.trim().toLowerCase(),password:f.password,role:f.role,departmentId:f.departmentId||null,status:f.status};await i.Sb.createUser(e),P({type:"success",text:"User created successfully!"}),setTimeout(()=>{s.push("/admin/users")},2e3)}catch(e){I(e.message||"Failed to create user. Please try again.")}finally{y(!1)}};return a&&(null==e?void 0:e.role)==="admin"?j?(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)(d.default,{}),(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)(m.default,{}),(0,l.jsx)("main",{className:"flex-1 p-6 flex justify-center items-center",children:(0,l.jsx)(x.Z,{size:"lg"})})]})]}):(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)(d.default,{}),(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)(m.default,{}),(0,l.jsx)("main",{className:"flex-1 p-6",children:(0,l.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsx)("div",{className:"flex items-center justify-between",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(c.Z,{variant:"outline",onClick:()=>s.push("/admin/users"),icon:p.Ao2,className:"mr-4",children:"Back"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Create New User"}),(0,l.jsx)("p",{className:"text-gray-600 mt-1",children:"Add a new user to the system"})]})]})})}),S&&(0,l.jsx)("div",{className:"mb-6 p-4 rounded-lg border-l-4 ".concat("success"===S.type?"bg-green-50 border-green-400 text-green-800":"bg-red-50 border-red-400 text-red-800"),children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(p.tMu,{className:"w-5 h-5 mr-2"}),(0,l.jsx)("span",{className:"font-medium",children:S.text})]})}),C&&(0,l.jsx)("div",{className:"mb-6 p-4 rounded-lg border-l-4 bg-red-50 border-red-400 text-red-800",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(p.fzv,{className:"w-5 h-5 mr-2"}),(0,l.jsx)("span",{className:"font-medium",children:C})]})}),(0,l.jsx)(o.Z,{children:(0,l.jsx)("div",{className:"p-6",children:(0,l.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Personal Information"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsx)(u.Z,{label:"First Name",name:"firstName",value:f.firstName,onChange:handleInputChange,error:Z.firstName,required:!0,icon:p.fzv}),(0,l.jsx)(u.Z,{label:"Last Name",name:"lastName",value:f.lastName,onChange:handleInputChange,error:Z.lastName,required:!0,icon:p.fzv})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Account Information"}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(u.Z,{label:"Email Address",name:"email",type:"email",value:f.email,onChange:handleInputChange,error:Z.email,required:!0,icon:p.Imn}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsx)(u.Z,{label:"Password",name:"password",type:"password",value:f.password,onChange:handleInputChange,error:Z.password,required:!0,icon:p.UIZ}),(0,l.jsx)(u.Z,{label:"Confirm Password",name:"confirmPassword",type:"password",value:f.confirmPassword,onChange:handleInputChange,error:Z.confirmPassword,required:!0,icon:p.UIZ})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Role and Department"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsx)(h.Z,{label:"Role",name:"role",value:f.role,onChange:handleInputChange,options:[{value:"student",label:"Student"},{value:"teacher",label:"Teacher"},{value:"hod",label:"Head of Department"},{value:"finance",label:"Finance Officer"},{value:"admin",label:"Administrator"}],error:Z.role,required:!0}),(0,l.jsx)(h.Z,{label:"Department",name:"departmentId",value:f.departmentId,onChange:handleInputChange,options:[{value:"",label:"Select Department (Optional)"},...v.map(e=>({value:e.id.toString(),label:e.name}))]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Account Status"}),(0,l.jsx)(h.Z,{label:"Status",name:"status",value:f.status,onChange:handleInputChange,options:[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"pending",label:"Pending"}],required:!0})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[(0,l.jsx)(c.Z,{type:"button",variant:"outline",onClick:()=>s.push("/admin/users"),disabled:w,children:"Cancel"}),(0,l.jsx)(c.Z,{type:"submit",variant:"primary",icon:p.mW3,disabled:w,loading:w,children:w?"Creating User...":"Create User"})]})]})})})]})})]})]}):null}}},function(e){e.O(0,[1216,8592,2888,179],function(){return e(e.s=141)}),_N_E=e.O()}]);