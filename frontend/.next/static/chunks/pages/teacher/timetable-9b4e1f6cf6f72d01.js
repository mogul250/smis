(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2837],{7985:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/teacher/timetable",function(){return t(3189)}])},3189:function(e,s,t){"use strict";t.r(s);var r=t(5893),a=t(7294),l=t(9008),i=t.n(l),n=t(6761),d=t(3242),c=t(591),o=t(4082),m=t(2983),x=t(4105),u=t(9180),h=t(9175),j=t(4549),v=t(7014),g=t(9060);s.default=()=>{var e,s;let{user:t}=(0,n.a)(),[l,N]=(0,a.useState)({semester:"current"}),[y,f]=(0,a.useState)(!1),{data:p,loading:b,error:_,refetch:w}=(0,d.h)(()=>c.$o.getTimetable({semester:"current"===l.semester?void 0:l.semester}));if(!t||"teacher"!==t.role)return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)(h.Z,{variant:"error",children:"Access denied. Teacher access required."})});let handleRefresh=async()=>{f(!0);try{await w()}finally{f(!1)}},handleExport=()=>{if(!p||0===p.length){alert("No timetable data to export");return}let e=p.map(e=>{var s,t;return{Day:getDayName(e.day_of_week),Time:"".concat(null===(s=e.start_time)||void 0===s?void 0:s.substring(0,5)," - ").concat(null===(t=e.end_time)||void 0===t?void 0:t.substring(0,5)),Course:"".concat(e.course_code," - ").concat(e.course_name),Room:e.room||"TBA",Semester:e.semester||"N/A"}}),s=[Object.keys(e[0]).join(","),...e.map(e=>Object.values(e).join(","))].join("\n"),t=new Blob([s],{type:"text/csv"}),r=window.URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download="my-timetable-".concat(new Date().toISOString().split("T")[0],".csv"),a.click(),window.URL.revokeObjectURL(r)};function getDayName(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e]||"Unknown"}let D={totalClasses:(null==p?void 0:p.length)||0,uniqueCourses:new Set(null==p?void 0:p.map(e=>e.course_id)).size||0,hoursPerWeek:(null==p?void 0:p.reduce((e,s)=>{let t=new Date("1970-01-01T".concat(s.start_time)),r=new Date("1970-01-01T".concat(s.end_time));return e+(r-t)/36e5},0))||0,busyDays:new Set(null==p?void 0:p.map(e=>e.day_of_week)).size||0},C=(null==p?void 0:p.filter(e=>{if(l.day&&e.day_of_week.toString()!==l.day)return!1;if(l.search){var s,t,r;let a=l.search.toLowerCase();return(null===(s=e.course_name)||void 0===s?void 0:s.toLowerCase().includes(a))||(null===(t=e.course_code)||void 0===t?void 0:t.toLowerCase().includes(a))||(null===(r=e.room)||void 0===r?void 0:r.toLowerCase().includes(a))}return!0}))||[];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i(),{children:(0,r.jsx)("title",{children:"My Timetable - Teacher Dashboard"})}),(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)(o.default,{}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)(m.default,{}),(0,r.jsx)("main",{className:"flex-1 overflow-auto",children:(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"My Timetable"}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"View your teaching schedule and class assignments"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(u.Z,{variant:"outline",size:"sm",onClick:handleRefresh,loading:y,children:"\uD83D\uDD04 Refresh"}),(0,r.jsx)(u.Z,{variant:"outline",size:"sm",onClick:handleExport,disabled:!p||0===p.length,children:"\uD83D\uDCE5 Export"})]})]}),_&&(0,r.jsxs)(h.Z,{variant:"error",children:["Error loading timetable: ",_]}),(0,r.jsx)(g.QD,{filters:l,onFilterChange:e=>{N(e)},onReset:()=>{N({semester:"current"})},onExport:handleExport}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,r.jsxs)(x.Z,{className:"p-4",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:D.totalClasses}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Total Classes"})]}),(0,r.jsxs)(x.Z,{className:"p-4",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-green-600",children:D.uniqueCourses}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Courses Teaching"})]}),(0,r.jsxs)(x.Z,{className:"p-4",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:D.hoursPerWeek.toFixed(1)}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Hours per Week"})]}),(0,r.jsxs)(x.Z,{className:"p-4",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:D.busyDays}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Teaching Days"})]})]}),p&&p.length>0&&(0,r.jsxs)(x.Z,{className:"p-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Quick Overview"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-blue-800",children:"Next Class"}),(0,r.jsx)("div",{className:"text-blue-600",children:"Check your schedule below"})]}),(0,r.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-green-800",children:"Most Used Room"}),(0,r.jsxs)("div",{className:"text-green-600",children:[p.reduce((e,s)=>(e[s.room]=(e[s.room]||0)+1,e),{}),(null===(e=Object.entries(p.reduce((e,s)=>(e[s.room]=(e[s.room]||0)+1,e),{})).sort((e,s)=>{let[,t]=e,[,r]=s;return r-t})[0])||void 0===e?void 0:e[0])||"N/A"]})]}),(0,r.jsxs)("div",{className:"bg-purple-50 p-3 rounded-lg",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-purple-800",children:"Busiest Day"}),(0,r.jsx)("div",{className:"text-purple-600",children:(null===(s=Object.entries(p.reduce((e,s)=>{let t=getDayName(s.day_of_week);return e[t]=(e[t]||0)+1,e},{})).sort((e,s)=>{let[,t]=e,[,r]=s;return r-t})[0])||void 0===s?void 0:s[0])||"N/A"})]})]})]}),b?(0,r.jsx)(x.Z,{className:"p-12",children:(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(j.Z,{size:"lg"})})}):p&&p.length>0?(0,r.jsx)(g.mG,{timetable:C,editable:!1,showActions:!1,colorScheme:"course",title:"My Teaching Schedule"}):(0,r.jsx)(x.Z,{className:"p-12 text-center",children:(0,r.jsxs)("div",{className:"text-gray-500",children:[(0,r.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDCC5"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Classes Scheduled"}),(0,r.jsx)("p",{className:"text-gray-600",children:"You don't have any classes scheduled for the selected semester. Contact your department head if this seems incorrect."})]})}),p&&p.length>0&&(0,r.jsxs)(x.Z,{children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Course Details"})}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from(new Set(p.map(e=>e.course_id))).map(e=>{let s=p.find(s=>s.course_id===e),t=p.filter(s=>s.course_id===e);return(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:s.course_name}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:s.course_code})]}),(0,r.jsxs)(v.Z,{variant:"primary",size:"sm",children:[t.length," ",1===t.length?"class":"classes"]})]}),(0,r.jsx)("div",{className:"space-y-1 text-sm text-gray-600",children:t.map((e,s)=>{var t,a;return(0,r.jsxs)("div",{children:[getDayName(e.day_of_week)," ",null===(t=e.start_time)||void 0===t?void 0:t.substring(0,5)," - ",null===(a=e.end_time)||void 0===a?void 0:a.substring(0,5),e.room&&" â€¢ ".concat(e.room)]},s)})})]},e)})})})]})]})})]})]})]})}}},function(e){e.O(0,[1216,8592,2888,179],function(){return e(e.s=7985)}),_N_E=e.O()}]);