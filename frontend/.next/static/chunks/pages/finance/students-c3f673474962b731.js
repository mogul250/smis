(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[72],{4332:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/finance/students",function(){return t(8441)}])},8441:function(e,s,t){"use strict";t.r(s);var a=t(5893),l=t(7294),n=t(6761),i=t(3242),r=t(3240),d=t(4082),c=t(5936),x=t(4105),u=t(6208),o=t(7014),h=t(9180),m=t(5822),j=t(9175),v=t(4549),g=t(7219);s.default=()=>{var e,s;let{user:t}=(0,n.a)(),[N,f]=(0,l.useState)(""),[y,p]=(0,l.useState)("all"),[Z,b]=(0,l.useState)("all"),[w,S]=(0,l.useState)(null),{data:_,loading:C,error:F,refetch:k}=(0,i.h)(()=>r.sz.getAllStudents({search:N,status:y,year:Z}),[N,y,Z],{fallbackData:{students:[],stats:{}}}),{loading:A,execute:I}=(0,i.c)();if(!t||"finance"!==t.role)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)(j.Z,{variant:"error",children:"Access denied. Finance access required."})});let V=(null==_?void 0:_.students)||[],E=(null==_?void 0:_.stats)||{},handleViewStudent=e=>{window.location.href="/finance/students/".concat(e)},handleViewFees=async e=>{try{let s=await I(()=>r.sz.getStudentFees(e));alert("Student has ".concat((null==s?void 0:s.length)||0," fee records"))}catch(e){var s,t;S({type:"error",text:(null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to load student fees"})}},handleGenerateInvoice=async e=>{try{let s=await I(()=>r.sz.generateInvoice(e));alert("Invoice generated for student ".concat(e,". Total: $").concat((null==s?void 0:s.totalAmount)||0))}catch(e){var s,t;S({type:"error",text:(null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to generate invoice"})}},getStatusBadgeVariant=e=>{switch(e){case"active":return"success";case"inactive":return"warning";case"graduated":return"primary";case"suspended":return"danger";default:return"default"}},getOutstandingBadgeVariant=e=>0===e?"success":e<500?"warning":"danger";return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(d.Z,{}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(c.Z,{}),(0,a.jsx)("main",{className:"flex-1 p-6",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Management"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Manage student accounts and financial records"})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(h.Z,{variant:"outline",icon:g.QqI,children:"Export Report"}),(0,a.jsx)(h.Z,{variant:"primary",icon:g.WY8,children:"Add Student"})]})]}),w&&(0,a.jsx)(j.Z,{variant:w.type,dismissible:!0,onDismiss:()=>S(null),children:w.text}),C?(0,a.jsx)(x.Z,{className:"flex justify-center py-12",children:(0,a.jsx)(v.Z,{size:"lg"})}):F?(0,a.jsxs)(j.Z,{variant:"error",children:["Failed to load students: ",F]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsx)(x.Z,{children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-primary-blue rounded-lg flex items-center justify-center mr-4",children:(0,a.jsx)(g.WY8,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Students"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:E.totalStudents||0}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[E.activeStudents||0," active"]})]})]})}),(0,a.jsx)(x.Z,{children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-accent-green rounded-lg flex items-center justify-center mr-4",children:(0,a.jsx)(g.oQC,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Outstanding"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["$",(null===(e=E.totalOutstanding)||void 0===e?void 0:e.toLocaleString())||"0"]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[E.studentsWithFees||0," students"]})]})]})}),(0,a.jsx)(x.Z,{children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-accent-orange rounded-lg flex items-center justify-center mr-4",children:(0,a.jsx)(g.bcx,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Overdue Fees"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["$",(null===(s=E.overdueAmount)||void 0===s?void 0:s.toLocaleString())||"0"]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[E.overdueStudents||0," students"]})]})]})}),(0,a.jsx)(x.Z,{children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-accent-red rounded-lg flex items-center justify-center mr-4",children:(0,a.jsx)(g.vlc,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Graduated"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:E.graduatedStudents||0}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"This year"})]})]})})]}),(0,a.jsx)(x.Z,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{children:(0,a.jsx)(m.Z,{label:"Search",placeholder:"Search by name, ID, or email...",value:N,onChange:e=>f(e.target.value),icon:g.jRj})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,a.jsx)("select",{value:y,onChange:e=>p(e.target.value),className:"form-select",children:[{value:"all",label:"All Status"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"graduated",label:"Graduated"},{value:"suspended",label:"Suspended"}].map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Enrollment Year"}),(0,a.jsx)("select",{value:Z,onChange:e=>b(e.target.value),className:"form-select",children:[{value:"all",label:"All Years"},{value:"2024",label:"2024"},{value:"2023",label:"2023"},{value:"2022",label:"2022"},{value:"2021",label:"2021"}].map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsx)("div",{className:"flex items-end",children:(0,a.jsx)(h.Z,{variant:"outline",onClick:k,className:"w-full",children:"Refresh"})})]})}),(0,a.jsxs)(x.Z,{children:[(0,a.jsx)(x.Z.Header,{children:(0,a.jsx)(x.Z.Title,{children:"Student Records"})}),V.length>0?(0,a.jsxs)(u.Z,{children:[(0,a.jsx)(u.Z.Header,{children:(0,a.jsxs)(u.Z.Row,{children:[(0,a.jsx)(u.Z.Head,{children:"Student"}),(0,a.jsx)(u.Z.Head,{children:"Contact"}),(0,a.jsx)(u.Z.Head,{children:"Enrollment"}),(0,a.jsx)(u.Z.Head,{children:"Status"}),(0,a.jsx)(u.Z.Head,{children:"Outstanding"}),(0,a.jsx)(u.Z.Head,{children:"Actions"})]})}),(0,a.jsx)(u.Z.Body,{children:V.map((e,s)=>(0,a.jsxs)(u.Z.Row,{children:[(0,a.jsxs)(u.Z.Cell,{children:[(0,a.jsxs)("div",{className:"font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",e.student_id||e.id]})]}),(0,a.jsx)(u.Z.Cell,{children:(0,a.jsxs)("div",{className:"text-sm text-gray-900",children:[(0,a.jsxs)("div",{className:"flex items-center mb-1",children:[(0,a.jsx)(g.Imn,{className:"w-4 h-4 mr-2 text-gray-400"}),e.email]}),e.phone&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(g.tUt,{className:"w-4 h-4 mr-2 text-gray-400"}),e.phone]})]})}),(0,a.jsxs)(u.Z.Cell,{children:[(0,a.jsx)("div",{className:"text-gray-900",children:e.enrollment_year||"N/A"}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["Year ",e.current_year||"N/A"]})]}),(0,a.jsx)(u.Z.Cell,{children:(0,a.jsx)(o.Z,{variant:getStatusBadgeVariant(e.status),children:e.status})}),(0,a.jsx)(u.Z.Cell,{children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)(o.Z,{variant:getOutstandingBadgeVariant(e.outstanding_amount||0),children:["$",(e.outstanding_amount||0).toFixed(2)]}),e.overdue_count>0&&(0,a.jsxs)("span",{className:"ml-2 text-xs text-red-600",children:[e.overdue_count," overdue"]})]})}),(0,a.jsx)(u.Z.Cell,{children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(h.Z,{variant:"outline",size:"sm",icon:g.rDJ,onClick:()=>handleViewStudent(e.id),children:"View"}),(0,a.jsx)(h.Z,{variant:"primary",size:"sm",icon:g.oQC,onClick:()=>handleViewFees(e.id),children:"Fees"}),(0,a.jsx)(h.Z,{variant:"warning",size:"sm",onClick:()=>handleGenerateInvoice(e.id),loading:A,children:"Invoice"})]})})]},s))})]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(g.WY8,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Students Found"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No students match the current filters. Try adjusting your search criteria."})]})]})]})]})})]})]})}}},function(e){e.O(0,[216,592,888,179],function(){return e(e.s=4332)}),_N_E=e.O()}]);